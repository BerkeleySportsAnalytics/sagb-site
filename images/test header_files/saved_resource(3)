'use strict';

/**
 * Native unit class.
 *
 * @param $
 * @param _
 * @constructor
 */
function UpxDfpNative($, _) {

    var vm = this;

    // Public variables
    vm.templateId = 'upx_native_tpl';

    // Public methods
    vm.display = display;

    ////////////////////
    // IMPLEMENTATION //
    ////////////////////

    /**
     * Render native unit on a page
     * @param {type} slot
     * @param {type} iframe
     * @returns {undefined}
     */
    function display(slot, iframe) {
        renderInline(slot, iframe);
    }

    /**
     * Render slot view
     * @param {type} slot
     * @returns {unresolved}
     */
    function render(slot) {

        if (slot.usebgcolor) {
            slot.theme = 'upx-native-grey story';
        } else {
            slot.theme = 'story';
        }

        var node = document.getElementById(vm.templateId);
        var template = _.template($(node).html());
        return template(slot);
    }

    /**
     * Just add a unit as is
     * @param {type} slot
     * @param {type} iframe
     * @returns {undefined}
     */
    function renderInline(slot, iframe) {
        var html = render(slot, iframe);
        var div = $(document.getElementById(iframe.name));
        div.before(html);

        // Add class to parent
        var ajaxUnit = div.parents('.upx-ad-unit');
        if (ajaxUnit.length) {
            ajaxUnit.addClass('upx_native_container');
        }
    }
}

var upx_dfp_native = new UpxDfpNative(jQuery, _);
;
'use strict';

/**
 * Article infinite scroll controller.
 *
 * @constructor
 */
function UpxSingleController(settings) {

    var me = this;
    me.currentPost = settings.post;
    me.posts = [settings.post];

    // Check if single infinite scroll is activated.
    if (window.UpxNextPostHandler) {

        me.nextPostHandler = new UpxNextPostHandler(document.getElementById('main'), settings.api_post_endpoint, settings.nonce);
        me.currentHandler = me.nextPostHandler;
        me.nextPostHandler.handle(settings.post);

        /**
         * Next Post Complete Event
         */
        me.nextPostHandler.on('complete', function (post) {

            // Init trackers.
            me.configureTrackers(post);

            // Pass execution to another handler.
            me.nextPostHandler.handle(post);
            me.currentPost = post;

            // Add new post to the list.
            me.posts.push(post);
            me.trigger('addPost', post);
        });

        // Check if post is too short.
        window.addEventListener('load', function () {
            me.currentHandler.onWinScroll();
        });

        // Set ad context on URL change.
        UPX.urlUpdater.bind('update', function (eventData) {
            if (eventData && eventData.newItem && eventData.newItem.meta) {
                UPX.adService.setContext(eventData.newItem.meta.adContext);
            }
        });
    }

    // Init.
    var track = function () {
        me.configureTrackers(me.currentPost);
    };
    if (UPX.urlTracker) {
        track();
    } else {
        UPX.bind('urlTrackerReady', track);
    }
}

/**
 * Set article page trackers.
 *
 * @param post
 */
UpxSingleController.prototype.configureTrackers = function (post) {

    // Address bar config.
    var postDiv = document.getElementById('post-' + parseInt(post.id, 10));
    if (postDiv) {
        UPX.urlUpdater.add(postDiv, post.url, post.title, post);

        // Sub pages trackers.
        var pages = postDiv.querySelectorAll('.post-page');
        if (pages && pages.length) {
            for (var i = 0; i < pages.length; i++) {
                var pageEl = pages[i];
                if (pageEl) {
                    var url = i === 0 ? post.url : post.url + (i + 1) + '/';
                    if (UPX.urlTracker) {
                        UPX.urlTracker.add(pageEl, url, post.title);
                    }
                }
            }
        }
    }
};

// Extend backbone event.
_.extend(UpxSingleController.prototype, Backbone.Events);

// Create instance.
UPX.singleInfiniteScroll = new UpxSingleController(upxSingleScrollSettings);
UPX.trigger('singleInfiniteReady');
;
'use strict';

/**
 * Load youtube players which are close to or in viewport.
 */
(function () {

    window.addEventListener('load', buildPlayersInViewport);
    window.addEventListener('scroll', buildPlayersInViewport);

    /**
     * Build youtube players which are in or close to viewport.
     */
    function buildPlayersInViewport() {

        var iframes = document.querySelectorAll('iframe.youtube-player:not(.lazy-loaded)');
        var intend = upxGetWinH() / 2;

        for (var i = 0; i < iframes.length; i++) {
            var iframe = iframes[i];
            if (upxIsCloseToEl(iframe, intend)) {
                iframe.classList.add('lazy-loaded');
                if (iframe.getAttribute('data-src')) {
                    iframe.setAttribute('src', iframe.getAttribute('data-src'));
                }
            }
        }
    }
})();
;
'use strict';

/**
 * File navigation.js.
 *
 * Handles toggling the navigation menu for small screens and enables TAB key
 * navigation support for dropdown menus.
 */
(function () {
    var container, button, menus, links, i, len;

    container = document.getElementById('site-navigation');
    if (!container) {
        return;
    }

    container.setAttribute('aria-expanded', 'false');

    menus = container.querySelectorAll('#menu-main-menu, #menu-secondary-menu');

    // If menu is empty and return early.
    if (menus.length) {
        menus.forEach(function (menu) {
            if (-1 === menu.className.indexOf('nav-menu')) {
                menu.className += ' nav-menu';
            }

            // Get all the link elements within the menu.
            links = menu.getElementsByTagName('a');

            // Each time a menu link is focused or blurred, toggle focus.
            for (i = 0, len = links.length; i < len; i++) {
                links[i].addEventListener('focus', toggleFocus, true);
                links[i].addEventListener('blur', toggleFocus, true);
            }
        });
    }

    button = container.parentNode.getElementsByClassName('menu-toggle')[0];
    if ('undefined' !== typeof button) {
        button.onclick = function () {
            if (-1 !== document.body.className.indexOf('menu-toggled')) {
                document.body.className = document.body.className.replace(' menu-toggled', '');
                button.className = button.className.replace(' is-active', '');
                button.setAttribute('aria-expanded', 'false');
                container.setAttribute('aria-expanded', 'false');
            } else {
                document.body.className += ' menu-toggled';
                button.className += ' is-active';
                button.setAttribute('aria-expanded', 'true');
                container.setAttribute('aria-expanded', 'true');
            }
        };
    }

    /**
     * Sets or removes .focus class on an element.
     */
    function toggleFocus() {
        var self = this;

        // Move up through the ancestors of the current link until we hit .nav-menu.
        while (-1 === self.className.indexOf('nav-menu')) {

            // On li elements toggle the class .focus.
            if ('li' === self.tagName.toLowerCase()) {
                if (-1 !== self.className.indexOf('focus')) {
                    self.className = self.className.replace(' focus', '');
                } else {
                    self.className += ' focus';
                }
            }

            self = self.parentElement;
        }
    }

    /**
     * Toggles `focus` class to allow submenu access on tablets.
     */
    (function (container) {
        var touchStartFn, i,
            parentLink = container.querySelectorAll('.menu-item-has-children > a');

        if ('ontouchstart' in window) {
            touchStartFn = function (e) {
                var menuItem = this.parentNode, i;

                if (!menuItem.classList.contains('focus')) {
                    e.preventDefault();
                    for (i = 0; i < menuItem.parentNode.children.length; ++i) {
                        if (menuItem === menuItem.parentNode.children[i]) {
                            continue;
                        }
                        menuItem.parentNode.children[i].classList.remove('focus');
                    }
                    menuItem.classList.add('focus');
                } else {
                    menuItem.classList.remove('focus');
                }
            };

            for (i = 0; i < parentLink.length; ++i) {
                parentLink[i].addEventListener('touchstart', touchStartFn, false);
            }
        }
    }(container));
})();
;
'use strict';

(function () {

    /**
     * Debounce
     *
     * @param {Function} func
     * @param {number} wait
     * @param {boolean} immediate
     */
    function debounce(func, wait, immediate) {

        var timeout;
        wait = (typeof wait !== 'undefined') ? wait : 20;
        immediate = (typeof immediate !== 'undefined') ? immediate : true;

        return function () {

            var context = this, args = arguments;
            var later = function () {
                timeout = null;

                if (!immediate) {
                    func.apply(context, args);
                }
            };

            var callNow = immediate && !timeout;

            clearTimeout(timeout);
            timeout = setTimeout(later, wait);

            if (callNow) {
                func.apply(context, args);
            }
        };
    }

    /**
     * Prepends an element to a container.
     *
     * @param {Element} container
     * @param {Element} element
     */
    function prependElement(container, element) {
        if (container.firstChild) {
            return container.insertBefore(element, container.firstChild);
        } else {
            return container.appendChild(element);
        }
    }

    /**
     * Shows an element by adding a hidden className.
     *
     * @param {Element} element
     */
    function showButton(element) {
        // classList.remove is not supported in IE11.
        element.className = element.className.replace('is-empty', '');
    }

    /**
     * Hides an element by removing the hidden className.
     *
     * @param {Element} element
     */
    function hideButton(element) {
        // classList.add is not supported in IE11.
        if (!element.classList.contains('is-empty')) {
            element.className += ' is-empty';
        }
    }

    /**
     * Returns the sum of children width in the container.
     *
     * @returns {number} Available space
     */
    function getChildrenWidth(container) {
        var childrenWidth = 0,
            i;
        for (i = 0; i < container.children.length; i++) {
            childrenWidth += container.children[i].offsetWidth;
        }
        return childrenWidth;
    }

    /**
     * Returns the currently available space in the menu container.
     *
     * @returns {number} Available space
     */
    function getAvailableSpace(button, container) {
        return container.offsetWidth - button.offsetWidth - 22;
    }

    /**
     * Returns whether the current menu is overflowing or not.
     *
     * @returns {int} Pixels: positive - overflow, negative - available space
     */
    function getOverflowingNavigationWidth(list, button, container) {
        return getChildrenWidth(list) - getAvailableSpace(button, container);
    }

    /**
     * Set menu container variable
     */
    var navContainer = document.querySelector('.main-navigation');
    var breaks = [];

    /**
     * Let’s bail if our menu doesn't exist
     */
    if (!navContainer) {
        return;
    }

    /**
     * Refreshes the list item from the menu depending on the menu size
     */
    function updateNavigationMenu(container) {

        /**
         * Let’s bail if our menu is empty
         */
        if (!container.querySelector('.main-menu') || window.innerWidth <= 640) {
            return;
        }

        // Adds the necessary UI to operate the menu.
        var visibleList = container.querySelector('.main-menu');
        var hiddenList = visibleList.nextElementSibling.querySelector('.hidden-links');
        var toggleButton = visibleList.nextElementSibling.querySelector('.main-menu-more-toggle');

        var overflowingWidth = getOverflowingNavigationWidth(visibleList, toggleButton, container);

        if (visibleList.childElementCount > 0 && overflowingWidth > 0) {

            var visibleLastChild = visibleList.lastElementChild;
            // Record the width of the visible list last child.
            breaks.push(visibleLastChild.offsetWidth);
            // Move last item to the hidden list.
            prependElement(hiddenList, visibleLastChild);
            hiddenList.setAttribute('data-children', hiddenList.childElementCount);
            // Show the toggle button
            showButton(toggleButton);

        } else {

            // There is space for another item in the nav.
            if (breaks.length && (toggleButton.offsetWidth + 22 - overflowingWidth) > breaks[breaks.length - 1]) {
                // Move the item to the visible list.
                visibleList.appendChild(hiddenList.firstChild);
                hiddenList.setAttribute('data-children', hiddenList.childElementCount);
                breaks.pop();
            }

            // Hide the dropdown btn if hidden list is empty.
            if (breaks.length < 1) {
                hideButton(toggleButton);
                toggleMenuMore(container, false)
            }
        }

        // Recur if the visible list is still overflowing the nav.
        if (visibleList.childElementCount > 0 && getOverflowingNavigationWidth(visibleList, toggleButton, container) > 0) {
            updateNavigationMenu(container);
        }
    }

    /**
     * Toggle Menu More
     */
    function toggleMenuMore(container, expand) {
        var menu_more_button = container.getElementsByClassName('main-menu-more-toggle')[0];
        if (-1 !== container.className.indexOf('expanded') && true !== expand) {
            container.className = container.className.replace(' expanded', '');
            menu_more_button.setAttribute('aria-expanded', 'false');
            menu_more_button.parentNode.classList.remove('main-menu-more-expanded');
        } else if (false !== expand) {
            container.className += ' expanded';
            menu_more_button.setAttribute('aria-expanded', 'true');
            menu_more_button.parentNode.classList.add('main-menu-more-expanded');
        }
    }

    /**
     * Run our priority+ function as soon as the document is `ready`
     */
    document.addEventListener('DOMContentLoaded', function () {

        updateNavigationMenu(navContainer);

        // Also, run our priority+ function on selective refresh in the customizer.
        var hasSelectiveRefresh = (
            'undefined' !== typeof wp &&
            wp.customize &&
            wp.customize.selectiveRefresh &&
            wp.customize.navMenusPreview.NavMenuInstancePartial
        );

        if (hasSelectiveRefresh) {
            // Re-run our priority+ function on Nav Menu partial refreshes
            wp.customize.selectiveRefresh.bind('partial-content-rendered', function (placement) {

                var isNewNavMenu = (
                    placement &&
                    placement.partial.id.includes('nav_menu_instance') &&
                    'null' !== placement.container[0].parentNode &&
                    placement.container[0].parentNode.classList.contains('main-navigation')
                );

                if (isNewNavMenu) {
                    updateNavigationMenu(placement.container[0].parentNode);
                }
            });
        }
    });

    /**
     * Run our priority+ function on load
     */
    window.addEventListener('load', function () {
        updateNavigationMenu(navContainer);
    });

    /**
     * Run our priority+ function every time the window resizes
     */
    var isResizing = false;
    window.addEventListener('resize',
        debounce(function () {
            if (isResizing) {
                return;
            }

            isResizing = true;
            setTimeout(function () {
                updateNavigationMenu(navContainer);
                isResizing = false;
            }, 150);
        })
    );

    /**
     * More button
     */
    var menu_more_button = navContainer.getElementsByClassName('main-menu-more-toggle')[0];
    if ('undefined' !== typeof menu_more_button) {
        menu_more_button.onclick = function () {
            toggleMenuMore(navContainer);
        }
    }

    var visibleList = navContainer.querySelector('.main-menu');
    if ('undefined' !== typeof visibleList) {
        visibleList.addEventListener('mouseover', function () {
            toggleMenuMore(navContainer, false);
        });
    }

    /**
     * Run our priority+ function
     */
    updateNavigationMenu(navContainer);

})();
;
// ==================================================
// fancyBox v3.5.7
//
// Licensed GPLv3 for open source use
// or fancyBox Commercial License for commercial use
//
// http://fancyapps.com/fancybox/
// Copyright 2019 fancyApps
//
// ==================================================
!function(t,e,n,o){"use strict";function i(t,e){var o,i,a,s=[],r=0;t&&t.isDefaultPrevented()||(t.preventDefault(),e=e||{},t&&t.data&&(e=h(t.data.options,e)),o=e.$target||n(t.currentTarget).trigger("blur"),(a=n.fancybox.getInstance())&&a.$trigger&&a.$trigger.is(o)||(e.selector?s=n(e.selector):(i=o.attr("data-fancybox")||"",i?(s=t.data?t.data.items:[],s=s.length?s.filter('[data-fancybox="'+i+'"]'):n('[data-fancybox="'+i+'"]')):s=[o]),r=n(s).index(o),r<0&&(r=0),a=n.fancybox.open(s,e,r),a.$trigger=o))}if(t.console=t.console||{info:function(t){}},n){if(n.fn.fancybox)return void console.info("fancyBox already initialized");var a={closeExisting:!1,loop:!1,gutter:50,keyboard:!0,preventCaptionOverlap:!0,arrows:!0,infobar:!0,smallBtn:"auto",toolbar:"auto",buttons:["zoom","slideShow","thumbs","close"],idleTime:3,protect:!1,modal:!1,image:{preload:!1},ajax:{settings:{data:{fancybox:!0}}},iframe:{tpl:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" allowfullscreen="allowfullscreen" allow="autoplay; fullscreen" src=""></iframe>',preload:!0,css:{},attr:{scrolling:"auto"}},video:{tpl:'<video class="fancybox-video" controls controlsList="nodownload" poster="{{poster}}"><source src="{{src}}" type="{{format}}" />Sorry, your browser doesn\'t support embedded videos, <a href="{{src}}">download</a> and watch with your favorite video player!</video>',format:"",autoStart:!0},defaultType:"image",animationEffect:"zoom",animationDuration:366,zoomOpacity:"auto",transitionEffect:"fade",transitionDuration:366,slideClass:"",baseClass:"",baseTpl:'<div class="fancybox-container" role="dialog" tabindex="-1"><div class="fancybox-bg"></div><div class="fancybox-inner"><div class="fancybox-infobar"><span data-fancybox-index></span>&nbsp;/&nbsp;<span data-fancybox-count></span></div><div class="fancybox-toolbar">{{buttons}}</div><div class="fancybox-navigation">{{arrows}}</div><div class="fancybox-stage"></div><div class="fancybox-caption"><div class="fancybox-caption__body"></div></div></div></div>',spinnerTpl:'<div class="fancybox-loading"></div>',errorTpl:'<div class="fancybox-error"><p>{{ERROR}}</p></div>',btnTpl:{download:'<a download data-fancybox-download class="fancybox-button fancybox-button--download" title="{{DOWNLOAD}}" href="javascript:;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.62 17.09V19H5.38v-1.91zm-2.97-6.96L17 11.45l-5 4.87-5-4.87 1.36-1.32 2.68 2.64V5h1.92v7.77z"/></svg></a>',zoom:'<button data-fancybox-zoom class="fancybox-button fancybox-button--zoom" title="{{ZOOM}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.7 17.3l-3-3a5.9 5.9 0 0 0-.6-7.6 5.9 5.9 0 0 0-8.4 0 5.9 5.9 0 0 0 0 8.4 5.9 5.9 0 0 0 7.7.7l3 3a1 1 0 0 0 1.3 0c.4-.5.4-1 0-1.5zM8.1 13.8a4 4 0 0 1 0-5.7 4 4 0 0 1 5.7 0 4 4 0 0 1 0 5.7 4 4 0 0 1-5.7 0z"/></svg></button>',close:'<button data-fancybox-close class="fancybox-button fancybox-button--close" title="{{CLOSE}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 10.6L6.6 5.2 5.2 6.6l5.4 5.4-5.4 5.4 1.4 1.4 5.4-5.4 5.4 5.4 1.4-1.4-5.4-5.4 5.4-5.4-1.4-1.4-5.4 5.4z"/></svg></button>',arrowLeft:'<button data-fancybox-prev class="fancybox-button fancybox-button--arrow_left" title="{{PREV}}"><div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.28 15.7l-1.34 1.37L5 12l4.94-5.07 1.34 1.38-2.68 2.72H19v1.94H8.6z"/></svg></div></button>',arrowRight:'<button data-fancybox-next class="fancybox-button fancybox-button--arrow_right" title="{{NEXT}}"><div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.4 12.97l-2.68 2.72 1.34 1.38L19 12l-4.94-5.07-1.34 1.38 2.68 2.72H5v1.94z"/></svg></div></button>',smallBtn:'<button type="button" data-fancybox-close class="fancybox-button fancybox-close-small" title="{{CLOSE}}"><svg xmlns="http://www.w3.org/2000/svg" version="1" viewBox="0 0 24 24"><path d="M13 12l5-5-1-1-5 5-5-5-1 1 5 5-5 5 1 1 5-5 5 5 1-1z"/></svg></button>'},parentEl:"body",hideScrollbar:!0,autoFocus:!0,backFocus:!0,trapFocus:!0,fullScreen:{autoStart:!1},touch:{vertical:!0,momentum:!0},hash:null,media:{},slideShow:{autoStart:!1,speed:3e3},thumbs:{autoStart:!1,hideOnClose:!0,parentEl:".fancybox-container",axis:"y"},wheel:"auto",onInit:n.noop,beforeLoad:n.noop,afterLoad:n.noop,beforeShow:n.noop,afterShow:n.noop,beforeClose:n.noop,afterClose:n.noop,onActivate:n.noop,onDeactivate:n.noop,clickContent:function(t,e){return"image"===t.type&&"zoom"},clickSlide:"close",clickOutside:"close",dblclickContent:!1,dblclickSlide:!1,dblclickOutside:!1,mobile:{preventCaptionOverlap:!1,idleTime:!1,clickContent:function(t,e){return"image"===t.type&&"toggleControls"},clickSlide:function(t,e){return"image"===t.type?"toggleControls":"close"},dblclickContent:function(t,e){return"image"===t.type&&"zoom"},dblclickSlide:function(t,e){return"image"===t.type&&"zoom"}},lang:"en",i18n:{en:{CLOSE:"Close",NEXT:"Next",PREV:"Previous",ERROR:"The requested content cannot be loaded. <br/> Please try again later.",PLAY_START:"Start slideshow",PLAY_STOP:"Pause slideshow",FULL_SCREEN:"Full screen",THUMBS:"Thumbnails",DOWNLOAD:"Download",SHARE:"Share",ZOOM:"Zoom"},de:{CLOSE:"Schlie&szlig;en",NEXT:"Weiter",PREV:"Zur&uuml;ck",ERROR:"Die angeforderten Daten konnten nicht geladen werden. <br/> Bitte versuchen Sie es sp&auml;ter nochmal.",PLAY_START:"Diaschau starten",PLAY_STOP:"Diaschau beenden",FULL_SCREEN:"Vollbild",THUMBS:"Vorschaubilder",DOWNLOAD:"Herunterladen",SHARE:"Teilen",ZOOM:"Vergr&ouml;&szlig;ern"}}},s=n(t),r=n(e),c=0,l=function(t){return t&&t.hasOwnProperty&&t instanceof n},d=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||function(e){return t.setTimeout(e,1e3/60)}}(),u=function(){return t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.mozCancelAnimationFrame||t.oCancelAnimationFrame||function(e){t.clearTimeout(e)}}(),f=function(){var t,n=e.createElement("fakeelement"),o={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in o)if(void 0!==n.style[t])return o[t];return"transitionend"}(),p=function(t){return t&&t.length&&t[0].offsetHeight},h=function(t,e){var o=n.extend(!0,{},t,e);return n.each(e,function(t,e){n.isArray(e)&&(o[t]=e)}),o},g=function(t){var o,i;return!(!t||t.ownerDocument!==e)&&(n(".fancybox-container").css("pointer-events","none"),o={x:t.getBoundingClientRect().left+t.offsetWidth/2,y:t.getBoundingClientRect().top+t.offsetHeight/2},i=e.elementFromPoint(o.x,o.y)===t,n(".fancybox-container").css("pointer-events",""),i)},b=function(t,e,o){var i=this;i.opts=h({index:o},n.fancybox.defaults),n.isPlainObject(e)&&(i.opts=h(i.opts,e)),n.fancybox.isMobile&&(i.opts=h(i.opts,i.opts.mobile)),i.id=i.opts.id||++c,i.currIndex=parseInt(i.opts.index,10)||0,i.prevIndex=null,i.prevPos=null,i.currPos=0,i.firstRun=!0,i.group=[],i.slides={},i.addContent(t),i.group.length&&i.init()};n.extend(b.prototype,{init:function(){var o,i,a=this,s=a.group[a.currIndex],r=s.opts;r.closeExisting&&n.fancybox.close(!0),n("body").addClass("fancybox-active"),!n.fancybox.getInstance()&&!1!==r.hideScrollbar&&!n.fancybox.isMobile&&e.body.scrollHeight>t.innerHeight&&(n("head").append('<style id="fancybox-style-noscroll" type="text/css">.compensate-for-scrollbar{margin-right:'+(t.innerWidth-e.documentElement.clientWidth)+"px;}</style>"),n("body").addClass("compensate-for-scrollbar")),i="",n.each(r.buttons,function(t,e){i+=r.btnTpl[e]||""}),o=n(a.translate(a,r.baseTpl.replace("{{buttons}}",i).replace("{{arrows}}",r.btnTpl.arrowLeft+r.btnTpl.arrowRight))).attr("id","fancybox-container-"+a.id).addClass(r.baseClass).data("FancyBox",a).appendTo(r.parentEl),a.$refs={container:o},["bg","inner","infobar","toolbar","stage","caption","navigation"].forEach(function(t){a.$refs[t]=o.find(".fancybox-"+t)}),a.trigger("onInit"),a.activate(),a.jumpTo(a.currIndex)},translate:function(t,e){var n=t.opts.i18n[t.opts.lang]||t.opts.i18n.en;return e.replace(/\{\{(\w+)\}\}/g,function(t,e){return void 0===n[e]?t:n[e]})},addContent:function(t){var e,o=this,i=n.makeArray(t);n.each(i,function(t,e){var i,a,s,r,c,l={},d={};n.isPlainObject(e)?(l=e,d=e.opts||e):"object"===n.type(e)&&n(e).length?(i=n(e),d=i.data()||{},d=n.extend(!0,{},d,d.options),d.$orig=i,l.src=o.opts.src||d.src||i.attr("href"),l.type||l.src||(l.type="inline",l.src=e)):l={type:"html",src:e+""},l.opts=n.extend(!0,{},o.opts,d),n.isArray(d.buttons)&&(l.opts.buttons=d.buttons),n.fancybox.isMobile&&l.opts.mobile&&(l.opts=h(l.opts,l.opts.mobile)),a=l.type||l.opts.type,r=l.src||"",!a&&r&&((s=r.match(/\.(mp4|mov|ogv|webm)((\?|#).*)?$/i))?(a="video",l.opts.video.format||(l.opts.video.format="video/"+("ogv"===s[1]?"ogg":s[1]))):r.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)?a="image":r.match(/\.(pdf)((\?|#).*)?$/i)?(a="iframe",l=n.extend(!0,l,{contentType:"pdf",opts:{iframe:{preload:!1}}})):"#"===r.charAt(0)&&(a="inline")),a?l.type=a:o.trigger("objectNeedsType",l),l.contentType||(l.contentType=n.inArray(l.type,["html","inline","ajax"])>-1?"html":l.type),l.index=o.group.length,"auto"==l.opts.smallBtn&&(l.opts.smallBtn=n.inArray(l.type,["html","inline","ajax"])>-1),"auto"===l.opts.toolbar&&(l.opts.toolbar=!l.opts.smallBtn),l.$thumb=l.opts.$thumb||null,l.opts.$trigger&&l.index===o.opts.index&&(l.$thumb=l.opts.$trigger.find("img:first"),l.$thumb.length&&(l.opts.$orig=l.opts.$trigger)),l.$thumb&&l.$thumb.length||!l.opts.$orig||(l.$thumb=l.opts.$orig.find("img:first")),l.$thumb&&!l.$thumb.length&&(l.$thumb=null),l.thumb=l.opts.thumb||(l.$thumb?l.$thumb[0].src:null),"function"===n.type(l.opts.caption)&&(l.opts.caption=l.opts.caption.apply(e,[o,l])),"function"===n.type(o.opts.caption)&&(l.opts.caption=o.opts.caption.apply(e,[o,l])),l.opts.caption instanceof n||(l.opts.caption=void 0===l.opts.caption?"":l.opts.caption+""),"ajax"===l.type&&(c=r.split(/\s+/,2),c.length>1&&(l.src=c.shift(),l.opts.filter=c.shift())),l.opts.modal&&(l.opts=n.extend(!0,l.opts,{trapFocus:!0,infobar:0,toolbar:0,smallBtn:0,keyboard:0,slideShow:0,fullScreen:0,thumbs:0,touch:0,clickContent:!1,clickSlide:!1,clickOutside:!1,dblclickContent:!1,dblclickSlide:!1,dblclickOutside:!1})),o.group.push(l)}),Object.keys(o.slides).length&&(o.updateControls(),(e=o.Thumbs)&&e.isActive&&(e.create(),e.focus()))},addEvents:function(){var e=this;e.removeEvents(),e.$refs.container.on("click.fb-close","[data-fancybox-close]",function(t){t.stopPropagation(),t.preventDefault(),e.close(t)}).on("touchstart.fb-prev click.fb-prev","[data-fancybox-prev]",function(t){t.stopPropagation(),t.preventDefault(),e.previous()}).on("touchstart.fb-next click.fb-next","[data-fancybox-next]",function(t){t.stopPropagation(),t.preventDefault(),e.next()}).on("click.fb","[data-fancybox-zoom]",function(t){e[e.isScaledDown()?"scaleToActual":"scaleToFit"]()}),s.on("orientationchange.fb resize.fb",function(t){t&&t.originalEvent&&"resize"===t.originalEvent.type?(e.requestId&&u(e.requestId),e.requestId=d(function(){e.update(t)})):(e.current&&"iframe"===e.current.type&&e.$refs.stage.hide(),setTimeout(function(){e.$refs.stage.show(),e.update(t)},n.fancybox.isMobile?600:250))}),r.on("keydown.fb",function(t){var o=n.fancybox?n.fancybox.getInstance():null,i=o.current,a=t.keyCode||t.which;if(9==a)return void(i.opts.trapFocus&&e.focus(t));if(!(!i.opts.keyboard||t.ctrlKey||t.altKey||t.shiftKey||n(t.target).is("input,textarea,video,audio,select")))return 8===a||27===a?(t.preventDefault(),void e.close(t)):37===a||38===a?(t.preventDefault(),void e.previous()):39===a||40===a?(t.preventDefault(),void e.next()):void e.trigger("afterKeydown",t,a)}),e.group[e.currIndex].opts.idleTime&&(e.idleSecondsCounter=0,r.on("mousemove.fb-idle mouseleave.fb-idle mousedown.fb-idle touchstart.fb-idle touchmove.fb-idle scroll.fb-idle keydown.fb-idle",function(t){e.idleSecondsCounter=0,e.isIdle&&e.showControls(),e.isIdle=!1}),e.idleInterval=t.setInterval(function(){++e.idleSecondsCounter>=e.group[e.currIndex].opts.idleTime&&!e.isDragging&&(e.isIdle=!0,e.idleSecondsCounter=0,e.hideControls())},1e3))},removeEvents:function(){var e=this;s.off("orientationchange.fb resize.fb"),r.off("keydown.fb .fb-idle"),this.$refs.container.off(".fb-close .fb-prev .fb-next"),e.idleInterval&&(t.clearInterval(e.idleInterval),e.idleInterval=null)},previous:function(t){return this.jumpTo(this.currPos-1,t)},next:function(t){return this.jumpTo(this.currPos+1,t)},jumpTo:function(t,e){var o,i,a,s,r,c,l,d,u,f=this,h=f.group.length;if(!(f.isDragging||f.isClosing||f.isAnimating&&f.firstRun)){if(t=parseInt(t,10),!(a=f.current?f.current.opts.loop:f.opts.loop)&&(t<0||t>=h))return!1;if(o=f.firstRun=!Object.keys(f.slides).length,r=f.current,f.prevIndex=f.currIndex,f.prevPos=f.currPos,s=f.createSlide(t),h>1&&((a||s.index<h-1)&&f.createSlide(t+1),(a||s.index>0)&&f.createSlide(t-1)),f.current=s,f.currIndex=s.index,f.currPos=s.pos,f.trigger("beforeShow",o),f.updateControls(),s.forcedDuration=void 0,n.isNumeric(e)?s.forcedDuration=e:e=s.opts[o?"animationDuration":"transitionDuration"],e=parseInt(e,10),i=f.isMoved(s),s.$slide.addClass("fancybox-slide--current"),o)return s.opts.animationEffect&&e&&f.$refs.container.css("transition-duration",e+"ms"),f.$refs.container.addClass("fancybox-is-open").trigger("focus"),f.loadSlide(s),void f.preload("image");c=n.fancybox.getTranslate(r.$slide),l=n.fancybox.getTranslate(f.$refs.stage),n.each(f.slides,function(t,e){n.fancybox.stop(e.$slide,!0)}),r.pos!==s.pos&&(r.isComplete=!1),r.$slide.removeClass("fancybox-slide--complete fancybox-slide--current"),i?(u=c.left-(r.pos*c.width+r.pos*r.opts.gutter),n.each(f.slides,function(t,o){o.$slide.removeClass("fancybox-animated").removeClass(function(t,e){return(e.match(/(^|\s)fancybox-fx-\S+/g)||[]).join(" ")});var i=o.pos*c.width+o.pos*o.opts.gutter;n.fancybox.setTranslate(o.$slide,{top:0,left:i-l.left+u}),o.pos!==s.pos&&o.$slide.addClass("fancybox-slide--"+(o.pos>s.pos?"next":"previous")),p(o.$slide),n.fancybox.animate(o.$slide,{top:0,left:(o.pos-s.pos)*c.width+(o.pos-s.pos)*o.opts.gutter},e,function(){o.$slide.css({transform:"",opacity:""}).removeClass("fancybox-slide--next fancybox-slide--previous"),o.pos===f.currPos&&f.complete()})})):e&&s.opts.transitionEffect&&(d="fancybox-animated fancybox-fx-"+s.opts.transitionEffect,r.$slide.addClass("fancybox-slide--"+(r.pos>s.pos?"next":"previous")),n.fancybox.animate(r.$slide,d,e,function(){r.$slide.removeClass(d).removeClass("fancybox-slide--next fancybox-slide--previous")},!1)),s.isLoaded?f.revealContent(s):f.loadSlide(s),f.preload("image")}},createSlide:function(t){var e,o,i=this;return o=t%i.group.length,o=o<0?i.group.length+o:o,!i.slides[t]&&i.group[o]&&(e=n('<div class="fancybox-slide"></div>').appendTo(i.$refs.stage),i.slides[t]=n.extend(!0,{},i.group[o],{pos:t,$slide:e,isLoaded:!1}),i.updateSlide(i.slides[t])),i.slides[t]},scaleToActual:function(t,e,o){var i,a,s,r,c,l=this,d=l.current,u=d.$content,f=n.fancybox.getTranslate(d.$slide).width,p=n.fancybox.getTranslate(d.$slide).height,h=d.width,g=d.height;l.isAnimating||l.isMoved()||!u||"image"!=d.type||!d.isLoaded||d.hasError||(l.isAnimating=!0,n.fancybox.stop(u),t=void 0===t?.5*f:t,e=void 0===e?.5*p:e,i=n.fancybox.getTranslate(u),i.top-=n.fancybox.getTranslate(d.$slide).top,i.left-=n.fancybox.getTranslate(d.$slide).left,r=h/i.width,c=g/i.height,a=.5*f-.5*h,s=.5*p-.5*g,h>f&&(a=i.left*r-(t*r-t),a>0&&(a=0),a<f-h&&(a=f-h)),g>p&&(s=i.top*c-(e*c-e),s>0&&(s=0),s<p-g&&(s=p-g)),l.updateCursor(h,g),n.fancybox.animate(u,{top:s,left:a,scaleX:r,scaleY:c},o||366,function(){l.isAnimating=!1}),l.SlideShow&&l.SlideShow.isActive&&l.SlideShow.stop())},scaleToFit:function(t){var e,o=this,i=o.current,a=i.$content;o.isAnimating||o.isMoved()||!a||"image"!=i.type||!i.isLoaded||i.hasError||(o.isAnimating=!0,n.fancybox.stop(a),e=o.getFitPos(i),o.updateCursor(e.width,e.height),n.fancybox.animate(a,{top:e.top,left:e.left,scaleX:e.width/a.width(),scaleY:e.height/a.height()},t||366,function(){o.isAnimating=!1}))},getFitPos:function(t){var e,o,i,a,s=this,r=t.$content,c=t.$slide,l=t.width||t.opts.width,d=t.height||t.opts.height,u={};return!!(t.isLoaded&&r&&r.length)&&(e=n.fancybox.getTranslate(s.$refs.stage).width,o=n.fancybox.getTranslate(s.$refs.stage).height,e-=parseFloat(c.css("paddingLeft"))+parseFloat(c.css("paddingRight"))+parseFloat(r.css("marginLeft"))+parseFloat(r.css("marginRight")),o-=parseFloat(c.css("paddingTop"))+parseFloat(c.css("paddingBottom"))+parseFloat(r.css("marginTop"))+parseFloat(r.css("marginBottom")),l&&d||(l=e,d=o),i=Math.min(1,e/l,o/d),l*=i,d*=i,l>e-.5&&(l=e),d>o-.5&&(d=o),"image"===t.type?(u.top=Math.floor(.5*(o-d))+parseFloat(c.css("paddingTop")),u.left=Math.floor(.5*(e-l))+parseFloat(c.css("paddingLeft"))):"video"===t.contentType&&(a=t.opts.width&&t.opts.height?l/d:t.opts.ratio||16/9,d>l/a?d=l/a:l>d*a&&(l=d*a)),u.width=l,u.height=d,u)},update:function(t){var e=this;n.each(e.slides,function(n,o){e.updateSlide(o,t)})},updateSlide:function(t,e){var o=this,i=t&&t.$content,a=t.width||t.opts.width,s=t.height||t.opts.height,r=t.$slide;o.adjustCaption(t),i&&(a||s||"video"===t.contentType)&&!t.hasError&&(n.fancybox.stop(i),n.fancybox.setTranslate(i,o.getFitPos(t)),t.pos===o.currPos&&(o.isAnimating=!1,o.updateCursor())),o.adjustLayout(t),r.length&&(r.trigger("refresh"),t.pos===o.currPos&&o.$refs.toolbar.add(o.$refs.navigation.find(".fancybox-button--arrow_right")).toggleClass("compensate-for-scrollbar",r.get(0).scrollHeight>r.get(0).clientHeight)),o.trigger("onUpdate",t,e)},centerSlide:function(t){var e=this,o=e.current,i=o.$slide;!e.isClosing&&o&&(i.siblings().css({transform:"",opacity:""}),i.parent().children().removeClass("fancybox-slide--previous fancybox-slide--next"),n.fancybox.animate(i,{top:0,left:0,opacity:1},void 0===t?0:t,function(){i.css({transform:"",opacity:""}),o.isComplete||e.complete()},!1))},isMoved:function(t){var e,o,i=t||this.current;return!!i&&(o=n.fancybox.getTranslate(this.$refs.stage),e=n.fancybox.getTranslate(i.$slide),!i.$slide.hasClass("fancybox-animated")&&(Math.abs(e.top-o.top)>.5||Math.abs(e.left-o.left)>.5))},updateCursor:function(t,e){var o,i,a=this,s=a.current,r=a.$refs.container;s&&!a.isClosing&&a.Guestures&&(r.removeClass("fancybox-is-zoomable fancybox-can-zoomIn fancybox-can-zoomOut fancybox-can-swipe fancybox-can-pan"),o=a.canPan(t,e),i=!!o||a.isZoomable(),r.toggleClass("fancybox-is-zoomable",i),n("[data-fancybox-zoom]").prop("disabled",!i),o?r.addClass("fancybox-can-pan"):i&&("zoom"===s.opts.clickContent||n.isFunction(s.opts.clickContent)&&"zoom"==s.opts.clickContent(s))?r.addClass("fancybox-can-zoomIn"):s.opts.touch&&(s.opts.touch.vertical||a.group.length>1)&&"video"!==s.contentType&&r.addClass("fancybox-can-swipe"))},isZoomable:function(){var t,e=this,n=e.current;if(n&&!e.isClosing&&"image"===n.type&&!n.hasError){if(!n.isLoaded)return!0;if((t=e.getFitPos(n))&&(n.width>t.width||n.height>t.height))return!0}return!1},isScaledDown:function(t,e){var o=this,i=!1,a=o.current,s=a.$content;return void 0!==t&&void 0!==e?i=t<a.width&&e<a.height:s&&(i=n.fancybox.getTranslate(s),i=i.width<a.width&&i.height<a.height),i},canPan:function(t,e){var o=this,i=o.current,a=null,s=!1;return"image"===i.type&&(i.isComplete||t&&e)&&!i.hasError&&(s=o.getFitPos(i),void 0!==t&&void 0!==e?a={width:t,height:e}:i.isComplete&&(a=n.fancybox.getTranslate(i.$content)),a&&s&&(s=Math.abs(a.width-s.width)>1.5||Math.abs(a.height-s.height)>1.5)),s},loadSlide:function(t){var e,o,i,a=this;if(!t.isLoading&&!t.isLoaded){if(t.isLoading=!0,!1===a.trigger("beforeLoad",t))return t.isLoading=!1,!1;switch(e=t.type,o=t.$slide,o.off("refresh").trigger("onReset").addClass(t.opts.slideClass),e){case"image":a.setImage(t);break;case"iframe":a.setIframe(t);break;case"html":a.setContent(t,t.src||t.content);break;case"video":a.setContent(t,t.opts.video.tpl.replace(/\{\{src\}\}/gi,t.src).replace("{{format}}",t.opts.videoFormat||t.opts.video.format||"").replace("{{poster}}",t.thumb||""));break;case"inline":n(t.src).length?a.setContent(t,n(t.src)):a.setError(t);break;case"ajax":a.showLoading(t),i=n.ajax(n.extend({},t.opts.ajax.settings,{url:t.src,success:function(e,n){"success"===n&&a.setContent(t,e)},error:function(e,n){e&&"abort"!==n&&a.setError(t)}})),o.one("onReset",function(){i.abort()});break;default:a.setError(t)}return!0}},setImage:function(t){var o,i=this;setTimeout(function(){var e=t.$image;i.isClosing||!t.isLoading||e&&e.length&&e[0].complete||t.hasError||i.showLoading(t)},50),i.checkSrcset(t),t.$content=n('<div class="fancybox-content"></div>').addClass("fancybox-is-hidden").appendTo(t.$slide.addClass("fancybox-slide--image")),!1!==t.opts.preload&&t.opts.width&&t.opts.height&&t.thumb&&(t.width=t.opts.width,t.height=t.opts.height,o=e.createElement("img"),o.onerror=function(){n(this).remove(),t.$ghost=null},o.onload=function(){i.afterLoad(t)},t.$ghost=n(o).addClass("fancybox-image").appendTo(t.$content).attr("src",t.thumb)),i.setBigImage(t)},checkSrcset:function(e){var n,o,i,a,s=e.opts.srcset||e.opts.image.srcset;if(s){i=t.devicePixelRatio||1,a=t.innerWidth*i,o=s.split(",").map(function(t){var e={};return t.trim().split(/\s+/).forEach(function(t,n){var o=parseInt(t.substring(0,t.length-1),10);if(0===n)return e.url=t;o&&(e.value=o,e.postfix=t[t.length-1])}),e}),o.sort(function(t,e){return t.value-e.value});for(var r=0;r<o.length;r++){var c=o[r];if("w"===c.postfix&&c.value>=a||"x"===c.postfix&&c.value>=i){n=c;break}}!n&&o.length&&(n=o[o.length-1]),n&&(e.src=n.url,e.width&&e.height&&"w"==n.postfix&&(e.height=e.width/e.height*n.value,e.width=n.value),e.opts.srcset=s)}},setBigImage:function(t){var o=this,i=e.createElement("img"),a=n(i);t.$image=a.one("error",function(){o.setError(t)}).one("load",function(){var e;t.$ghost||(o.resolveImageSlideSize(t,this.naturalWidth,this.naturalHeight),o.afterLoad(t)),o.isClosing||(t.opts.srcset&&(e=t.opts.sizes,e&&"auto"!==e||(e=(t.width/t.height>1&&s.width()/s.height()>1?"100":Math.round(t.width/t.height*100))+"vw"),a.attr("sizes",e).attr("srcset",t.opts.srcset)),t.$ghost&&setTimeout(function(){t.$ghost&&!o.isClosing&&t.$ghost.hide()},Math.min(300,Math.max(1e3,t.height/1600))),o.hideLoading(t))}).addClass("fancybox-image").attr("src",t.src).appendTo(t.$content),(i.complete||"complete"==i.readyState)&&a.naturalWidth&&a.naturalHeight?a.trigger("load"):i.error&&a.trigger("error")},resolveImageSlideSize:function(t,e,n){var o=parseInt(t.opts.width,10),i=parseInt(t.opts.height,10);t.width=e,t.height=n,o>0&&(t.width=o,t.height=Math.floor(o*n/e)),i>0&&(t.width=Math.floor(i*e/n),t.height=i)},setIframe:function(t){var e,o=this,i=t.opts.iframe,a=t.$slide;t.$content=n('<div class="fancybox-content'+(i.preload?" fancybox-is-hidden":"")+'"></div>').css(i.css).appendTo(a),a.addClass("fancybox-slide--"+t.contentType),t.$iframe=e=n(i.tpl.replace(/\{rnd\}/g,(new Date).getTime())).attr(i.attr).appendTo(t.$content),i.preload?(o.showLoading(t),e.on("load.fb error.fb",function(e){this.isReady=1,t.$slide.trigger("refresh"),o.afterLoad(t)}),a.on("refresh.fb",function(){var n,o,s=t.$content,r=i.css.width,c=i.css.height;if(1===e[0].isReady){try{n=e.contents(),o=n.find("body")}catch(t){}o&&o.length&&o.children().length&&(a.css("overflow","visible"),s.css({width:"100%","max-width":"100%",height:"9999px"}),void 0===r&&(r=Math.ceil(Math.max(o[0].clientWidth,o.outerWidth(!0)))),s.css("width",r||"").css("max-width",""),void 0===c&&(c=Math.ceil(Math.max(o[0].clientHeight,o.outerHeight(!0)))),s.css("height",c||""),a.css("overflow","auto")),s.removeClass("fancybox-is-hidden")}})):o.afterLoad(t),e.attr("src",t.src),a.one("onReset",function(){try{n(this).find("iframe").hide().unbind().attr("src","//about:blank")}catch(t){}n(this).off("refresh.fb").empty(),t.isLoaded=!1,t.isRevealed=!1})},setContent:function(t,e){var o=this;o.isClosing||(o.hideLoading(t),t.$content&&n.fancybox.stop(t.$content),t.$slide.empty(),l(e)&&e.parent().length?((e.hasClass("fancybox-content")||e.parent().hasClass("fancybox-content"))&&e.parents(".fancybox-slide").trigger("onReset"),t.$placeholder=n("<div>").hide().insertAfter(e),e.css("display","inline-block")):t.hasError||("string"===n.type(e)&&(e=n("<div>").append(n.trim(e)).contents()),t.opts.filter&&(e=n("<div>").html(e).find(t.opts.filter))),t.$slide.one("onReset",function(){n(this).find("video,audio").trigger("pause"),t.$placeholder&&(t.$placeholder.after(e.removeClass("fancybox-content").hide()).remove(),t.$placeholder=null),t.$smallBtn&&(t.$smallBtn.remove(),t.$smallBtn=null),t.hasError||(n(this).empty(),t.isLoaded=!1,t.isRevealed=!1)}),n(e).appendTo(t.$slide),n(e).is("video,audio")&&(n(e).addClass("fancybox-video"),n(e).wrap("<div></div>"),t.contentType="video",t.opts.width=t.opts.width||n(e).attr("width"),t.opts.height=t.opts.height||n(e).attr("height")),t.$content=t.$slide.children().filter("div,form,main,video,audio,article,.fancybox-content").first(),t.$content.siblings().hide(),t.$content.length||(t.$content=t.$slide.wrapInner("<div></div>").children().first()),t.$content.addClass("fancybox-content"),t.$slide.addClass("fancybox-slide--"+t.contentType),o.afterLoad(t))},setError:function(t){t.hasError=!0,t.$slide.trigger("onReset").removeClass("fancybox-slide--"+t.contentType).addClass("fancybox-slide--error"),t.contentType="html",this.setContent(t,this.translate(t,t.opts.errorTpl)),t.pos===this.currPos&&(this.isAnimating=!1)},showLoading:function(t){var e=this;(t=t||e.current)&&!t.$spinner&&(t.$spinner=n(e.translate(e,e.opts.spinnerTpl)).appendTo(t.$slide).hide().fadeIn("fast"))},hideLoading:function(t){var e=this;(t=t||e.current)&&t.$spinner&&(t.$spinner.stop().remove(),delete t.$spinner)},afterLoad:function(t){var e=this;e.isClosing||(t.isLoading=!1,t.isLoaded=!0,e.trigger("afterLoad",t),e.hideLoading(t),!t.opts.smallBtn||t.$smallBtn&&t.$smallBtn.length||(t.$smallBtn=n(e.translate(t,t.opts.btnTpl.smallBtn)).appendTo(t.$content)),t.opts.protect&&t.$content&&!t.hasError&&(t.$content.on("contextmenu.fb",function(t){return 2==t.button&&t.preventDefault(),!0}),"image"===t.type&&n('<div class="fancybox-spaceball"></div>').appendTo(t.$content)),e.adjustCaption(t),e.adjustLayout(t),t.pos===e.currPos&&e.updateCursor(),e.revealContent(t))},adjustCaption:function(t){var e,n=this,o=t||n.current,i=o.opts.caption,a=o.opts.preventCaptionOverlap,s=n.$refs.caption,r=!1;s.toggleClass("fancybox-caption--separate",a),a&&i&&i.length&&(o.pos!==n.currPos?(e=s.clone().appendTo(s.parent()),e.children().eq(0).empty().html(i),r=e.outerHeight(!0),e.empty().remove()):n.$caption&&(r=n.$caption.outerHeight(!0)),o.$slide.css("padding-bottom",r||""))},adjustLayout:function(t){var e,n,o,i,a=this,s=t||a.current;s.isLoaded&&!0!==s.opts.disableLayoutFix&&(s.$content.css("margin-bottom",""),s.$content.outerHeight()>s.$slide.height()+.5&&(o=s.$slide[0].style["padding-bottom"],i=s.$slide.css("padding-bottom"),parseFloat(i)>0&&(e=s.$slide[0].scrollHeight,s.$slide.css("padding-bottom",0),Math.abs(e-s.$slide[0].scrollHeight)<1&&(n=i),s.$slide.css("padding-bottom",o))),s.$content.css("margin-bottom",n))},revealContent:function(t){var e,o,i,a,s=this,r=t.$slide,c=!1,l=!1,d=s.isMoved(t),u=t.isRevealed;return t.isRevealed=!0,e=t.opts[s.firstRun?"animationEffect":"transitionEffect"],i=t.opts[s.firstRun?"animationDuration":"transitionDuration"],i=parseInt(void 0===t.forcedDuration?i:t.forcedDuration,10),!d&&t.pos===s.currPos&&i||(e=!1),"zoom"===e&&(t.pos===s.currPos&&i&&"image"===t.type&&!t.hasError&&(l=s.getThumbPos(t))?c=s.getFitPos(t):e="fade"),"zoom"===e?(s.isAnimating=!0,c.scaleX=c.width/l.width,c.scaleY=c.height/l.height,a=t.opts.zoomOpacity,"auto"==a&&(a=Math.abs(t.width/t.height-l.width/l.height)>.1),a&&(l.opacity=.1,c.opacity=1),n.fancybox.setTranslate(t.$content.removeClass("fancybox-is-hidden"),l),p(t.$content),void n.fancybox.animate(t.$content,c,i,function(){s.isAnimating=!1,s.complete()})):(s.updateSlide(t),e?(n.fancybox.stop(r),o="fancybox-slide--"+(t.pos>=s.prevPos?"next":"previous")+" fancybox-animated fancybox-fx-"+e,r.addClass(o).removeClass("fancybox-slide--current"),t.$content.removeClass("fancybox-is-hidden"),p(r),"image"!==t.type&&t.$content.hide().show(0),void n.fancybox.animate(r,"fancybox-slide--current",i,function(){r.removeClass(o).css({transform:"",opacity:""}),t.pos===s.currPos&&s.complete()},!0)):(t.$content.removeClass("fancybox-is-hidden"),u||!d||"image"!==t.type||t.hasError||t.$content.hide().fadeIn("fast"),void(t.pos===s.currPos&&s.complete())))},getThumbPos:function(t){var e,o,i,a,s,r=!1,c=t.$thumb;return!(!c||!g(c[0]))&&(e=n.fancybox.getTranslate(c),o=parseFloat(c.css("border-top-width")||0),i=parseFloat(c.css("border-right-width")||0),a=parseFloat(c.css("border-bottom-width")||0),s=parseFloat(c.css("border-left-width")||0),r={top:e.top+o,left:e.left+s,width:e.width-i-s,height:e.height-o-a,scaleX:1,scaleY:1},e.width>0&&e.height>0&&r)},complete:function(){var t,e=this,o=e.current,i={};!e.isMoved()&&o.isLoaded&&(o.isComplete||(o.isComplete=!0,o.$slide.siblings().trigger("onReset"),e.preload("inline"),p(o.$slide),o.$slide.addClass("fancybox-slide--complete"),n.each(e.slides,function(t,o){o.pos>=e.currPos-1&&o.pos<=e.currPos+1?i[o.pos]=o:o&&(n.fancybox.stop(o.$slide),o.$slide.off().remove())}),e.slides=i),e.isAnimating=!1,e.updateCursor(),e.trigger("afterShow"),o.opts.video.autoStart&&o.$slide.find("video,audio").filter(":visible:first").trigger("play").one("ended",function(){Document.exitFullscreen?Document.exitFullscreen():this.webkitExitFullscreen&&this.webkitExitFullscreen(),e.next()}),o.opts.autoFocus&&"html"===o.contentType&&(t=o.$content.find("input[autofocus]:enabled:visible:first"),t.length?t.trigger("focus"):e.focus(null,!0)),o.$slide.scrollTop(0).scrollLeft(0))},preload:function(t){var e,n,o=this;o.group.length<2||(n=o.slides[o.currPos+1],e=o.slides[o.currPos-1],e&&e.type===t&&o.loadSlide(e),n&&n.type===t&&o.loadSlide(n))},focus:function(t,o){var i,a,s=this,r=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","video","audio","[contenteditable]",'[tabindex]:not([tabindex^="-"])'].join(",");s.isClosing||(i=!t&&s.current&&s.current.isComplete?s.current.$slide.find("*:visible"+(o?":not(.fancybox-close-small)":"")):s.$refs.container.find("*:visible"),i=i.filter(r).filter(function(){return"hidden"!==n(this).css("visibility")&&!n(this).hasClass("disabled")}),i.length?(a=i.index(e.activeElement),t&&t.shiftKey?(a<0||0==a)&&(t.preventDefault(),i.eq(i.length-1).trigger("focus")):(a<0||a==i.length-1)&&(t&&t.preventDefault(),i.eq(0).trigger("focus"))):s.$refs.container.trigger("focus"))},activate:function(){var t=this;n(".fancybox-container").each(function(){var e=n(this).data("FancyBox");e&&e.id!==t.id&&!e.isClosing&&(e.trigger("onDeactivate"),e.removeEvents(),e.isVisible=!1)}),t.isVisible=!0,(t.current||t.isIdle)&&(t.update(),t.updateControls()),t.trigger("onActivate"),t.addEvents()},close:function(t,e){var o,i,a,s,r,c,l,u=this,f=u.current,h=function(){u.cleanUp(t)};return!u.isClosing&&(u.isClosing=!0,!1===u.trigger("beforeClose",t)?(u.isClosing=!1,d(function(){u.update()}),!1):(u.removeEvents(),a=f.$content,o=f.opts.animationEffect,i=n.isNumeric(e)?e:o?f.opts.animationDuration:0,f.$slide.removeClass("fancybox-slide--complete fancybox-slide--next fancybox-slide--previous fancybox-animated"),!0!==t?n.fancybox.stop(f.$slide):o=!1,f.$slide.siblings().trigger("onReset").remove(),i&&u.$refs.container.removeClass("fancybox-is-open").addClass("fancybox-is-closing").css("transition-duration",i+"ms"),u.hideLoading(f),u.hideControls(!0),u.updateCursor(),"zoom"!==o||a&&i&&"image"===f.type&&!u.isMoved()&&!f.hasError&&(l=u.getThumbPos(f))||(o="fade"),"zoom"===o?(n.fancybox.stop(a),s=n.fancybox.getTranslate(a),c={top:s.top,left:s.left,scaleX:s.width/l.width,scaleY:s.height/l.height,width:l.width,height:l.height},r=f.opts.zoomOpacity,
"auto"==r&&(r=Math.abs(f.width/f.height-l.width/l.height)>.1),r&&(l.opacity=0),n.fancybox.setTranslate(a,c),p(a),n.fancybox.animate(a,l,i,h),!0):(o&&i?n.fancybox.animate(f.$slide.addClass("fancybox-slide--previous").removeClass("fancybox-slide--current"),"fancybox-animated fancybox-fx-"+o,i,h):!0===t?setTimeout(h,i):h(),!0)))},cleanUp:function(e){var o,i,a,s=this,r=s.current.opts.$orig;s.current.$slide.trigger("onReset"),s.$refs.container.empty().remove(),s.trigger("afterClose",e),s.current.opts.backFocus&&(r&&r.length&&r.is(":visible")||(r=s.$trigger),r&&r.length&&(i=t.scrollX,a=t.scrollY,r.trigger("focus"),n("html, body").scrollTop(a).scrollLeft(i))),s.current=null,o=n.fancybox.getInstance(),o?o.activate():(n("body").removeClass("fancybox-active compensate-for-scrollbar"),n("#fancybox-style-noscroll").remove())},trigger:function(t,e){var o,i=Array.prototype.slice.call(arguments,1),a=this,s=e&&e.opts?e:a.current;if(s?i.unshift(s):s=a,i.unshift(a),n.isFunction(s.opts[t])&&(o=s.opts[t].apply(s,i)),!1===o)return o;"afterClose"!==t&&a.$refs?a.$refs.container.trigger(t+".fb",i):r.trigger(t+".fb",i)},updateControls:function(){var t=this,o=t.current,i=o.index,a=t.$refs.container,s=t.$refs.caption,r=o.opts.caption;o.$slide.trigger("refresh"),r&&r.length?(t.$caption=s,s.children().eq(0).html(r)):t.$caption=null,t.hasHiddenControls||t.isIdle||t.showControls(),a.find("[data-fancybox-count]").html(t.group.length),a.find("[data-fancybox-index]").html(i+1),a.find("[data-fancybox-prev]").prop("disabled",!o.opts.loop&&i<=0),a.find("[data-fancybox-next]").prop("disabled",!o.opts.loop&&i>=t.group.length-1),"image"===o.type?a.find("[data-fancybox-zoom]").show().end().find("[data-fancybox-download]").attr("href",o.opts.image.src||o.src).show():o.opts.toolbar&&a.find("[data-fancybox-download],[data-fancybox-zoom]").hide(),n(e.activeElement).is(":hidden,[disabled]")&&t.$refs.container.trigger("focus")},hideControls:function(t){var e=this,n=["infobar","toolbar","nav"];!t&&e.current.opts.preventCaptionOverlap||n.push("caption"),this.$refs.container.removeClass(n.map(function(t){return"fancybox-show-"+t}).join(" ")),this.hasHiddenControls=!0},showControls:function(){var t=this,e=t.current?t.current.opts:t.opts,n=t.$refs.container;t.hasHiddenControls=!1,t.idleSecondsCounter=0,n.toggleClass("fancybox-show-toolbar",!(!e.toolbar||!e.buttons)).toggleClass("fancybox-show-infobar",!!(e.infobar&&t.group.length>1)).toggleClass("fancybox-show-caption",!!t.$caption).toggleClass("fancybox-show-nav",!!(e.arrows&&t.group.length>1)).toggleClass("fancybox-is-modal",!!e.modal)},toggleControls:function(){this.hasHiddenControls?this.showControls():this.hideControls()}}),n.fancybox={version:"3.5.7",defaults:a,getInstance:function(t){var e=n('.fancybox-container:not(".fancybox-is-closing"):last').data("FancyBox"),o=Array.prototype.slice.call(arguments,1);return e instanceof b&&("string"===n.type(t)?e[t].apply(e,o):"function"===n.type(t)&&t.apply(e,o),e)},open:function(t,e,n){return new b(t,e,n)},close:function(t){var e=this.getInstance();e&&(e.close(),!0===t&&this.close(t))},destroy:function(){this.close(!0),r.add("body").off("click.fb-start","**")},isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),use3d:function(){var n=e.createElement("div");return t.getComputedStyle&&t.getComputedStyle(n)&&t.getComputedStyle(n).getPropertyValue("transform")&&!(e.documentMode&&e.documentMode<11)}(),getTranslate:function(t){var e;return!(!t||!t.length)&&(e=t[0].getBoundingClientRect(),{top:e.top||0,left:e.left||0,width:e.width,height:e.height,opacity:parseFloat(t.css("opacity"))})},setTranslate:function(t,e){var n="",o={};if(t&&e)return void 0===e.left&&void 0===e.top||(n=(void 0===e.left?t.position().left:e.left)+"px, "+(void 0===e.top?t.position().top:e.top)+"px",n=this.use3d?"translate3d("+n+", 0px)":"translate("+n+")"),void 0!==e.scaleX&&void 0!==e.scaleY?n+=" scale("+e.scaleX+", "+e.scaleY+")":void 0!==e.scaleX&&(n+=" scaleX("+e.scaleX+")"),n.length&&(o.transform=n),void 0!==e.opacity&&(o.opacity=e.opacity),void 0!==e.width&&(o.width=e.width),void 0!==e.height&&(o.height=e.height),t.css(o)},animate:function(t,e,o,i,a){var s,r=this;n.isFunction(o)&&(i=o,o=null),r.stop(t),s=r.getTranslate(t),t.on(f,function(c){(!c||!c.originalEvent||t.is(c.originalEvent.target)&&"z-index"!=c.originalEvent.propertyName)&&(r.stop(t),n.isNumeric(o)&&t.css("transition-duration",""),n.isPlainObject(e)?void 0!==e.scaleX&&void 0!==e.scaleY&&r.setTranslate(t,{top:e.top,left:e.left,width:s.width*e.scaleX,height:s.height*e.scaleY,scaleX:1,scaleY:1}):!0!==a&&t.removeClass(e),n.isFunction(i)&&i(c))}),n.isNumeric(o)&&t.css("transition-duration",o+"ms"),n.isPlainObject(e)?(void 0!==e.scaleX&&void 0!==e.scaleY&&(delete e.width,delete e.height,t.parent().hasClass("fancybox-slide--image")&&t.parent().addClass("fancybox-is-scaling")),n.fancybox.setTranslate(t,e)):t.addClass(e),t.data("timer",setTimeout(function(){t.trigger(f)},o+33))},stop:function(t,e){t&&t.length&&(clearTimeout(t.data("timer")),e&&t.trigger(f),t.off(f).css("transition-duration",""),t.parent().removeClass("fancybox-is-scaling"))}},n.fn.fancybox=function(t){var e;return t=t||{},e=t.selector||!1,e?n("body").off("click.fb-start",e).on("click.fb-start",e,{options:t},i):this.off("click.fb-start").on("click.fb-start",{items:this,options:t},i),this},r.on("click.fb-start","[data-fancybox]",i),r.on("click.fb-start","[data-fancybox-trigger]",function(t){n('[data-fancybox="'+n(this).attr("data-fancybox-trigger")+'"]').eq(n(this).attr("data-fancybox-index")||0).trigger("click.fb-start",{$trigger:n(this)})}),function(){var t=null;r.on("mousedown mouseup focus blur",".fancybox-button",function(e){switch(e.type){case"mousedown":t=n(this);break;case"mouseup":t=null;break;case"focusin":n(".fancybox-button").removeClass("fancybox-focus"),n(this).is(t)||n(this).is("[disabled]")||n(this).addClass("fancybox-focus");break;case"focusout":n(".fancybox-button").removeClass("fancybox-focus")}})}()}}(window,document,jQuery),function(t){"use strict";var e={youtube:{matcher:/(youtube\.com|youtu\.be|youtube\-nocookie\.com)\/(watch\?(.*&)?v=|v\/|u\/|embed\/?)?(videoseries\?list=(.*)|[\w-]{11}|\?listType=(.*)&list=(.*))(.*)/i,params:{autoplay:1,autohide:1,fs:1,rel:0,hd:1,wmode:"transparent",enablejsapi:1,html5:1},paramPlace:8,type:"iframe",url:"https://www.youtube-nocookie.com/embed/$4",thumb:"https://img.youtube.com/vi/$4/hqdefault.jpg"},vimeo:{matcher:/^.+vimeo.com\/(.*\/)?([\d]+)(.*)?/,params:{autoplay:1,hd:1,show_title:1,show_byline:1,show_portrait:0,fullscreen:1},paramPlace:3,type:"iframe",url:"//player.vimeo.com/video/$2"},instagram:{matcher:/(instagr\.am|instagram\.com)\/p\/([a-zA-Z0-9_\-]+)\/?/i,type:"image",url:"//$1/p/$2/media/?size=l"},gmap_place:{matcher:/(maps\.)?google\.([a-z]{2,3}(\.[a-z]{2})?)\/(((maps\/(place\/(.*)\/)?\@(.*),(\d+.?\d+?)z))|(\?ll=))(.*)?/i,type:"iframe",url:function(t){return"//maps.google."+t[2]+"/?ll="+(t[9]?t[9]+"&z="+Math.floor(t[10])+(t[12]?t[12].replace(/^\//,"&"):""):t[12]+"").replace(/\?/,"&")+"&output="+(t[12]&&t[12].indexOf("layer=c")>0?"svembed":"embed")}},gmap_search:{matcher:/(maps\.)?google\.([a-z]{2,3}(\.[a-z]{2})?)\/(maps\/search\/)(.*)/i,type:"iframe",url:function(t){return"//maps.google."+t[2]+"/maps?q="+t[5].replace("query=","q=").replace("api=1","")+"&output=embed"}}},n=function(e,n,o){if(e)return o=o||"","object"===t.type(o)&&(o=t.param(o,!0)),t.each(n,function(t,n){e=e.replace("$"+t,n||"")}),o.length&&(e+=(e.indexOf("?")>0?"&":"?")+o),e};t(document).on("objectNeedsType.fb",function(o,i,a){var s,r,c,l,d,u,f,p=a.src||"",h=!1;s=t.extend(!0,{},e,a.opts.media),t.each(s,function(e,o){if(c=p.match(o.matcher)){if(h=o.type,f=e,u={},o.paramPlace&&c[o.paramPlace]){d=c[o.paramPlace],"?"==d[0]&&(d=d.substring(1)),d=d.split("&");for(var i=0;i<d.length;++i){var s=d[i].split("=",2);2==s.length&&(u[s[0]]=decodeURIComponent(s[1].replace(/\+/g," ")))}}return l=t.extend(!0,{},o.params,a.opts[e],u),p="function"===t.type(o.url)?o.url.call(this,c,l,a):n(o.url,c,l),r="function"===t.type(o.thumb)?o.thumb.call(this,c,l,a):n(o.thumb,c),"youtube"===e?p=p.replace(/&t=((\d+)m)?(\d+)s/,function(t,e,n,o){return"&start="+((n?60*parseInt(n,10):0)+parseInt(o,10))}):"vimeo"===e&&(p=p.replace("&%23","#")),!1}}),h?(a.opts.thumb||a.opts.$thumb&&a.opts.$thumb.length||(a.opts.thumb=r),"iframe"===h&&(a.opts=t.extend(!0,a.opts,{iframe:{preload:!1,attr:{scrolling:"no"}}})),t.extend(a,{type:h,src:p,origSrc:a.src,contentSource:f,contentType:"image"===h?"image":"gmap_place"==f||"gmap_search"==f?"map":"video"})):p&&(a.type=a.opts.defaultType)});var o={youtube:{src:"https://www.youtube.com/iframe_api",class:"YT",loading:!1,loaded:!1},vimeo:{src:"https://player.vimeo.com/api/player.js",class:"Vimeo",loading:!1,loaded:!1},load:function(t){var e,n=this;if(this[t].loaded)return void setTimeout(function(){n.done(t)});this[t].loading||(this[t].loading=!0,e=document.createElement("script"),e.type="text/javascript",e.src=this[t].src,"youtube"===t?window.onYouTubeIframeAPIReady=function(){n[t].loaded=!0,n.done(t)}:e.onload=function(){n[t].loaded=!0,n.done(t)},document.body.appendChild(e))},done:function(e){var n,o,i;"youtube"===e&&delete window.onYouTubeIframeAPIReady,(n=t.fancybox.getInstance())&&(o=n.current.$content.find("iframe"),"youtube"===e&&void 0!==YT&&YT?i=new YT.Player(o.attr("id"),{events:{onStateChange:function(t){0==t.data&&n.next()}}}):"vimeo"===e&&void 0!==Vimeo&&Vimeo&&(i=new Vimeo.Player(o),i.on("ended",function(){n.next()})))}};t(document).on({"afterShow.fb":function(t,e,n){e.group.length>1&&("youtube"===n.contentSource||"vimeo"===n.contentSource)&&o.load(n.contentSource)}})}(jQuery),function(t,e,n){"use strict";var o=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||function(e){return t.setTimeout(e,1e3/60)}}(),i=function(){return t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.mozCancelAnimationFrame||t.oCancelAnimationFrame||function(e){t.clearTimeout(e)}}(),a=function(e){var n=[];e=e.originalEvent||e||t.e,e=e.touches&&e.touches.length?e.touches:e.changedTouches&&e.changedTouches.length?e.changedTouches:[e];for(var o in e)e[o].pageX?n.push({x:e[o].pageX,y:e[o].pageY}):e[o].clientX&&n.push({x:e[o].clientX,y:e[o].clientY});return n},s=function(t,e,n){return e&&t?"x"===n?t.x-e.x:"y"===n?t.y-e.y:Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)):0},r=function(t){if(t.is('a,area,button,[role="button"],input,label,select,summary,textarea,video,audio,iframe')||n.isFunction(t.get(0).onclick)||t.data("selectable"))return!0;for(var e=0,o=t[0].attributes,i=o.length;e<i;e++)if("data-fancybox-"===o[e].nodeName.substr(0,14))return!0;return!1},c=function(e){var n=t.getComputedStyle(e)["overflow-y"],o=t.getComputedStyle(e)["overflow-x"],i=("scroll"===n||"auto"===n)&&e.scrollHeight>e.clientHeight,a=("scroll"===o||"auto"===o)&&e.scrollWidth>e.clientWidth;return i||a},l=function(t){for(var e=!1;;){if(e=c(t.get(0)))break;if(t=t.parent(),!t.length||t.hasClass("fancybox-stage")||t.is("body"))break}return e},d=function(t){var e=this;e.instance=t,e.$bg=t.$refs.bg,e.$stage=t.$refs.stage,e.$container=t.$refs.container,e.destroy(),e.$container.on("touchstart.fb.touch mousedown.fb.touch",n.proxy(e,"ontouchstart"))};d.prototype.destroy=function(){var t=this;t.$container.off(".fb.touch"),n(e).off(".fb.touch"),t.requestId&&(i(t.requestId),t.requestId=null),t.tapped&&(clearTimeout(t.tapped),t.tapped=null)},d.prototype.ontouchstart=function(o){var i=this,c=n(o.target),d=i.instance,u=d.current,f=u.$slide,p=u.$content,h="touchstart"==o.type;if(h&&i.$container.off("mousedown.fb.touch"),(!o.originalEvent||2!=o.originalEvent.button)&&f.length&&c.length&&!r(c)&&!r(c.parent())&&(c.is("img")||!(o.originalEvent.clientX>c[0].clientWidth+c.offset().left))){if(!u||d.isAnimating||u.$slide.hasClass("fancybox-animated"))return o.stopPropagation(),void o.preventDefault();i.realPoints=i.startPoints=a(o),i.startPoints.length&&(u.touch&&o.stopPropagation(),i.startEvent=o,i.canTap=!0,i.$target=c,i.$content=p,i.opts=u.opts.touch,i.isPanning=!1,i.isSwiping=!1,i.isZooming=!1,i.isScrolling=!1,i.canPan=d.canPan(),i.startTime=(new Date).getTime(),i.distanceX=i.distanceY=i.distance=0,i.canvasWidth=Math.round(f[0].clientWidth),i.canvasHeight=Math.round(f[0].clientHeight),i.contentLastPos=null,i.contentStartPos=n.fancybox.getTranslate(i.$content)||{top:0,left:0},i.sliderStartPos=n.fancybox.getTranslate(f),i.stagePos=n.fancybox.getTranslate(d.$refs.stage),i.sliderStartPos.top-=i.stagePos.top,i.sliderStartPos.left-=i.stagePos.left,i.contentStartPos.top-=i.stagePos.top,i.contentStartPos.left-=i.stagePos.left,n(e).off(".fb.touch").on(h?"touchend.fb.touch touchcancel.fb.touch":"mouseup.fb.touch mouseleave.fb.touch",n.proxy(i,"ontouchend")).on(h?"touchmove.fb.touch":"mousemove.fb.touch",n.proxy(i,"ontouchmove")),n.fancybox.isMobile&&e.addEventListener("scroll",i.onscroll,!0),((i.opts||i.canPan)&&(c.is(i.$stage)||i.$stage.find(c).length)||(c.is(".fancybox-image")&&o.preventDefault(),n.fancybox.isMobile&&c.parents(".fancybox-caption").length))&&(i.isScrollable=l(c)||l(c.parent()),n.fancybox.isMobile&&i.isScrollable||o.preventDefault(),(1===i.startPoints.length||u.hasError)&&(i.canPan?(n.fancybox.stop(i.$content),i.isPanning=!0):i.isSwiping=!0,i.$container.addClass("fancybox-is-grabbing")),2===i.startPoints.length&&"image"===u.type&&(u.isLoaded||u.$ghost)&&(i.canTap=!1,i.isSwiping=!1,i.isPanning=!1,i.isZooming=!0,n.fancybox.stop(i.$content),i.centerPointStartX=.5*(i.startPoints[0].x+i.startPoints[1].x)-n(t).scrollLeft(),i.centerPointStartY=.5*(i.startPoints[0].y+i.startPoints[1].y)-n(t).scrollTop(),i.percentageOfImageAtPinchPointX=(i.centerPointStartX-i.contentStartPos.left)/i.contentStartPos.width,i.percentageOfImageAtPinchPointY=(i.centerPointStartY-i.contentStartPos.top)/i.contentStartPos.height,i.startDistanceBetweenFingers=s(i.startPoints[0],i.startPoints[1]))))}},d.prototype.onscroll=function(t){var n=this;n.isScrolling=!0,e.removeEventListener("scroll",n.onscroll,!0)},d.prototype.ontouchmove=function(t){var e=this;return void 0!==t.originalEvent.buttons&&0===t.originalEvent.buttons?void e.ontouchend(t):e.isScrolling?void(e.canTap=!1):(e.newPoints=a(t),void((e.opts||e.canPan)&&e.newPoints.length&&e.newPoints.length&&(e.isSwiping&&!0===e.isSwiping||t.preventDefault(),e.distanceX=s(e.newPoints[0],e.startPoints[0],"x"),e.distanceY=s(e.newPoints[0],e.startPoints[0],"y"),e.distance=s(e.newPoints[0],e.startPoints[0]),e.distance>0&&(e.isSwiping?e.onSwipe(t):e.isPanning?e.onPan():e.isZooming&&e.onZoom()))))},d.prototype.onSwipe=function(e){var a,s=this,r=s.instance,c=s.isSwiping,l=s.sliderStartPos.left||0;if(!0!==c)"x"==c&&(s.distanceX>0&&(s.instance.group.length<2||0===s.instance.current.index&&!s.instance.current.opts.loop)?l+=Math.pow(s.distanceX,.8):s.distanceX<0&&(s.instance.group.length<2||s.instance.current.index===s.instance.group.length-1&&!s.instance.current.opts.loop)?l-=Math.pow(-s.distanceX,.8):l+=s.distanceX),s.sliderLastPos={top:"x"==c?0:s.sliderStartPos.top+s.distanceY,left:l},s.requestId&&(i(s.requestId),s.requestId=null),s.requestId=o(function(){s.sliderLastPos&&(n.each(s.instance.slides,function(t,e){var o=e.pos-s.instance.currPos;n.fancybox.setTranslate(e.$slide,{top:s.sliderLastPos.top,left:s.sliderLastPos.left+o*s.canvasWidth+o*e.opts.gutter})}),s.$container.addClass("fancybox-is-sliding"))});else if(Math.abs(s.distance)>10){if(s.canTap=!1,r.group.length<2&&s.opts.vertical?s.isSwiping="y":r.isDragging||!1===s.opts.vertical||"auto"===s.opts.vertical&&n(t).width()>800?s.isSwiping="x":(a=Math.abs(180*Math.atan2(s.distanceY,s.distanceX)/Math.PI),s.isSwiping=a>45&&a<135?"y":"x"),"y"===s.isSwiping&&n.fancybox.isMobile&&s.isScrollable)return void(s.isScrolling=!0);r.isDragging=s.isSwiping,s.startPoints=s.newPoints,n.each(r.slides,function(t,e){var o,i;n.fancybox.stop(e.$slide),o=n.fancybox.getTranslate(e.$slide),i=n.fancybox.getTranslate(r.$refs.stage),e.$slide.css({transform:"",opacity:"","transition-duration":""}).removeClass("fancybox-animated").removeClass(function(t,e){return(e.match(/(^|\s)fancybox-fx-\S+/g)||[]).join(" ")}),e.pos===r.current.pos&&(s.sliderStartPos.top=o.top-i.top,s.sliderStartPos.left=o.left-i.left),n.fancybox.setTranslate(e.$slide,{top:o.top-i.top,left:o.left-i.left})}),r.SlideShow&&r.SlideShow.isActive&&r.SlideShow.stop()}},d.prototype.onPan=function(){var t=this;if(s(t.newPoints[0],t.realPoints[0])<(n.fancybox.isMobile?10:5))return void(t.startPoints=t.newPoints);t.canTap=!1,t.contentLastPos=t.limitMovement(),t.requestId&&i(t.requestId),t.requestId=o(function(){n.fancybox.setTranslate(t.$content,t.contentLastPos)})},d.prototype.limitMovement=function(){var t,e,n,o,i,a,s=this,r=s.canvasWidth,c=s.canvasHeight,l=s.distanceX,d=s.distanceY,u=s.contentStartPos,f=u.left,p=u.top,h=u.width,g=u.height;return i=h>r?f+l:f,a=p+d,t=Math.max(0,.5*r-.5*h),e=Math.max(0,.5*c-.5*g),n=Math.min(r-h,.5*r-.5*h),o=Math.min(c-g,.5*c-.5*g),l>0&&i>t&&(i=t-1+Math.pow(-t+f+l,.8)||0),l<0&&i<n&&(i=n+1-Math.pow(n-f-l,.8)||0),d>0&&a>e&&(a=e-1+Math.pow(-e+p+d,.8)||0),d<0&&a<o&&(a=o+1-Math.pow(o-p-d,.8)||0),{top:a,left:i}},d.prototype.limitPosition=function(t,e,n,o){var i=this,a=i.canvasWidth,s=i.canvasHeight;return n>a?(t=t>0?0:t,t=t<a-n?a-n:t):t=Math.max(0,a/2-n/2),o>s?(e=e>0?0:e,e=e<s-o?s-o:e):e=Math.max(0,s/2-o/2),{top:e,left:t}},d.prototype.onZoom=function(){var e=this,a=e.contentStartPos,r=a.width,c=a.height,l=a.left,d=a.top,u=s(e.newPoints[0],e.newPoints[1]),f=u/e.startDistanceBetweenFingers,p=Math.floor(r*f),h=Math.floor(c*f),g=(r-p)*e.percentageOfImageAtPinchPointX,b=(c-h)*e.percentageOfImageAtPinchPointY,m=(e.newPoints[0].x+e.newPoints[1].x)/2-n(t).scrollLeft(),v=(e.newPoints[0].y+e.newPoints[1].y)/2-n(t).scrollTop(),y=m-e.centerPointStartX,x=v-e.centerPointStartY,w=l+(g+y),$=d+(b+x),S={top:$,left:w,scaleX:f,scaleY:f};e.canTap=!1,e.newWidth=p,e.newHeight=h,e.contentLastPos=S,e.requestId&&i(e.requestId),e.requestId=o(function(){n.fancybox.setTranslate(e.$content,e.contentLastPos)})},d.prototype.ontouchend=function(t){var o=this,s=o.isSwiping,r=o.isPanning,c=o.isZooming,l=o.isScrolling;if(o.endPoints=a(t),o.dMs=Math.max((new Date).getTime()-o.startTime,1),o.$container.removeClass("fancybox-is-grabbing"),n(e).off(".fb.touch"),e.removeEventListener("scroll",o.onscroll,!0),o.requestId&&(i(o.requestId),o.requestId=null),o.isSwiping=!1,o.isPanning=!1,o.isZooming=!1,o.isScrolling=!1,o.instance.isDragging=!1,o.canTap)return o.onTap(t);o.speed=100,o.velocityX=o.distanceX/o.dMs*.5,o.velocityY=o.distanceY/o.dMs*.5,r?o.endPanning():c?o.endZooming():o.endSwiping(s,l)},d.prototype.endSwiping=function(t,e){var o=this,i=!1,a=o.instance.group.length,s=Math.abs(o.distanceX),r="x"==t&&a>1&&(o.dMs>130&&s>10||s>50);o.sliderLastPos=null,"y"==t&&!e&&Math.abs(o.distanceY)>50?(n.fancybox.animate(o.instance.current.$slide,{top:o.sliderStartPos.top+o.distanceY+150*o.velocityY,opacity:0},200),i=o.instance.close(!0,250)):r&&o.distanceX>0?i=o.instance.previous(300):r&&o.distanceX<0&&(i=o.instance.next(300)),!1!==i||"x"!=t&&"y"!=t||o.instance.centerSlide(200),o.$container.removeClass("fancybox-is-sliding")},d.prototype.endPanning=function(){var t,e,o,i=this;i.contentLastPos&&(!1===i.opts.momentum||i.dMs>350?(t=i.contentLastPos.left,e=i.contentLastPos.top):(t=i.contentLastPos.left+500*i.velocityX,e=i.contentLastPos.top+500*i.velocityY),o=i.limitPosition(t,e,i.contentStartPos.width,i.contentStartPos.height),o.width=i.contentStartPos.width,o.height=i.contentStartPos.height,n.fancybox.animate(i.$content,o,366))},d.prototype.endZooming=function(){var t,e,o,i,a=this,s=a.instance.current,r=a.newWidth,c=a.newHeight;a.contentLastPos&&(t=a.contentLastPos.left,e=a.contentLastPos.top,i={top:e,left:t,width:r,height:c,scaleX:1,scaleY:1},n.fancybox.setTranslate(a.$content,i),r<a.canvasWidth&&c<a.canvasHeight?a.instance.scaleToFit(150):r>s.width||c>s.height?a.instance.scaleToActual(a.centerPointStartX,a.centerPointStartY,150):(o=a.limitPosition(t,e,r,c),n.fancybox.animate(a.$content,o,150)))},d.prototype.onTap=function(e){var o,i=this,s=n(e.target),r=i.instance,c=r.current,l=e&&a(e)||i.startPoints,d=l[0]?l[0].x-n(t).scrollLeft()-i.stagePos.left:0,u=l[0]?l[0].y-n(t).scrollTop()-i.stagePos.top:0,f=function(t){var o=c.opts[t];if(n.isFunction(o)&&(o=o.apply(r,[c,e])),o)switch(o){case"close":r.close(i.startEvent);break;case"toggleControls":r.toggleControls();break;case"next":r.next();break;case"nextOrClose":r.group.length>1?r.next():r.close(i.startEvent);break;case"zoom":"image"==c.type&&(c.isLoaded||c.$ghost)&&(r.canPan()?r.scaleToFit():r.isScaledDown()?r.scaleToActual(d,u):r.group.length<2&&r.close(i.startEvent))}};if((!e.originalEvent||2!=e.originalEvent.button)&&(s.is("img")||!(d>s[0].clientWidth+s.offset().left))){if(s.is(".fancybox-bg,.fancybox-inner,.fancybox-outer,.fancybox-container"))o="Outside";else if(s.is(".fancybox-slide"))o="Slide";else{if(!r.current.$content||!r.current.$content.find(s).addBack().filter(s).length)return;o="Content"}if(i.tapped){if(clearTimeout(i.tapped),i.tapped=null,Math.abs(d-i.tapX)>50||Math.abs(u-i.tapY)>50)return this;f("dblclick"+o)}else i.tapX=d,i.tapY=u,c.opts["dblclick"+o]&&c.opts["dblclick"+o]!==c.opts["click"+o]?i.tapped=setTimeout(function(){i.tapped=null,r.isAnimating||f("click"+o)},500):f("click"+o);return this}},n(e).on("onActivate.fb",function(t,e){e&&!e.Guestures&&(e.Guestures=new d(e))}).on("beforeClose.fb",function(t,e){e&&e.Guestures&&e.Guestures.destroy()})}(window,document,jQuery),function(t,e){"use strict";e.extend(!0,e.fancybox.defaults,{btnTpl:{slideShow:'<button data-fancybox-play class="fancybox-button fancybox-button--play" title="{{PLAY_START}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 5.4v13.2l11-6.6z"/></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.33 5.75h2.2v12.5h-2.2V5.75zm5.15 0h2.2v12.5h-2.2V5.75z"/></svg></button>'},slideShow:{autoStart:!1,speed:3e3,progress:!0}});var n=function(t){this.instance=t,this.init()};e.extend(n.prototype,{timer:null,isActive:!1,$button:null,init:function(){var t=this,n=t.instance,o=n.group[n.currIndex].opts.slideShow;t.$button=n.$refs.toolbar.find("[data-fancybox-play]").on("click",function(){t.toggle()}),n.group.length<2||!o?t.$button.hide():o.progress&&(t.$progress=e('<div class="fancybox-progress"></div>').appendTo(n.$refs.inner))},set:function(t){var n=this,o=n.instance,i=o.current;i&&(!0===t||i.opts.loop||o.currIndex<o.group.length-1)?n.isActive&&"video"!==i.contentType&&(n.$progress&&e.fancybox.animate(n.$progress.show(),{scaleX:1},i.opts.slideShow.speed),n.timer=setTimeout(function(){o.current.opts.loop||o.current.index!=o.group.length-1?o.next():o.jumpTo(0)},i.opts.slideShow.speed)):(n.stop(),o.idleSecondsCounter=0,o.showControls())},clear:function(){var t=this;clearTimeout(t.timer),t.timer=null,t.$progress&&t.$progress.removeAttr("style").hide()},start:function(){var t=this,e=t.instance.current;e&&(t.$button.attr("title",(e.opts.i18n[e.opts.lang]||e.opts.i18n.en).PLAY_STOP).removeClass("fancybox-button--play").addClass("fancybox-button--pause"),t.isActive=!0,e.isComplete&&t.set(!0),t.instance.trigger("onSlideShowChange",!0))},stop:function(){var t=this,e=t.instance.current;t.clear(),t.$button.attr("title",(e.opts.i18n[e.opts.lang]||e.opts.i18n.en).PLAY_START).removeClass("fancybox-button--pause").addClass("fancybox-button--play"),t.isActive=!1,t.instance.trigger("onSlideShowChange",!1),t.$progress&&t.$progress.removeAttr("style").hide()},toggle:function(){var t=this;t.isActive?t.stop():t.start()}}),e(t).on({"onInit.fb":function(t,e){e&&!e.SlideShow&&(e.SlideShow=new n(e))},"beforeShow.fb":function(t,e,n,o){var i=e&&e.SlideShow;o?i&&n.opts.slideShow.autoStart&&i.start():i&&i.isActive&&i.clear()},"afterShow.fb":function(t,e,n){var o=e&&e.SlideShow;o&&o.isActive&&o.set()},"afterKeydown.fb":function(n,o,i,a,s){var r=o&&o.SlideShow;!r||!i.opts.slideShow||80!==s&&32!==s||e(t.activeElement).is("button,a,input")||(a.preventDefault(),r.toggle())},"beforeClose.fb onDeactivate.fb":function(t,e){var n=e&&e.SlideShow;n&&n.stop()}}),e(t).on("visibilitychange",function(){var n=e.fancybox.getInstance(),o=n&&n.SlideShow;o&&o.isActive&&(t.hidden?o.clear():o.set())})}(document,jQuery),function(t,e){"use strict";var n=function(){for(var e=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],n={},o=0;o<e.length;o++){var i=e[o];if(i&&i[1]in t){for(var a=0;a<i.length;a++)n[e[0][a]]=i[a];return n}}return!1}();if(n){var o={request:function(e){e=e||t.documentElement,e[n.requestFullscreen](e.ALLOW_KEYBOARD_INPUT)},exit:function(){t[n.exitFullscreen]()},toggle:function(e){e=e||t.documentElement,this.isFullscreen()?this.exit():this.request(e)},isFullscreen:function(){return Boolean(t[n.fullscreenElement])},enabled:function(){return Boolean(t[n.fullscreenEnabled])}};e.extend(!0,e.fancybox.defaults,{btnTpl:{fullScreen:'<button data-fancybox-fullscreen class="fancybox-button fancybox-button--fsenter" title="{{FULL_SCREEN}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 16h3v3h2v-5H5zm3-8H5v2h5V5H8zm6 11h2v-3h3v-2h-5zm2-11V5h-2v5h5V8z"/></svg></button>'},fullScreen:{autoStart:!1}}),e(t).on(n.fullscreenchange,function(){var t=o.isFullscreen(),n=e.fancybox.getInstance();n&&(n.current&&"image"===n.current.type&&n.isAnimating&&(n.isAnimating=!1,n.update(!0,!0,0),n.isComplete||n.complete()),n.trigger("onFullscreenChange",t),n.$refs.container.toggleClass("fancybox-is-fullscreen",t),n.$refs.toolbar.find("[data-fancybox-fullscreen]").toggleClass("fancybox-button--fsenter",!t).toggleClass("fancybox-button--fsexit",t))})}e(t).on({"onInit.fb":function(t,e){var i;if(!n)return void e.$refs.toolbar.find("[data-fancybox-fullscreen]").remove();e&&e.group[e.currIndex].opts.fullScreen?(i=e.$refs.container,i.on("click.fb-fullscreen","[data-fancybox-fullscreen]",function(t){t.stopPropagation(),t.preventDefault(),o.toggle()}),e.opts.fullScreen&&!0===e.opts.fullScreen.autoStart&&o.request(),e.FullScreen=o):e&&e.$refs.toolbar.find("[data-fancybox-fullscreen]").hide()},"afterKeydown.fb":function(t,e,n,o,i){e&&e.FullScreen&&70===i&&(o.preventDefault(),e.FullScreen.toggle())},"beforeClose.fb":function(t,e){e&&e.FullScreen&&e.$refs.container.hasClass("fancybox-is-fullscreen")&&o.exit()}})}(document,jQuery),function(t,e){"use strict";var n="fancybox-thumbs";e.fancybox.defaults=e.extend(!0,{btnTpl:{thumbs:'<button data-fancybox-thumbs class="fancybox-button fancybox-button--thumbs" title="{{THUMBS}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.59 14.59h3.76v3.76h-3.76v-3.76zm-4.47 0h3.76v3.76h-3.76v-3.76zm-4.47 0h3.76v3.76H5.65v-3.76zm8.94-4.47h3.76v3.76h-3.76v-3.76zm-4.47 0h3.76v3.76h-3.76v-3.76zm-4.47 0h3.76v3.76H5.65v-3.76zm8.94-4.47h3.76v3.76h-3.76V5.65zm-4.47 0h3.76v3.76h-3.76V5.65zm-4.47 0h3.76v3.76H5.65V5.65z"/></svg></button>'},thumbs:{autoStart:!1,hideOnClose:!0,parentEl:".fancybox-container",axis:"y"}},e.fancybox.defaults);var o=function(t){this.init(t)};e.extend(o.prototype,{$button:null,$grid:null,$list:null,isVisible:!1,isActive:!1,init:function(t){var e=this,n=t.group,o=0;e.instance=t,e.opts=n[t.currIndex].opts.thumbs,t.Thumbs=e,e.$button=t.$refs.toolbar.find("[data-fancybox-thumbs]");for(var i=0,a=n.length;i<a&&(n[i].thumb&&o++,!(o>1));i++);o>1&&e.opts?(e.$button.removeAttr("style").on("click",function(){e.toggle()}),e.isActive=!0):e.$button.hide()},create:function(){var t,o=this,i=o.instance,a=o.opts.parentEl,s=[];o.$grid||(o.$grid=e('<div class="'+n+" "+n+"-"+o.opts.axis+'"></div>').appendTo(i.$refs.container.find(a).addBack().filter(a)),o.$grid.on("click","a",function(){i.jumpTo(e(this).attr("data-index"))})),o.$list||(o.$list=e('<div class="'+n+'__list">').appendTo(o.$grid)),e.each(i.group,function(e,n){t=n.thumb,t||"image"!==n.type||(t=n.src),s.push('<a href="javascript:;" tabindex="0" data-index="'+e+'"'+(t&&t.length?' style="background-image:url('+t+')"':'class="fancybox-thumbs-missing"')+"></a>")}),o.$list[0].innerHTML=s.join(""),"x"===o.opts.axis&&o.$list.width(parseInt(o.$grid.css("padding-right"),10)+i.group.length*o.$list.children().eq(0).outerWidth(!0))},focus:function(t){var e,n,o=this,i=o.$list,a=o.$grid;o.instance.current&&(e=i.children().removeClass("fancybox-thumbs-active").filter('[data-index="'+o.instance.current.index+'"]').addClass("fancybox-thumbs-active"),n=e.position(),"y"===o.opts.axis&&(n.top<0||n.top>i.height()-e.outerHeight())?i.stop().animate({scrollTop:i.scrollTop()+n.top},t):"x"===o.opts.axis&&(n.left<a.scrollLeft()||n.left>a.scrollLeft()+(a.width()-e.outerWidth()))&&i.parent().stop().animate({scrollLeft:n.left},t))},update:function(){var t=this;t.instance.$refs.container.toggleClass("fancybox-show-thumbs",this.isVisible),t.isVisible?(t.$grid||t.create(),t.instance.trigger("onThumbsShow"),t.focus(0)):t.$grid&&t.instance.trigger("onThumbsHide"),t.instance.update()},hide:function(){this.isVisible=!1,this.update()},show:function(){this.isVisible=!0,this.update()},toggle:function(){this.isVisible=!this.isVisible,this.update()}}),e(t).on({"onInit.fb":function(t,e){var n;e&&!e.Thumbs&&(n=new o(e),n.isActive&&!0===n.opts.autoStart&&n.show())},"beforeShow.fb":function(t,e,n,o){var i=e&&e.Thumbs;i&&i.isVisible&&i.focus(o?0:250)},"afterKeydown.fb":function(t,e,n,o,i){var a=e&&e.Thumbs;a&&a.isActive&&71===i&&(o.preventDefault(),a.toggle())},"beforeClose.fb":function(t,e){var n=e&&e.Thumbs;n&&n.isVisible&&!1!==n.opts.hideOnClose&&n.$grid.hide()}})}(document,jQuery),function(t,e){"use strict";function n(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(t).replace(/[&<>"'`=\/]/g,function(t){return e[t]})}e.extend(!0,e.fancybox.defaults,{btnTpl:{share:'<button data-fancybox-share class="fancybox-button fancybox-button--share" title="{{SHARE}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2.55 19c1.4-8.4 9.1-9.8 11.9-9.8V5l7 7-7 6.3v-3.5c-2.8 0-10.5 2.1-11.9 4.2z"/></svg></button>'},share:{url:function(t,e){return!t.currentHash&&"inline"!==e.type&&"html"!==e.type&&(e.origSrc||e.src)||window.location},
tpl:'<div class="fancybox-share"><h1>{{SHARE}}</h1><p><a class="fancybox-share__button fancybox-share__button--fb" href="https://www.facebook.com/sharer/sharer.php?u={{url}}"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="m287 456v-299c0-21 6-35 35-35h38v-63c-7-1-29-3-55-3-54 0-91 33-91 94v306m143-254h-205v72h196" /></svg><span>Facebook</span></a><a class="fancybox-share__button fancybox-share__button--tw" href="https://twitter.com/intent/tweet?url={{url}}&text={{descr}}"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="m456 133c-14 7-31 11-47 13 17-10 30-27 37-46-15 10-34 16-52 20-61-62-157-7-141 75-68-3-129-35-169-85-22 37-11 86 26 109-13 0-26-4-37-9 0 39 28 72 65 80-12 3-25 4-37 2 10 33 41 57 77 57-42 30-77 38-122 34 170 111 378-32 359-208 16-11 30-25 41-42z" /></svg><span>Twitter</span></a><a class="fancybox-share__button fancybox-share__button--pt" href="https://www.pinterest.com/pin/create/button/?url={{url}}&description={{descr}}&media={{media}}"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="m265 56c-109 0-164 78-164 144 0 39 15 74 47 87 5 2 10 0 12-5l4-19c2-6 1-8-3-13-9-11-15-25-15-45 0-58 43-110 113-110 62 0 96 38 96 88 0 67-30 122-73 122-24 0-42-19-36-44 6-29 20-60 20-81 0-19-10-35-31-35-25 0-44 26-44 60 0 21 7 36 7 36l-30 125c-8 37-1 83 0 87 0 3 4 4 5 2 2-3 32-39 42-75l16-64c8 16 31 29 56 29 74 0 124-67 124-157 0-69-58-132-146-132z" fill="#fff"/></svg><span>Pinterest</span></a></p><p><input class="fancybox-share__input" type="text" value="{{url_raw}}" onclick="select()" /></p></div>'}}),e(t).on("click","[data-fancybox-share]",function(){var t,o,i=e.fancybox.getInstance(),a=i.current||null;a&&("function"===e.type(a.opts.share.url)&&(t=a.opts.share.url.apply(a,[i,a])),o=a.opts.share.tpl.replace(/\{\{media\}\}/g,"image"===a.type?encodeURIComponent(a.src):"").replace(/\{\{url\}\}/g,encodeURIComponent(t)).replace(/\{\{url_raw\}\}/g,n(t)).replace(/\{\{descr\}\}/g,i.$caption?encodeURIComponent(i.$caption.text()):""),e.fancybox.open({src:i.translate(i,o),type:"html",opts:{touch:!1,animationEffect:!1,afterLoad:function(t,e){i.$refs.container.one("beforeClose.fb",function(){t.close(null,0)}),e.$content.find(".fancybox-share__button").click(function(){return window.open(this.href,"Share","width=550, height=450"),!1})},mobile:{autoFocus:!1}}}))})}(document,jQuery),function(t,e,n){"use strict";function o(){var e=t.location.hash.substr(1),n=e.split("-"),o=n.length>1&&/^\+?\d+$/.test(n[n.length-1])?parseInt(n.pop(-1),10)||1:1,i=n.join("-");return{hash:e,index:o<1?1:o,gallery:i}}function i(t){""!==t.gallery&&n("[data-fancybox='"+n.escapeSelector(t.gallery)+"']").eq(t.index-1).focus().trigger("click.fb-start")}function a(t){var e,n;return!!t&&(e=t.current?t.current.opts:t.opts,""!==(n=e.hash||(e.$orig?e.$orig.data("fancybox")||e.$orig.data("fancybox-trigger"):""))&&n)}n.escapeSelector||(n.escapeSelector=function(t){return(t+"").replace(/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g,function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t})}),n(function(){!1!==n.fancybox.defaults.hash&&(n(e).on({"onInit.fb":function(t,e){var n,i;!1!==e.group[e.currIndex].opts.hash&&(n=o(),(i=a(e))&&n.gallery&&i==n.gallery&&(e.currIndex=n.index-1))},"beforeShow.fb":function(n,o,i,s){var r;i&&!1!==i.opts.hash&&(r=a(o))&&(o.currentHash=r+(o.group.length>1?"-"+(i.index+1):""),t.location.hash!=="#"+o.currentHash&&(s&&!o.origHash&&(o.origHash=t.location.hash),o.hashTimer&&clearTimeout(o.hashTimer),o.hashTimer=setTimeout(function(){"replaceState"in t.history?(t.history[s?"pushState":"replaceState"]({},e.title,t.location.pathname+t.location.search+"#"+o.currentHash),s&&(o.hasCreatedHistory=!0)):t.location.hash=o.currentHash,o.hashTimer=null},300)))},"beforeClose.fb":function(n,o,i){i&&!1!==i.opts.hash&&(clearTimeout(o.hashTimer),o.currentHash&&o.hasCreatedHistory?t.history.back():o.currentHash&&("replaceState"in t.history?t.history.replaceState({},e.title,t.location.pathname+t.location.search+(o.origHash||"")):t.location.hash=o.origHash),o.currentHash=null)}}),n(t).on("hashchange.fb",function(){var t=o(),e=null;n.each(n(".fancybox-container").get().reverse(),function(t,o){var i=n(o).data("FancyBox");if(i&&i.currentHash)return e=i,!1}),e?e.currentHash===t.gallery+"-"+t.index||1===t.index&&e.currentHash==t.gallery||(e.currentHash=null,e.close()):""!==t.gallery&&i(t)}),setTimeout(function(){n.fancybox.getInstance()||i(o())},50))})}(window,document,jQuery),function(t,e){"use strict";var n=(new Date).getTime();e(t).on({"onInit.fb":function(t,e,o){e.$refs.stage.on("mousewheel DOMMouseScroll wheel MozMousePixelScroll",function(t){var o=e.current,i=(new Date).getTime();e.group.length<2||!1===o.opts.wheel||"auto"===o.opts.wheel&&"image"!==o.type||(t.preventDefault(),t.stopPropagation(),o.$slide.hasClass("fancybox-animated")||(t=t.originalEvent||t,i-n<250||(n=i,e[(-t.deltaY||-t.deltaX||t.wheelDelta||-t.detail)<0?"next":"previous"]())))})}})}(document,jQuery);;
'use strict';

/**
 * SSO User Model.
 *
 * @param {number} id
 * @param {string} displayName
 * @param {string} email
 * @param {string} hash
 * @constructor
 */
function UpxUser(id, displayName, email, hash) {
    this.id = id;
    this.displayName = displayName;
    this.email = email;
    this.hash = hash;
}

/**
 * @returns {number}
 */
UpxUser.prototype.getId = function () {
    return this.id;
};

/**
 * @returns {string}
 */
UpxUser.prototype.getDisplayName = function () {
    return this.displayName;
};

/**
 * @returns {string}
 */
UpxUser.prototype.getEmail = function () {
    return this.email;
};

/**
 * @returns {string}
 */
UpxUser.prototype.getHash = function () {
    return this.hash;
};

/**
 * @returns {object}
 */
UpxUser.prototype.toHashMap = function () {
    return {
        id: this.id,
        displayName: this.displayName,
        email: this.email,
        hash: this.hash
    };
};
;
'use strict';

/**
 * Init SSO.
 *
 * @param {jQuery} $
 * @param {object} settings
 */
(function ($, settings) {

    // Create global service.
    UPX.sso = new UpxSSO(settings);

    // Notify listeners.
    UPX.trigger('ssoReady');

    ////////////////////
    // IMPLEMENTATION //
    ////////////////////

    // Extend from backbone events.
    _.extend(UpxSSO.prototype, Backbone.Events);
    UpxSSO.constructor = UpxSSO;

    /**
     * SSO Service.
     *
     * @constructor
     */
    function UpxSSO(settings) {

        this.settings = settings;
        var p = settings.cookiePrefix;

        // Get data from cookies.
        var id = upxGetCookie(p + 'id');
        var email = upxGetCookie(p + 'email');
        var displayName = upxGetCookie(p + 'displayname');
        var hash = upxGetCookie(p + 'hash');

        // Create user object if applicable.
        if (id && email && displayName && hash) {
            this.user = new UpxUser(id, displayName, email, hash);
        } else {
            this.user = null;
        }

        // Listen to the messages from profile.uproxx.com
        var me = this;
        window.addEventListener('message', function (event) {
            me.receiveMessage(event);
        }, false);
    }

    /**
     * Settings getter.
     *
     * @returns {object}
     */
    UpxSSO.prototype.getSettings = function () {
        return this.settings;
    };

    /**
     * User getter.
     *
     * @returns {UpxUser|null}
     */
    UpxSSO.prototype.getUser = function () {
        return this.user;
    };

    /**
     * Receive and process window messages.
     *
     * @param event
     */
    UpxSSO.prototype.receiveMessage = function (event) {

        // Verify event.
        if (!event || event.origin !== this.getSettings().origin || !event.data) {
            return;
        }

        // Set logged in user data.
        var data = JSON.parse(event.data);
        if (data.profile_action === 'login' && data.cookies) {
            var p = settings.cookiePrefix;
            this.user = new UpxUser(
                data.cookies[p + 'id'],
                data.cookies[p + 'displayname'],
                data.cookies[p + 'email'],
                data.cookies[p + 'hash']);

            // Close popup.
            $.fancybox.close();

            // Trigger event.
            this.trigger('userLogin');
        }
    };

    /**
     * Initiate sign in process.
     */
    UpxSSO.prototype.startSignin = function () {
        var settings = this.getSettings();
        if (upxIsMobileView()) {
            window.location.href = settings.signinMobileUrl + '?back_url=' + encodeURIComponent(window.location.href);
        } else {
            $.fancybox.open({
                src: settings.signinIframeUrl,
                type: 'iframe'
            });
        }
    };

    /**
     * Initiate sign out process.
     */
    UpxSSO.prototype.startSignout = function () {
        window.location.href = this.getSettings().signoutUrl + '&back_url=' + encodeURIComponent(window.location.href);
    };

    /**
     * Initiate sign up process.
     */
    UpxSSO.prototype.startSignup = function () {
        var settings = this.getSettings();
        if (upxIsMobileView()) {
            window.location.href = settings.signupMobileUrl + '?back_url=' + encodeURIComponent(window.location.href);
        } else {
            $.fancybox.open({
                src: settings.signupIframeUrl,
                type: 'iframe'
            });
        }
    };

})(jQuery, upxSsoSettings);
;
(function (settings) {

    if (+settings.is_mobile) {
        render();
    } else {
        setTimeout(render, +settings.delay);
    }

    /**
     * Render player.
     */
    function render() {
        var div = document.getElementById(settings.el_id);
        if (div) {
            var result = settings.embed.match(/<script[^>]*src=["']([^"']*)["'][^>]*data-content-id=["']([^"']*)["'][^>]*>/i);
            if (result) {
                var script = document.createElement('script');
                script.src = result[1];
                script.setAttribute('data-content-id', result[2]);
                div.after(script);
            }
        }
    }
})(window.upxMmSettings);;
/*! This file is auto-generated */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ClipboardJS=e():t.ClipboardJS=e()}(this,function(){return o={},r.m=n=[function(t,e){t.exports=function(t){var e,n="SELECT"===t.nodeName?(t.focus(),t.value):"INPUT"===t.nodeName||"TEXTAREA"===t.nodeName?((e=t.hasAttribute("readonly"))||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),e||t.removeAttribute("readonly"),t.value):(t.hasAttribute("contenteditable")&&t.focus(),n=window.getSelection(),(e=document.createRange()).selectNodeContents(t),n.removeAllRanges(),n.addRange(e),n.toString());return n}},function(t,e){function n(){}n.prototype={on:function(t,e,n){var o=this.e||(this.e={});return(o[t]||(o[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var o=this;function r(){o.off(t,r),e.apply(n,arguments)}return r._=e,this.on(t,r,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),o=0,r=n.length;o<r;o++)n[o].fn.apply(n[o].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),o=n[t],r=[];if(o&&e)for(var i=0,a=o.length;i<a;i++)o[i].fn!==e&&o[i].fn._!==e&&r.push(o[i]);return r.length?n[t]=r:delete n[t],this}},t.exports=n,t.exports.TinyEmitter=n},function(t,e,n){var u=n(3),s=n(4);t.exports=function(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!u.string(e))throw new TypeError("Second argument must be a String");if(!u.fn(n))throw new TypeError("Third argument must be a Function");if(u.node(t))return c=e,l=n,(a=t).addEventListener(c,l),{destroy:function(){a.removeEventListener(c,l)}};if(u.nodeList(t))return o=t,r=e,i=n,Array.prototype.forEach.call(o,function(t){t.addEventListener(r,i)}),{destroy:function(){Array.prototype.forEach.call(o,function(t){t.removeEventListener(r,i)})}};if(u.string(t))return t=t,e=e,n=n,s(document.body,t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList");var o,r,i,a,c,l}},function(t,n){n.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},n.nodeList=function(t){var e=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===e||"[object HTMLCollection]"===e)&&"length"in t&&(0===t.length||n.node(t[0]))},n.string=function(t){return"string"==typeof t||t instanceof String},n.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},function(t,e,n){var a=n(5);function i(t,e,n,o,r){var i=function(e,n,t,o){return function(t){t.delegateTarget=a(t.target,n),t.delegateTarget&&o.call(e,t)}}.apply(this,arguments);return t.addEventListener(n,i,r),{destroy:function(){t.removeEventListener(n,i,r)}}}t.exports=function(t,e,n,o,r){return"function"==typeof t.addEventListener?i.apply(null,arguments):"function"==typeof n?i.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,function(t){return i(t,e,n,o,r)}))}},function(t,e){var n;"undefined"==typeof Element||Element.prototype.matches||((n=Element.prototype).matches=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector),t.exports=function(t,e){for(;t&&9!==t.nodeType;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}},function(t,e,n){"use strict";n.r(e);var o=n(0),r=n.n(o),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),this.resolveOptions(t),this.initSelection()}var l=(function(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}(c,[{key:"resolveOptions",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";e=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=e+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=r()(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=r()(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),document.activeElement.blur(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){if(this._action=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"copy","copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==(void 0===t?"undefined":i(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),c),u=n(1),o=n.n(u),u=n(2),s=n.n(u),f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t};function d(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)})(h,o.a),u(h,[{key:"resolveOptions",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===f(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=s()(t,"click",function(t){return e.onClick(t)})}},{key:"onClick",value:function(t){t=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new l({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(t){return p("action",t)}},{key:"defaultTarget",value:function(t){t=p("target",t);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(t){return p("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e=!!document.queryCommandSupported;return("string"==typeof t?[t]:t).forEach(function(t){e=e&&!!document.queryCommandSupported(t)}),e}}]),u=h;function h(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));return n.resolveOptions(e),n.listenClick(t),n}function p(t,e){t="data-clipboard-"+t;if(e.hasAttribute(t))return e.getAttribute(t)}e.default=u}],r.c=o,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=6).default;function r(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var n,o});;
'use strict';

/**
 * Article javascripts.
 */
(function ($) {

    var clipboard = new ClipboardJS('.clipboard');
    clipboard.on('success', function (e) {
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        e.trigger.classList.add('action');
        setTimeout(function () {
            e.trigger.classList.remove('action');
        }, 2000);
    });

    $('#main').on('click', '.join-discussion', function (e) {
		e.preventDefault();
		$(this).parent().find('.comments-respond').addClass('show-comments');
		$('body').addClass('comments-view');
	}).on('click', '.back-to-post', function (e) {
		e.preventDefault();
		$(this).closest('.comments-respond').removeClass('show-comments');
		$('body').removeClass('comments-view');
	});

})(jQuery);
;
'use strict';

/**
 * Object to track page views.
 */

/**
 * @constructor
 */
function UpxUrlTracker() {
    this.items = [];
    this.tracked = [];
    this.minVisibleH = 75; // Default 75px

    var me = this;
    window.addEventListener('scroll', function (e) {
        me.onWinScroll(e);
    });
}

/**
 * Add HTML Element to track list.
 *
 * @param {HTMLElement|Element} el
 * @param {string} url
 * @param {string} title
 */
UpxUrlTracker.prototype.add = function (el, url, title) {

    if (this.tracked.indexOf(url) !== -1) {
        return;
    }

    this.items.push({
        el: el,
        title: title,
        url: url
    });
};

/**
 * Process elements on window scroll.
 */
UpxUrlTracker.prototype.onWinScroll = function () {

    var untrackedItems = [];

    for (var i = 0; i < this.items.length; i++) {
        var data = this.items[i];
        if (upxIsInViewport(data.el, this.minVisibleH)) {
            this.track(data.url, data.title);
        } else {
            untrackedItems.push(data);
        }
    }

    this.items = untrackedItems;
};


/**
 * Track page view.
 *
 * @param {string} url
 * @param {string} title
 */
UpxUrlTracker.prototype.track = function (url, title) {

    if (!url || this.tracked.indexOf(url) !== -1) {
        return;
    }

    title = title ? title : '';

    // Remove category from url.
    url = url.replace('/category/', '/');

    // Get relative url.
    var relativeUrl = url.replace(location.origin, '');

    console.log('UpxUrlTracker.track', relativeUrl, title);

    this.trigger('track', {
        absoluteUrl: url,
        relativeUrl: relativeUrl,
        title: title
    });

    this.tracked.push(url);
};

// Extend backbone event.
_.extend(UpxUrlTracker.prototype, Backbone.Events);

// Create instance.
UPX.urlTracker = new UpxUrlTracker();
UPX.trigger('urlTrackerReady');
;
(function ($) {

    let hash = window.location.hash;
    if (!hash) {
        return;
    }
    hash = hash.replace(/^#+/, '');

    const el = document.getElementById(hash);
    if (!el) {
        return;
    }

    function scrollToEl() {
        const offset = $(el).offset();
        let scrollTo = offset.top - $('#masthead').height() - 15;

        const adminBar = document.getElementById('wpadminbar');
        if (adminBar) {
            scrollTo -= $(adminBar).height();
        }
        window.scrollTo(0, scrollTo);
    }

    $(document).ready(() => scrollToEl());

})(jQuery);;
/**
 * Spot.IM SSO integration.
 */
(function ($, settings) {

    'use strict';

    // Wait for Uproxx SSO to be ready.
    if (UPX.sso) {
        initSpotImSSO()
    } else {
        UPX.bind('ssoReady', initSpotImSSO);
    }

    /**
     * Init Spot.IM SSO
     */
    function initSpotImSSO() {

        // Sync users.
        if (window.SPOTIM && window.SPOTIM.startSpotImSSO) {
            spotImSSOReady();
        } else {
            document.addEventListener('spot-im-api-ready', spotImSSOReady, false);
        }

        document.addEventListener('spot-im-login-start', function (event) {
            UPX.sso.startSignin();
        });
    }

    /**
     * Log out user.
     */
    function spotImLogOut() {
        if (window.SPOTIM && window.SPOTIM.logout) {
            window.SPOTIM.logout();
        } else {
            document.addEventListener('spot-im-api-ready', function () {
                window.SPOTIM.logout();
            }, false);
        }
    }

    /**
     * Once Spot.IM SSO is ready.
     */
    function spotImSSOReady() {
        startSpotImSSO();
        UPX.sso.bind('userLogin', startSpotImSSO);
    }

    /**
     * Initiate user sign in.
     */
    function startSpotImSSO() {

        if (!UPX.sso.getUser()) {
            spotImLogOut();
            return;
        }

        var callback = function (codeA, completeSSOCallback) {
            $.ajax({
                method: 'POST',
                url: settings.ajaxUrl,
                dataType: 'json',
                data: {
                    action: settings.ajaxAction,
                    code_a: codeA,
                    user: UPX.sso.getUser().toHashMap()
                },
                success: function (response) {
                    if (response && response.code_b) {
                        completeSSOCallback(response.code_b);
                    }
                }
            });
        };

        window.SPOTIM.startSSO(callback).then(function (userData) {
            // All good.
        }).catch(function (reason) {
            // Something went wrong.
        });
    }
})(jQuery, upx_spot_im);
;
'use strict';

/**
 * Share Buttons Event Listeners.
 */
(function ($, settings) {

    $(document).on('click', '.share-link', function () {

        var btn = $(this);
        var article = $('article#post-' + btn.data('post_id'));

        if (!article.length) {
            return;
        }

        var excerpt = article.data('excerpt');
        var img = article.data('thumb');
        var title = article.data('title');
        var url = article.data('shorturl') || article.data('url');

        // Track the click.
        if (window.ga) {
            ga('send', 'event', 'Share Button', btn.data('type'), article.data('url'), {
                nonInteraction: true
            });
        }

        if (btn.hasClass('mail')) {

            var mail_url = 'mailto:?subject=' + encodeURIComponent(title)
                + '&body=' + encodeURIComponent(url);

            window.location.assign(mail_url);

        } else if (btn.hasClass('flipboard')) {

            var flip_url = 'https://share.flipboard.com/bookmarklet/popout?v=2'
                + '&title=' + encodeURIComponent(title)
                + '&url=' + encodeURIComponent(url)
                + '&t=' + Date.now()
                + '&utm_campaign=tools&utm_medium=article-share&utm_source=uproxx.com';

            window.open(flip_url, '', 'width=535,height=560');

        } else if (btn.hasClass('facebook')) {

            var fb_url = 'https://www.facebook.com/dialog/feed?display=popup&app_id=' + settings.fbAppId
                + '&name=' + encodeURIComponent(article.data('title-fb') || title)
                + '&description=' + encodeURIComponent(excerpt)
                + '&href=' + encodeURIComponent(url)
                + '&link=' + encodeURIComponent(url)
                + '&picture=' + encodeURIComponent(article.data('image-fb') || img)
                + '&redirect_uri=' + encodeURIComponent(url);

            window.open(fb_url, null, 'width=600,height=390');

        } else if (btn.hasClass('twitter')) {

            var tw_url = 'https://twitter.com/intent/tweet'
                + '?text=' + encodeURIComponent(article.data('title-tw') || title)
                + '&url=' + encodeURIComponent(url);

            window.open(tw_url, null, 'width=600,height=300');
        } else {
            return;
        }

        return false;
    });

})(jQuery, upxSocial);
;
!function(t,e){for(var n in e)t[n]=e[n]}(window,function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([,function(t,e){!function(){"use strict";if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var t=function(t){for(var e=window.document,n=i(e);n;)n=i(e=n.ownerDocument);return e}(),e=[],n=null,o=null;s.prototype.THROTTLE_TIMEOUT=100,s.prototype.POLL_INTERVAL=null,s.prototype.USE_MUTATION_OBSERVER=!0,s._setupCrossOriginUpdater=function(){return n||(n=function(t,n){o=t&&n?l(t,n):{top:0,bottom:0,left:0,right:0,width:0,height:0},e.forEach((function(t){t._checkForIntersections()}))}),n},s._resetCrossOriginUpdater=function(){n=null,o=null},s.prototype.observe=function(t){if(!this._observationTargets.some((function(e){return e.element==t}))){if(!t||1!=t.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(t.ownerDocument),this._checkForIntersections()}},s.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter((function(e){return e.element!=t})),this._unmonitorIntersections(t.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},s.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},s.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},s.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter((function(t,e,n){if("number"!=typeof t||isNaN(t)||t<0||t>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==n[e-1]}))},s.prototype._parseRootMargin=function(t){var e=(t||"0px").split(/\s+/).map((function(t){var e=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}}));return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},s.prototype._monitorIntersections=function(e){var n=e.defaultView;if(n&&-1==this._monitoringDocuments.indexOf(e)){var o=this._checkForIntersections,r=null,s=null;this.POLL_INTERVAL?r=n.setInterval(o,this.POLL_INTERVAL):(h(n,"resize",o,!0),h(e,"scroll",o,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in n&&(s=new n.MutationObserver(o)).observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(e),this._monitoringUnsubscribes.push((function(){var t=e.defaultView;t&&(r&&t.clearInterval(r),u(t,"resize",o,!0)),u(e,"scroll",o,!0),s&&s.disconnect()}));var c=this.root&&(this.root.ownerDocument||this.root)||t;if(e!=c){var a=i(e);a&&this._monitorIntersections(a.ownerDocument)}}},s.prototype._unmonitorIntersections=function(e){var n=this._monitoringDocuments.indexOf(e);if(-1!=n){var o=this.root&&(this.root.ownerDocument||this.root)||t;if(!this._observationTargets.some((function(t){var n=t.element.ownerDocument;if(n==e)return!0;for(;n&&n!=o;){var r=i(n);if((n=r&&r.ownerDocument)==e)return!0}return!1}))){var r=this._monitoringUnsubscribes[n];if(this._monitoringDocuments.splice(n,1),this._monitoringUnsubscribes.splice(n,1),r(),e!=o){var s=i(e);s&&this._unmonitorIntersections(s.ownerDocument)}}}},s.prototype._unmonitorAllIntersections=function(){var t=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var e=0;e<t.length;e++)t[e]()},s.prototype._checkForIntersections=function(){if(this.root||!n||o){var t=this._rootIsInDom(),e=t?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(o){var i=o.element,s=c(i),h=this._rootContainsTarget(i),u=o.entry,a=t&&h&&this._computeTargetAndRootIntersection(i,s,e),l=null;this._rootContainsTarget(i)?n&&!this.root||(l=e):l={top:0,bottom:0,left:0,right:0,width:0,height:0};var f=o.entry=new r({time:window.performance&&performance.now&&performance.now(),target:i,boundingClientRect:s,rootBounds:l,intersectionRect:a});u?t&&h?this._hasCrossedThreshold(u,f)&&this._queuedEntries.push(f):u&&u.isIntersecting&&this._queuedEntries.push(f):this._queuedEntries.push(f)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},s.prototype._computeTargetAndRootIntersection=function(e,i,r){if("none"!=window.getComputedStyle(e).display){for(var s,h,u,a,f,d,g,m,v=i,b=p(e),_=!1;!_&&b;){var w=null,y=1==b.nodeType?window.getComputedStyle(b):{};if("none"==y.display)return null;if(b==this.root||9==b.nodeType)if(_=!0,b==this.root||b==t)n&&!this.root?!o||0==o.width&&0==o.height?(b=null,w=null,v=null):w=o:w=r;else{var I=p(b),T=I&&c(I),E=I&&this._computeTargetAndRootIntersection(I,T,r);T&&E?(b=I,w=l(T,E)):(b=null,v=null)}else{var R=b.ownerDocument;b!=R.body&&b!=R.documentElement&&"visible"!=y.overflow&&(w=c(b))}if(w&&(s=w,h=v,u=void 0,a=void 0,f=void 0,d=void 0,g=void 0,m=void 0,u=Math.max(s.top,h.top),a=Math.min(s.bottom,h.bottom),f=Math.max(s.left,h.left),d=Math.min(s.right,h.right),m=a-u,v=(g=d-f)>=0&&m>=0&&{top:u,bottom:a,left:f,right:d,width:g,height:m}||null),!v)break;b=b&&p(b)}return v}},s.prototype._getRootRect=function(){var e;if(this.root&&!d(this.root))e=c(this.root);else{var n=d(this.root)?this.root:t,o=n.documentElement,i=n.body;e={top:0,left:0,right:o.clientWidth||i.clientWidth,width:o.clientWidth||i.clientWidth,bottom:o.clientHeight||i.clientHeight,height:o.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(e)},s.prototype._expandRectByRootMargin=function(t){var e=this._rootMarginValues.map((function(e,n){return"px"==e.unit?e.value:e.value*(n%2?t.width:t.height)/100})),n={top:t.top-e[0],right:t.right+e[1],bottom:t.bottom+e[2],left:t.left-e[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},s.prototype._hasCrossedThreshold=function(t,e){var n=t&&t.isIntersecting?t.intersectionRatio||0:-1,o=e.isIntersecting?e.intersectionRatio||0:-1;if(n!==o)for(var i=0;i<this.thresholds.length;i++){var r=this.thresholds[i];if(r==n||r==o||r<n!=r<o)return!0}},s.prototype._rootIsInDom=function(){return!this.root||f(t,this.root)},s.prototype._rootContainsTarget=function(e){var n=this.root&&(this.root.ownerDocument||this.root)||t;return f(n,e)&&(!this.root||n==e.ownerDocument)},s.prototype._registerInstance=function(){e.indexOf(this)<0&&e.push(this)},s.prototype._unregisterInstance=function(){var t=e.indexOf(this);-1!=t&&e.splice(t,1)},window.IntersectionObserver=s,window.IntersectionObserverEntry=r}function i(t){try{return t.defaultView&&t.defaultView.frameElement||null}catch(e){return null}}function r(t){this.time=t.time,this.target=t.target,this.rootBounds=a(t.rootBounds),this.boundingClientRect=a(t.boundingClientRect),this.intersectionRect=a(t.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,n=e.width*e.height,o=this.intersectionRect,i=o.width*o.height;this.intersectionRatio=n?Number((i/n).toFixed(4)):this.isIntersecting?1:0}function s(t,e){var n,o,i,r=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(r.root&&1!=r.root.nodeType&&9!=r.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),o=this.THROTTLE_TIMEOUT,i=null,function(){i||(i=setTimeout((function(){n(),i=null}),o))}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(r.rootMargin),this.thresholds=this._initThresholds(r.threshold),this.root=r.root||null,this.rootMargin=this._rootMarginValues.map((function(t){return t.value+t.unit})).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function h(t,e,n,o){"function"==typeof t.addEventListener?t.addEventListener(e,n,o||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,n)}function u(t,e,n,o){"function"==typeof t.removeEventListener?t.removeEventListener(e,n,o||!1):"function"==typeof t.detatchEvent&&t.detatchEvent("on"+e,n)}function c(t){var e;try{e=t.getBoundingClientRect()}catch(n){}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function a(t){return!t||"x"in t?t:{top:t.top,y:t.top,bottom:t.bottom,left:t.left,x:t.left,right:t.right,width:t.width,height:t.height}}function l(t,e){var n=e.top-t.top,o=e.left-t.left;return{top:n,left:o,height:e.height,width:e.width,bottom:n+e.height,right:o+e.width}}function f(t,e){for(var n=e;n;){if(n==t)return!0;n=p(n)}return!1}function p(e){var n=e.parentNode;return 9==e.nodeType&&e!=t?i(e):(n&&n.assignedSlot&&(n=n.assignedSlot.parentNode),n&&11==n.nodeType&&n.host?n.host:n)}function d(t){return t&&9===t.nodeType}}()}]));;
!function(e,t){for(var n in t)e[n]=t[n]}(window,function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){var n=function(){var e,t,n,a={rootMargin:"200px 0px",threshold:.01},r=[];o();var i=document.querySelector("body");function o(){e=[].slice.call(document.querySelectorAll("img.jetpack-lazy-image:not(.jetpack-lazy-image--handled)")),n&&n.disconnect(),"IntersectionObserver"in window?(n=new IntersectionObserver(l,a),e.forEach((function(e){e.getAttribute("data-lazy-loaded")||n.observe(e)})),window.addEventListener("beforeprint",c),window.matchMedia&&window.matchMedia("print").addListener((function(e){e.matches&&c()}))):d()}function d(){for(n&&n.disconnect();e.length>0;)s(e[0])}function l(t){for(var a=0;a<t.length;a++){var r=t[a];r.intersectionRatio>0&&(n.unobserve(r.target),s(r.target))}0===e.length&&n.disconnect()}function c(){if(!t&&(e.length>0||r.length>0)){(t=document.createElement("div")).id="loadingWarning",t.style.fontWeight="bold",t.innerText=jetpackLazyImagesL10n.loading_warning;var n=document.createElement("style");n.innerHTML="#loadingWarning { display: none; }\n@media print {\n#loadingWarning { display: block; }\nbody > #loadingWarning ~ * { display: none !important; }\n}",t.appendChild(n),i.insertBefore(t,i.firstChild)}e.length>0&&d(),t&&alert(jetpackLazyImagesL10n.loading_warning)}function s(t){var n;if(t instanceof HTMLImageElement){var a=t.getAttribute("data-lazy-srcset"),i=t.getAttribute("data-lazy-sizes");t.removeAttribute("data-lazy-srcset"),t.removeAttribute("data-lazy-sizes"),t.removeAttribute("data-lazy-src"),t.classList.add("jetpack-lazy-image--handled"),t.setAttribute("data-lazy-loaded",1),i&&t.setAttribute("sizes",i),a?t.setAttribute("srcset",a):t.removeAttribute("srcset"),t.setAttribute("loading","eager"),r.push(t);var o=e.indexOf(t);o>=0&&e.splice(o,1),t.complete?u.call(t,null):(t.addEventListener("load",u,{once:!0}),t.addEventListener("error",u,{once:!0}));try{n=new Event("jetpack-lazy-loaded-image",{bubbles:!0,cancelable:!0})}catch(d){(n=document.createEvent("Event")).initEvent("jetpack-lazy-loaded-image",!0,!0)}t.dispatchEvent(n)}}function u(){var n=r.indexOf(this);n>=0&&r.splice(n,1),t&&0===e.length&&0===r.length&&(t.parentNode.removeChild(t),t=null)}i&&(i.addEventListener("is.post-load",o),i.addEventListener("jetpack-lazy-images-load",o))};"interactive"===document.readyState||"complete"===document.readyState?n():document.addEventListener("DOMContentLoaded",n)}]));;
'use strict';

/**
 * Add javascript event tracker on the website.
 */
UPX.urlTracker.bind('track', function () {
    if (window.__qc) {
        __qc.qpixelsent = [];
        _qevents.push({
            qacct: _qacct
        });
    }
});
;
'use strict';

/**
 * Add javascript event tracker on the website.
 */
UPX.urlTracker.bind('track', function (data) {
    if (window.ga && data && data.relativeUrl) {
        ga('send', 'pageview', data.relativeUrl);
    }
});;
'use strict';

//Visid Library starts here
/**
 * @license
 * Adobe Visitor API for JavaScript version: 4.0.0
 * Copyright 2019 Adobe, Inc. All Rights Reserved
 * More info available at https://marketing.adobe.com/resources/help/en_US/mcvid/
 */
var e = function () {
    "use strict";

    function e(t) {
        return (e = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) {
            return typeof e
        } : function (e) {
            return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
        })(t)
    }

    function t(e, t, n) {
        return t in e ? Object.defineProperty(e, t, {value: n, enumerable: !0, configurable: !0, writable: !0}) : e[t] = n, e
    }

    function n() {
        return {
            callbacks: {}, add: function (e, t) {
                this.callbacks[e] = this.callbacks[e] || [];
                var n = this.callbacks[e].push(t) - 1, i = this;
                return function () {
                    i.callbacks[e].splice(n, 1)
                }
            }, execute: function (e, t) {
                if (this.callbacks[e]) {
                    t = void 0 === t ? [] : t, t = t instanceof Array ? t : [t];
                    try {
                        for (; this.callbacks[e].length;) {
                            var n = this.callbacks[e].shift();
                            "function" == typeof n ? n.apply(null, t) : n instanceof Array && n[1].apply(n[0], t)
                        }
                        delete this.callbacks[e]
                    } catch (e) {
                    }
                }
            }, executeAll: function (e, t) {
                (t || e && !F.isObjectEmpty(e)) && Object.keys(this.callbacks).forEach(function (t) {
                    var n = void 0 !== e[t] ? e[t] : "";
                    this.execute(t, n)
                }, this)
            }, hasCallbacks: function () {
                return Boolean(Object.keys(this.callbacks).length)
            }
        }
    }

    function i(e) {
        for (var t = /^\d+$/, n = 0, i = e.length; n < i; n++) if (!t.test(e[n])) return !1;
        return !0
    }

    function r(e, t) {
        for (; e.length < t.length;) e.push("0");
        for (; t.length < e.length;) t.push("0")
    }

    function a(e, t) {
        for (var n = 0; n < e.length; n++) {
            var i = parseInt(e[n], 10), r = parseInt(t[n], 10);
            if (i > r) return 1;
            if (r > i) return -1
        }
        return 0
    }

    function o(e, t) {
        if (e === t) return 0;
        var n = e.toString().split("."), o = t.toString().split(".");
        return i(n.concat(o)) ? (r(n, o), a(n, o)) : NaN
    }

    function s(e) {
        return e === Object(e) && 0 === Object.keys(e).length
    }

    function l(e) {
        return "function" == typeof e || e instanceof Array && e.length
    }

    function c() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.isEnabled, n = e.cookieName, i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, r = i.cookies;
        return t && n && r ? {
            remove: function () {
                r.remove(n)
            }, get: function () {
                var e = r.get(n), t = {};
                try {
                    t = JSON.parse(e)
                } catch (e) {
                    t = {}
                }
                return t
            }, set: function (e, t) {
                t = t || {}, r.set(n, JSON.stringify(e), {domain: t.optInCookieDomain || "", cookieLifetime: t.optInStorageExpiry || 3419e4, expires: !0})
            }
        } : {get: be, set: be, remove: be}
    }

    function u(e) {
        this.name = this.constructor.name, this.message = e, "function" == typeof Error.captureStackTrace ? Error.captureStackTrace(this, this.constructor) : this.stack = new Error(e).stack
    }

    function d() {
        function e(e, t) {
            var n = ge(e);
            return n.length ? n.every(function (e) {
                return !!t[e]
            }) : pe(t)
        }

        function t() {
            M(y), O(oe.COMPLETE), _(h.status, h.permissions), m.set(h.permissions, {optInCookieDomain: l, optInStorageExpiry: u}), C.execute(Ee)
        }

        function n(e) {
            return function (n, i) {
                if (!me(n)) throw new Error("[OptIn] Invalid category(-ies). Please use the `OptIn.Categories` enum.");
                return O(oe.CHANGED), Object.assign(y, he(ge(n), e)), i || t(), h
            }
        }

        var i = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, r = i.doesOptInApply, a = i.previousPermissions, o = i.preOptInApprovals, s = i.isOptInStorageEnabled, l = i.optInCookieDomain, u = i.optInStorageExpiry, d = i.isIabContext,
            f = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, g = f.cookies, p = Ae(a);
        ye(p, "Invalid `previousPermissions`!"), ye(o, "Invalid `preOptInApprovals`!");
        var m = c({isEnabled: !!s, cookieName: "adobeujs-optin"}, {cookies: g}), h = this, _ = ae(h), C = de(), I = Ie(p), v = Ie(o), D = m.get(), S = {}, b = function (e, t) {
            return ve(e) || t && ve(t) ? oe.COMPLETE : oe.PENDING
        }(I, D), A = function (e, t, n) {
            var i = he(ue, !r);
            return r ? Object.assign({}, i, e, t, n) : i
        }(v, I, D), y = _e(A), O = function (e) {
            return b = e
        }, M = function (e) {
            return A = e
        };
        h.deny = n(!1), h.approve = n(!0), h.denyAll = h.deny.bind(h, ue), h.approveAll = h.approve.bind(h, ue), h.isApproved = function (t) {
            return e(t, h.permissions)
        }, h.isPreApproved = function (t) {
            return e(t, v)
        }, h.fetchPermissions = function (e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1], n = t ? h.on(oe.COMPLETE, e) : be;
            return !r || r && h.isComplete || !!o ? e(h.permissions) : t || C.add(Ee, function () {
                return e(h.permissions)
            }), n
        }, h.complete = function () {
            h.status === oe.CHANGED && t()
        }, h.registerPlugin = function (e) {
            if (!e || !e.name || "function" != typeof e.onRegister) throw new Error(Te);
            S[e.name] || (S[e.name] = e, e.onRegister.call(e, h))
        }, h.execute = ke(S), Object.defineProperties(h, {
            permissions: {
                get: function () {
                    return A
                }
            }, status: {
                get: function () {
                    return b
                }
            }, Categories: {
                get: function () {
                    return se
                }
            }, doesOptInApply: {
                get: function () {
                    return !!r
                }
            }, isPending: {
                get: function () {
                    return h.status === oe.PENDING
                }
            }, isComplete: {
                get: function () {
                    return h.status === oe.COMPLETE
                }
            }, __plugins: {
                get: function () {
                    return Object.keys(S)
                }
            }, isIabContext: {
                get: function () {
                    return d
                }
            }
        })
    }

    function f(e, t) {
        function n() {
            r = null, e.call(e, new u("The call took longer than you wanted!"))
        }

        function i() {
            r && (clearTimeout(r), e.apply(e, arguments))
        }

        if (void 0 === t) return e;
        var r = setTimeout(n, t);
        return i
    }

    function g() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : Le(), t = this;
        t.name = "iabPlugin", t.version = "0.0.1";
        var n = de(), i = {allConsentData: null}, r = function (e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};
            return i[e] = t
        };
        t.fetchConsentData = function (e) {
            var t = e.callback, n = e.timeout, i = f(t, n);
            a({callback: i})
        }, t.isApproved = function (e) {
            var t = e.callback, n = e.category, r = e.timeout;
            if (i.allConsentData) return t(null, l(n, i.allConsentData.vendorConsents, i.allConsentData.purposeConsents));
            var o = f(function (e) {
                var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, r = i.vendorConsents, a = i.purposeConsents;
                t(e, l(n, r, a))
            }, r);
            a({category: n, callback: o})
        }, t.onRegister = function (e) {
            var n = Object.keys(le), i = function (t) {
                var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, r = i.purposeConsents, a = i.gdprApplies, o = i.vendorConsents;
                !t && a && o && r && (n.forEach(function (t) {
                    var n = l(t, o, r);
                    e[n ? "approve" : "deny"](t, !0)
                }), e.complete())
            };
            t.fetchConsentData({callback: i})
        };
        var a = function (e) {
            var t = e.callback;
            if (i.allConsentData) return t(null, i.allConsentData);
            n.add("FETCH_CONSENT_DATA", t);
            var a = {};
            s(function () {
                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.purposeConsents, s = e.gdprApplies, l = e.vendorConsents;
                (arguments.length > 1 ? arguments[1] : void 0) && (a = {purposeConsents: t, gdprApplies: s, vendorConsents: l}, r("allConsentData", a)), o(function () {
                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                    (arguments.length > 1 ? arguments[1] : void 0) && (a.consentString = e.consentData, r("allConsentData", a)), n.execute("FETCH_CONSENT_DATA", [null, i.allConsentData])
                })
            })
        }, o = function (t) {
            e("getConsentData", null, t)
        }, s = function (t) {
            var n = Me(le);
            e("getVendorConsents", n, t)
        }, l = function (e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}, i = !!t[le[e]];
            return i && function () {
                return ce[e].every(function (e) {
                    return n[e]
                })
            }()
        }
    }

    function p(e, t, n) {
        var i = null == e ? void 0 : e[t];
        return void 0 === i ? n : i
    }

    var m = "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : {};
    Object.assign = Object.assign || function (e) {
        for (var t, n, i = 1; i < arguments.length; ++i) {
            n = arguments[i];
            for (t in n) Object.prototype.hasOwnProperty.call(n, t) && (e[t] = n[t])
        }
        return e
    };
    var h, _, C = {HANDSHAKE: "HANDSHAKE", GETSTATE: "GETSTATE", PARENTSTATE: "PARENTSTATE"}, I = {MCMID: "MCMID", MCAID: "MCAID", MCAAMB: "MCAAMB", MCAAMLH: "MCAAMLH", MCOPTOUT: "MCOPTOUT", CUSTOMERIDS: "CUSTOMERIDS"},
        v = {MCMID: "getMarketingCloudVisitorID", MCAID: "getAnalyticsVisitorID", MCAAMB: "getAudienceManagerBlob", MCAAMLH: "getAudienceManagerLocationHint", MCOPTOUT: "getOptOut", ALLFIELDS: "getVisitorValues"}, D = {CUSTOMERIDS: "getCustomerIDs"},
        S = {MCMID: "getMarketingCloudVisitorID", MCAAMB: "getAudienceManagerBlob", MCAAMLH: "getAudienceManagerLocationHint", MCOPTOUT: "getOptOut", MCAID: "getAnalyticsVisitorID", CUSTOMERIDS: "getCustomerIDs", ALLFIELDS: "getVisitorValues"}, b = {MC: "MCMID", A: "MCAID", AAM: "MCAAMB"},
        A = {MCMID: "MCMID", MCOPTOUT: "MCOPTOUT", MCAID: "MCAID", MCAAMLH: "MCAAMLH", MCAAMB: "MCAAMB"}, y = {UNKNOWN: 0, AUTHENTICATED: 1, LOGGED_OUT: 2}, O = {GLOBAL: "global"},
        M = {MESSAGES: C, STATE_KEYS_MAP: I, ASYNC_API_MAP: v, SYNC_API_MAP: D, ALL_APIS: S, FIELDGROUP_TO_FIELD: b, FIELDS: A, AUTH_STATE: y, OPT_OUT: O}, k = M.STATE_KEYS_MAP, E = function (e) {
            function t() {
            }

            function n(t, n) {
                var i = this;
                return function () {
                    var r = e(0, t), a = {};
                    return a[t] = r, i.setStateAndPublish(a), n(r), r
                }
            }

            var i = this;
            this.getMarketingCloudVisitorID = function (e) {
                e = e || t;
                var i = this.findField(k.MCMID, e), r = n.call(this, k.MCMID, e);
                return void 0 !== i ? i : r()
            }, this.getVisitorValues = function (e) {
                i.getMarketingCloudVisitorID(function (t) {
                    e({MCMID: t})
                })
            }
        }, T = M.MESSAGES, L = M.ASYNC_API_MAP, P = M.SYNC_API_MAP, R = function () {
            function e() {
            }

            function t(e, t) {
                var n = this;
                return function () {
                    return n.callbackRegistry.add(e, t), n.messageParent(T.GETSTATE), ""
                }
            }

            function n(n) {
                this[L[n]] = function (i) {
                    i = i || e;
                    var r = this.findField(n, i), a = t.call(this, n, i);
                    return void 0 !== r ? r : a()
                }
            }

            function i(t) {
                this[P[t]] = function () {
                    return this.findField(t, e) || {}
                }
            }

            Object.keys(L).forEach(n, this), Object.keys(P).forEach(i, this)
        }, w = M.ASYNC_API_MAP, x = function () {
            Object.keys(w).forEach(function (e) {
                this[w[e]] = function (t) {
                    this.callbackRegistry.add(e, t)
                }
            }, this)
        }, F = function (e, t) {
            return t = {exports: {}}, e(t, t.exports), t.exports
        }(function (t, n) {
            n.isObjectEmpty = function (e) {
                return e === Object(e) && 0 === Object.keys(e).length
            }, n.isValueEmpty = function (e) {
                return "" === e || n.isObjectEmpty(e)
            }, n.getIeVersion = function () {
                if (document.documentMode) return document.documentMode;
                for (var e = 7; e > 4; e--) {
                    var t = document.createElement("div");
                    if (t.innerHTML = "\x3c!--[if IE " + e + "]><span></span><![endif]--\x3e", t.getElementsByTagName("span").length) return t = null, e;
                    t = null
                }
                return null
            }, n.encodeAndBuildRequest = function (e, t) {
                return e.map(encodeURIComponent).join(t)
            }, n.isObject = function (t) {
                return null !== t && "object" === e(t) && !1 === Array.isArray(t)
            }, n.defineGlobalNamespace = function () {
                return window.adobe = n.isObject(window.adobe) ? window.adobe : {}, window.adobe
            }, n.pluck = function (e, t) {
                return t.reduce(function (t, n) {
                    return e[n] && (t[n] = e[n]), t
                }, Object.create(null))
            }, n.parseOptOut = function (e, t, n) {
                t || (t = n, e.d_optout && e.d_optout instanceof Array && (t = e.d_optout.join(",")));
                var i = parseInt(e.d_ottl, 10);
                return isNaN(i) && (i = 7200), {optOut: t, d_ottl: i}
            }, n.normalizeBoolean = function (e) {
                var t = e;
                return "true" === e ? t = !0 : "false" === e && (t = !1), t
            }
        }), N = (F.isObjectEmpty, F.isValueEmpty, F.getIeVersion, F.encodeAndBuildRequest, F.isObject, F.defineGlobalNamespace, F.pluck, F.parseOptOut, F.normalizeBoolean, n), j = M.MESSAGES, V = {0: "prefix", 1: "orgID", 2: "state"}, U = function (e, t) {
            this.parse = function (e) {
                try {
                    var t = {};
                    return e.data.split("|").forEach(function (e, n) {
                        if (void 0 !== e) {
                            t[V[n]] = 2 !== n ? e : JSON.parse(e)
                        }
                    }), t
                } catch (e) {
                }
            }, this.isInvalid = function (n) {
                var i = this.parse(n);
                if (!i || Object.keys(i).length < 2) return !0;
                var r = e !== i.orgID, a = !t || n.origin !== t, o = -1 === Object.keys(j).indexOf(i.prefix);
                return r || a || o
            }, this.send = function (n, i, r) {
                var a = i + "|" + e;
                r && r === Object(r) && (a += "|" + JSON.stringify(r));
                try {
                    n.postMessage(a, t)
                } catch (e) {
                }
            }
        }, H = M.MESSAGES, B = function (e, t, n, i) {
            function r(e) {
                Object.assign(g, e)
            }

            function a(e) {
                Object.assign(g.state, e), Object.assign(g.state.ALLFIELDS, e), g.callbackRegistry.executeAll(g.state)
            }

            function o(e) {
                if (!_.isInvalid(e)) {
                    h = !1;
                    var t = _.parse(e);
                    g.setStateAndPublish(t.state)
                }
            }

            function s(e) {
                !h && p && (h = !0, _.send(i, e))
            }

            function l() {
                r(new E(n._generateID)), g.getMarketingCloudVisitorID(), g.callbackRegistry.executeAll(g.state, !0), m.removeEventListener("message", c)
            }

            function c(e) {
                if (!_.isInvalid(e)) {
                    var t = _.parse(e);
                    h = !1, m.clearTimeout(g._handshakeTimeout), m.removeEventListener("message", c), r(new R(g)), m.addEventListener("message", o), g.setStateAndPublish(t.state), g.callbackRegistry.hasCallbacks() && s(H.GETSTATE)
                }
            }

            function u() {
                p && postMessage ? (m.addEventListener("message", c), s(H.HANDSHAKE), g._handshakeTimeout = setTimeout(l, 250)) : l()
            }

            function d() {
                m.s_c_in || (m.s_c_il = [], m.s_c_in = 0), g._c = "Visitor", g._il = m.s_c_il, g._in = m.s_c_in, g._il[g._in] = g, m.s_c_in++
            }

            function f() {
                function e(e) {
                    0 !== e.indexOf("_") && "function" == typeof n[e] && (g[e] = function () {
                    })
                }

                Object.keys(n).forEach(e), g.getSupplementalDataID = n.getSupplementalDataID, g.isAllowed = function () {
                    return !0
                }
            }

            var g = this, p = t.whitelistParentDomain;
            g.state = {ALLFIELDS: {}}, g.version = n.version, g.marketingCloudOrgID = e, g.cookieDomain = n.cookieDomain || "", g._instanceType = "child";
            var h = !1, _ = new U(e, p);
            g.callbackRegistry = N(), g.init = function () {
                d(), f(), r(new x(g)), u()
            }, g.findField = function (e, t) {
                if (g.state[e]) return t(g.state[e]), g.state[e]
            }, g.messageParent = s, g.setStateAndPublish = a
        }, G = M.MESSAGES, q = M.ALL_APIS, Y = M.ASYNC_API_MAP, X = M.FIELDGROUP_TO_FIELD, z = function (e, t) {
            function n() {
                var t = {};
                return Object.keys(q).forEach(function (n) {
                    var i = q[n], r = e[i]();
                    F.isValueEmpty(r) || (t[n] = r)
                }), t
            }

            function i() {
                var t = [];
                return e._loading && Object.keys(e._loading).forEach(function (n) {
                    if (e._loading[n]) {
                        var i = X[n];
                        t.push(i)
                    }
                }), t.length ? t : null
            }

            function r(t) {
                return function n(r) {
                    var a = i();
                    if (a) {
                        var o = Y[a[0]];
                        e[o](n, !0)
                    } else t()
                }
            }

            function a(e, i) {
                var r = n();
                t.send(e, i, r)
            }

            function o(e) {
                l(e), a(e, G.HANDSHAKE)
            }

            function s(e) {
                r(function () {
                    a(e, G.PARENTSTATE)
                })()
            }

            function l(n) {
                function i(i) {
                    r.call(e, i), t.send(n, G.PARENTSTATE, {CUSTOMERIDS: e.getCustomerIDs()})
                }

                var r = e.setCustomerIDs;
                e.setCustomerIDs = i
            }

            return function (e) {
                if (!t.isInvalid(e)) {
                    (t.parse(e).prefix === G.HANDSHAKE ? o : s)(e.source)
                }
            }
        }, W = function (e, t) {
            function n(e) {
                return function (n) {
                    i[e] = n, r++, r === a && t(i)
                }
            }

            var i = {}, r = 0, a = Object.keys(e).length;
            Object.keys(e).forEach(function (t) {
                var i = e[t];
                if (i.fn) {
                    var r = i.args || [];
                    r.unshift(n(t)), i.fn.apply(i.context || null, r)
                }
            })
        }, J = function (e) {
            var t;
            if (!e && m.location && (e = m.location.hostname), t = e) if (/^[0-9.]+$/.test(t)) t = ""; else {
                var n = ",ac,ad,ae,af,ag,ai,al,am,an,ao,aq,ar,as,at,au,aw,ax,az,ba,bb,be,bf,bg,bh,bi,bj,bm,bo,br,bs,bt,bv,bw,by,bz,ca,cc,cd,cf,cg,ch,ci,cl,cm,cn,co,cr,cu,cv,cw,cx,cz,de,dj,dk,dm,do,dz,ec,ee,eg,es,et,eu,fi,fm,fo,fr,ga,gb,gd,ge,gf,gg,gh,gi,gl,gm,gn,gp,gq,gr,gs,gt,gw,gy,hk,hm,hn,hr,ht,hu,id,ie,im,in,io,iq,ir,is,it,je,jo,jp,kg,ki,km,kn,kp,kr,ky,kz,la,lb,lc,li,lk,lr,ls,lt,lu,lv,ly,ma,mc,md,me,mg,mh,mk,ml,mn,mo,mp,mq,mr,ms,mt,mu,mv,mw,mx,my,na,nc,ne,nf,ng,nl,no,nr,nu,nz,om,pa,pe,pf,ph,pk,pl,pm,pn,pr,ps,pt,pw,py,qa,re,ro,rs,ru,rw,sa,sb,sc,sd,se,sg,sh,si,sj,sk,sl,sm,sn,so,sr,st,su,sv,sx,sy,sz,tc,td,tf,tg,th,tj,tk,tl,tm,tn,to,tp,tr,tt,tv,tw,tz,ua,ug,uk,us,uy,uz,va,vc,ve,vg,vi,vn,vu,wf,ws,yt,",
                    i = t.split("."), r = i.length - 1, a = r - 1;
                if (r > 1 && i[r].length <= 2 && (2 === i[r - 1].length || n.indexOf("," + i[r] + ",") < 0) && a--, a > 0) for (t = ""; r >= a;) t = i[r] + (t ? "." : "") + t, r--
            }
            return t
        }, K = {
            compare: o, isLessThan: function (e, t) {
                return o(e, t) < 0
            }, areVersionsDifferent: function (e, t) {
                return 0 !== o(e, t)
            }, isGreaterThan: function (e, t) {
                return o(e, t) > 0
            }, isEqual: function (e, t) {
                return 0 === o(e, t)
            }
        }, Q = !!m.postMessage, $ = {
            postMessage: function (e, t, n) {
                var i = 1;
                t && (Q ? n.postMessage(e, t.replace(/([^:]+:\/\/[^\/]+).*/, "$1")) : t && (n.location = t.replace(/#.*$/, "") + "#" + +new Date + i++ + "&" + e))
            }, receiveMessage: function (e, t) {
                var n;
                try {
                    Q && (e && (n = function (n) {
                        if ("string" == typeof t && n.origin !== t || "[object Function]" === Object.prototype.toString.call(t) && !1 === t(n.origin)) return !1;
                        e(n)
                    }), m.addEventListener ? m[e ? "addEventListener" : "removeEventListener"]("message", n) : m[e ? "attachEvent" : "detachEvent"]("onmessage", n))
                } catch (e) {
                }
            }
        }, Z = function (e) {
            var t, n, i = "0123456789", r = "", a = "", o = 8, s = 10, l = 10;
            if (1 == e) {
                for (i += "ABCDEF", t = 0; 16 > t; t++) n = Math.floor(Math.random() * o), r += i.substring(n, n + 1), n = Math.floor(Math.random() * o), a += i.substring(n, n + 1), o = 16;
                return r + "-" + a
            }
            for (t = 0; 19 > t; t++) n = Math.floor(Math.random() * s), r += i.substring(n, n + 1), 0 === t && 9 == n ? s = 3 : (1 == t || 2 == t) && 10 != s && 2 > n ? s = 10 : 2 < t && (s = 10), n = Math.floor(Math.random() * l), a += i.substring(n, n + 1), 0 === t && 9 == n ? l = 3 : (1 == t || 2 == t) && 10 != l && 2 > n ? l = 10 : 2 < t && (l = 10);
            return r + a
        }, ee = function (e, t) {
            return {
                corsMetadata: function () {
                    var e = "none", t = !0;
                    return "undefined" != typeof XMLHttpRequest && XMLHttpRequest === Object(XMLHttpRequest) && ("withCredentials" in new XMLHttpRequest ? e = "XMLHttpRequest" : "undefined" != typeof XDomainRequest && XDomainRequest === Object(XDomainRequest) && (t = !1), Object.prototype.toString.call(m.HTMLElement).indexOf("Constructor") > 0 && (t = !1)), {
                        corsType: e,
                        corsCookiesEnabled: t
                    }
                }(), getCORSInstance: function () {
                    return "none" === this.corsMetadata.corsType ? null : new m[this.corsMetadata.corsType]
                }, fireCORS: function (t, n, i) {
                    function r(e) {
                        var n;
                        try {
                            if ((n = JSON.parse(e)) !== Object(n)) return void a.handleCORSError(t, null, "Response is not JSON")
                        } catch (e) {
                            return void a.handleCORSError(t, e, "Error parsing response as JSON")
                        }
                        try {
                            for (var i = t.callback, r = m, o = 0; o < i.length; o++) r = r[i[o]];
                            r(n)
                        } catch (e) {
                            a.handleCORSError(t, e, "Error forming callback function")
                        }
                    }

                    var a = this;
                    n && (t.loadErrorHandler = n);
                    try {
                        var o = this.getCORSInstance();
                        o.open("get", t.corsUrl + "&ts=" + (new Date).getTime(), !0), "XMLHttpRequest" === this.corsMetadata.corsType && (o.withCredentials = !0, o.timeout = e.loadTimeout, o.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), o.onreadystatechange = function () {
                            4 === this.readyState && 200 === this.status && r(this.responseText)
                        }), o.onerror = function (e) {
                            a.handleCORSError(t, e, "onerror")
                        }, o.ontimeout = function (e) {
                            a.handleCORSError(t, e, "ontimeout")
                        }, o.send(), e._log.requests.push(t.corsUrl)
                    } catch (e) {
                        this.handleCORSError(t, e, "try-catch")
                    }
                }, handleCORSError: function (t, n, i) {
                    e.CORSErrors.push({corsData: t, error: n, description: i}), t.loadErrorHandler && ("ontimeout" === i ? t.loadErrorHandler(!0) : t.loadErrorHandler(!1))
                }
            }
        }, te = {POST_MESSAGE_ENABLED: !!m.postMessage, DAYS_BETWEEN_SYNC_ID_CALLS: 1, MILLIS_PER_DAY: 864e5, ADOBE_MC: "adobe_mc", ADOBE_MC_SDID: "adobe_mc_sdid", VALID_VISITOR_ID_REGEX: /^[0-9a-fA-F\-]+$/, ADOBE_MC_TTL_IN_MIN: 5, VERSION_REGEX: /vVersion\|((\d+\.)?(\d+\.)?(\*|\d+))(?=$|\|)/},
        ne = function (e, t) {
            var n = m.document;
            return {
                THROTTLE_START: 3e4,
                MAX_SYNCS_LENGTH: 649,
                throttleTimerSet: !1,
                id: null,
                onPagePixels: [],
                iframeHost: null,
                getIframeHost: function (e) {
                    if ("string" == typeof e) {
                        var t = e.split("/");
                        return t[0] + "//" + t[2]
                    }
                },
                subdomain: null,
                url: null,
                getUrl: function () {
                    var t, i = "http://fast.", r = "?d_nsid=" + e.idSyncContainerID + "#" + encodeURIComponent(n.location.origin);
                    return this.subdomain || (this.subdomain = "nosubdomainreturned"), e.loadSSL && (i = e.idSyncSSLUseAkamai ? "https://fast." : "https://"), t = i + this.subdomain + ".demdex.net/dest5.html" + r, this.iframeHost = this.getIframeHost(t), this.id = "destination_publishing_iframe_" + this.subdomain + "_" + e.idSyncContainerID, t
                },
                checkDPIframeSrc: function () {
                    var t = "?d_nsid=" + e.idSyncContainerID + "#" + encodeURIComponent(n.location.href);
                    "string" == typeof e.dpIframeSrc && e.dpIframeSrc.length && (this.id = "destination_publishing_iframe_" + (e._subdomain || this.subdomain || (new Date).getTime()) + "_" + e.idSyncContainerID, this.iframeHost = this.getIframeHost(e.dpIframeSrc), this.url = e.dpIframeSrc + t)
                },
                idCallNotProcesssed: null,
                doAttachIframe: !1,
                startedAttachingIframe: !1,
                iframeHasLoaded: null,
                iframeIdChanged: null,
                newIframeCreated: null,
                originalIframeHasLoadedAlready: null,
                iframeLoadedCallbacks: [],
                regionChanged: !1,
                timesRegionChanged: 0,
                sendingMessages: !1,
                messages: [],
                messagesPosted: [],
                messagesReceived: [],
                messageSendingInterval: te.POST_MESSAGE_ENABLED ? null : 100,
                jsonForComparison: [],
                jsonDuplicates: [],
                jsonWaiting: [],
                jsonProcessed: [],
                canSetThirdPartyCookies: !0,
                receivedThirdPartyCookiesNotification: !1,
                readyToAttachIframePreliminary: function () {
                    return !(e.idSyncDisableSyncs || e.disableIdSyncs || e.idSyncDisable3rdPartySyncing || e.disableThirdPartyCookies || e.disableThirdPartyCalls)
                },
                readyToAttachIframe: function () {
                    return this.readyToAttachIframePreliminary() && (this.doAttachIframe || e._doAttachIframe) && (this.subdomain && "nosubdomainreturned" !== this.subdomain || e._subdomain) && this.url && !this.startedAttachingIframe
                },
                attachIframe: function () {
                    function e() {
                        r = n.createElement("iframe"), r.sandbox = "allow-scripts allow-same-origin", r.title = "Adobe ID Syncing iFrame", r.id = i.id, r.name = i.id + "_name", r.style.cssText = "display: none; width: 0; height: 0;", r.src = i.url, i.newIframeCreated = !0, t(), n.body.appendChild(r)
                    }

                    function t(e) {
                        r.addEventListener("load", function () {
                            r.className = "aamIframeLoaded", i.iframeHasLoaded = !0, i.fireIframeLoadedCallbacks(e), i.requestToProcess()
                        })
                    }

                    this.startedAttachingIframe = !0;
                    var i = this, r = n.getElementById(this.id);
                    r ? "IFRAME" !== r.nodeName ? (this.id += "_2", this.iframeIdChanged = !0, e()) : (this.newIframeCreated = !1, "aamIframeLoaded" !== r.className ? (this.originalIframeHasLoadedAlready = !1, t("The destination publishing iframe already exists from a different library, but hadn't loaded yet.")) : (this.originalIframeHasLoadedAlready = !0, this.iframeHasLoaded = !0, this.iframe = r, this.fireIframeLoadedCallbacks("The destination publishing iframe already exists from a different library, and had loaded alresady."), this.requestToProcess())) : e(), this.iframe = r
                },
                fireIframeLoadedCallbacks: function (e) {
                    this.iframeLoadedCallbacks.forEach(function (t) {
                        "function" == typeof t && t({message: e || "The destination publishing iframe was attached and loaded successfully."})
                    }), this.iframeLoadedCallbacks = []
                },
                requestToProcess: function (t) {
                    function n() {
                        r.jsonForComparison.push(t), r.jsonWaiting.push(t), r.processSyncOnPage(t)
                    }

                    var i, r = this;
                    if (t === Object(t) && t.ibs) if (i = JSON.stringify(t.ibs || []), this.jsonForComparison.length) {
                        var a, o, s, l = !1;
                        for (a = 0, o = this.jsonForComparison.length; a < o; a++) if (s = this.jsonForComparison[a], i === JSON.stringify(s.ibs || [])) {
                            l = !0;
                            break
                        }
                        l ? this.jsonDuplicates.push(t) : n()
                    } else n();
                    if ((this.receivedThirdPartyCookiesNotification || !te.POST_MESSAGE_ENABLED || this.iframeHasLoaded) && this.jsonWaiting.length) {
                        var c = this.jsonWaiting.shift();
                        this.process(c), this.requestToProcess()
                    }
                    e.idSyncDisableSyncs || e.disableIdSyncs || !this.iframeHasLoaded || !this.messages.length || this.sendingMessages || (this.throttleTimerSet || (this.throttleTimerSet = !0, setTimeout(function () {
                        r.messageSendingInterval = te.POST_MESSAGE_ENABLED ? null : 150
                    }, this.THROTTLE_START)), this.sendingMessages = !0, this.sendMessages())
                },
                getRegionAndCheckIfChanged: function (t, n) {
                    var i = e._getField("MCAAMLH"), r = t.d_region || t.dcs_region;
                    return i ? r && (e._setFieldExpire("MCAAMLH", n), e._setField("MCAAMLH", r), parseInt(i, 10) !== r && (this.regionChanged = !0, this.timesRegionChanged++, e._setField("MCSYNCSOP", ""), e._setField("MCSYNCS", ""), i = r)) : (i = r) && (e._setFieldExpire("MCAAMLH", n), e._setField("MCAAMLH", i)), i || (i = ""), i
                },
                processSyncOnPage: function (e) {
                    var t, n, i, r;
                    if ((t = e.ibs) && t instanceof Array && (n = t.length)) for (i = 0; i < n; i++) r = t[i], r.syncOnPage && this.checkFirstPartyCookie(r, "", "syncOnPage")
                },
                process: function (e) {
                    var t, n, i, r, a, o = encodeURIComponent, s = !1;
                    if ((t = e.ibs) && t instanceof Array && (n = t.length)) for (s = !0, i = 0; i < n; i++) r = t[i], a = [o("ibs"), o(r.id || ""), o(r.tag || ""), F.encodeAndBuildRequest(r.url || [], ","), o(r.ttl || ""), "", "", r.fireURLSync ? "true" : "false"], r.syncOnPage || (this.canSetThirdPartyCookies ? this.addMessage(a.join("|")) : r.fireURLSync && this.checkFirstPartyCookie(r, a.join("|")));
                    s && this.jsonProcessed.push(e)
                },
                checkFirstPartyCookie: function (t, n, i) {
                    var r = "syncOnPage" === i, a = r ? "MCSYNCSOP" : "MCSYNCS";
                    e._readVisitor();
                    var o, s, l = e._getField(a), c = !1, u = !1, d = Math.ceil((new Date).getTime() / te.MILLIS_PER_DAY);
                    l ? (o = l.split("*"), s = this.pruneSyncData(o, t.id, d), c = s.dataPresent, u = s.dataValid, c && u || this.fireSync(r, t, n, o, a, d)) : (o = [], this.fireSync(r, t, n, o, a, d))
                },
                pruneSyncData: function (e, t, n) {
                    var i, r, a, o = !1, s = !1;
                    for (r = 0; r < e.length; r++) i = e[r], a = parseInt(i.split("-")[1], 10), i.match("^" + t + "-") ? (o = !0, n < a ? s = !0 : (e.splice(r, 1), r--)) : n >= a && (e.splice(r, 1), r--);
                    return {dataPresent: o, dataValid: s}
                },
                manageSyncsSize: function (e) {
                    if (e.join("*").length > this.MAX_SYNCS_LENGTH) for (e.sort(function (e, t) {
                        return parseInt(e.split("-")[1], 10) - parseInt(t.split("-")[1], 10)
                    }); e.join("*").length > this.MAX_SYNCS_LENGTH;) e.shift()
                },
                fireSync: function (t, n, i, r, a, o) {
                    var s = this;
                    if (t) {
                        if ("img" === n.tag) {
                            var l, c, u, d, f = n.url, g = e.loadSSL ? "https:" : "http:";
                            for (l = 0, c = f.length; l < c; l++) {
                                u = f[l], d = /^\/\//.test(u);
                                var p = new Image;
                                p.addEventListener("load", function (t, n, i, r) {
                                    return function () {
                                        s.onPagePixels[t] = null, e._readVisitor();
                                        var o, l = e._getField(a), c = [];
                                        if (l) {
                                            o = l.split("*");
                                            var u, d, f;
                                            for (u = 0, d = o.length; u < d; u++) f = o[u], f.match("^" + n.id + "-") || c.push(f)
                                        }
                                        s.setSyncTrackingData(c, n, i, r)
                                    }
                                }(this.onPagePixels.length, n, a, o)), p.src = (d ? g : "") + u, this.onPagePixels.push(p)
                            }
                        }
                    } else this.addMessage(i), this.setSyncTrackingData(r, n, a, o)
                },
                addMessage: function (t) {
                    var n = encodeURIComponent, i = n(e._enableErrorReporting ? "---destpub-debug---" : "---destpub---");
                    this.messages.push((te.POST_MESSAGE_ENABLED ? "" : i) + t)
                },
                setSyncTrackingData: function (t, n, i, r) {
                    t.push(n.id + "-" + (r + Math.ceil(n.ttl / 60 / 24))), this.manageSyncsSize(t), e._setField(i, t.join("*"))
                },
                sendMessages: function () {
                    var e, t = this, n = "", i = encodeURIComponent;
                    this.regionChanged && (n = i("---destpub-clear-dextp---"), this.regionChanged = !1), this.messages.length ? te.POST_MESSAGE_ENABLED ? (e = n + i("---destpub-combined---") + this.messages.join("%01"), this.postMessage(e), this.messages = [], this.sendingMessages = !1) : (e = this.messages.shift(), this.postMessage(n + e), setTimeout(function () {
                        t.sendMessages()
                    }, this.messageSendingInterval)) : this.sendingMessages = !1
                },
                postMessage: function (e) {
                    $.postMessage(e, this.url, this.iframe.contentWindow), this.messagesPosted.push(e)
                },
                receiveMessage: function (e) {
                    var t, n = /^---destpub-to-parent---/;
                    "string" == typeof e && n.test(e) && (t = e.replace(n, "").split("|"), "canSetThirdPartyCookies" === t[0] && (this.canSetThirdPartyCookies = "true" === t[1], this.receivedThirdPartyCookiesNotification = !0, this.requestToProcess()), this.messagesReceived.push(e))
                },
                processIDCallData: function (i) {
                    (null == this.url || i.subdomain && "nosubdomainreturned" === this.subdomain) && ("string" == typeof e._subdomain && e._subdomain.length ? this.subdomain = e._subdomain : this.subdomain = i.subdomain || "", this.url = this.getUrl()), i.ibs instanceof Array && i.ibs.length && (this.doAttachIframe = !0), this.readyToAttachIframe() && (e.idSyncAttachIframeOnWindowLoad ? (t.windowLoaded || "complete" === n.readyState || "loaded" === n.readyState) && this.attachIframe() : this.attachIframeASAP()), "function" == typeof e.idSyncIDCallResult ? e.idSyncIDCallResult(i) : this.requestToProcess(i), "function" == typeof e.idSyncAfterIDCallResult && e.idSyncAfterIDCallResult(i)
                },
                canMakeSyncIDCall: function (t, n) {
                    return e._forceSyncIDCall || !t || n - t > te.DAYS_BETWEEN_SYNC_ID_CALLS
                },
                attachIframeASAP: function () {
                    function e() {
                        t.startedAttachingIframe || (n.body ? t.attachIframe() : setTimeout(e, 30))
                    }

                    var t = this;
                    e()
                }
            }
        }, ie = {
            audienceManagerServer: {},
            audienceManagerServerSecure: {},
            cookieDomain: {},
            cookieLifetime: {},
            cookieName: {},
            doesOptInApply: {},
            disableThirdPartyCalls: {},
            idSyncAfterIDCallResult: {},
            idSyncAttachIframeOnWindowLoad: {},
            idSyncContainerID: {},
            idSyncDisable3rdPartySyncing: {},
            disableThirdPartyCookies: {},
            idSyncDisableSyncs: {},
            disableIdSyncs: {},
            idSyncIDCallResult: {},
            idSyncSSLUseAkamai: {},
            isCoopSafe: {},
            isIabContext: {},
            isOptInStorageEnabled: {},
            loadSSL: {},
            loadTimeout: {},
            marketingCloudServer: {},
            marketingCloudServerSecure: {},
            optInCookieDomain: {},
            optInStorageExpiry: {},
            overwriteCrossDomainMCIDAndAID: {},
            preOptInApprovals: {},
            previousPermissions: {},
            resetBeforeVersion: {},
            sdidParamExpiry: {},
            serverState: {},
            sessionCookieName: {},
            secureCookie: {},
            takeTimeoutMetrics: {},
            trackingServer: {},
            trackingServerSecure: {},
            whitelistIframeDomains: {},
            whitelistParentDomain: {}
        }, re = {
            getConfigNames: function () {
                return Object.keys(ie)
            }, getConfigs: function () {
                return ie
            }, normalizeConfig: function (e) {
                return "function" != typeof e ? e : e()
            }
        }, ae = function (e) {
            var t = {};
            return e.on = function (e, n, i) {
                if (!n || "function" != typeof n) throw new Error("[ON] Callback should be a function.");
                t.hasOwnProperty(e) || (t[e] = []);
                var r = t[e].push({callback: n, context: i}) - 1;
                return function () {
                    t[e].splice(r, 1), t[e].length || delete t[e]
                }
            }, e.publish = function (e) {
                if (t.hasOwnProperty(e)) {
                    var n = [].slice.call(arguments, 1);
                    t[e].slice(0).forEach(function (e) {
                        e.callback.apply(e.context, n)
                    })
                }
            }, e.publish
        }, oe = {PENDING: "pending", CHANGED: "changed", COMPLETE: "complete"}, se = {AAM: "aam", ADCLOUD: "adcloud", ANALYTICS: "aa", CAMPAIGN: "campaign", ECID: "ecid", LIVEFYRE: "livefyre", TARGET: "target", VIDEO_ANALYTICS: "videoaa"}, le = (h = {}, t(h, se.AAM, 565), t(h, se.ECID, 565), h),
        ce = (_ = {}, t(_, se.AAM, [1, 2, 5]), t(_, se.ECID, [1, 2, 5]), _), ue = function (e) {
            return Object.keys(e).map(function (t) {
                return e[t]
            })
        }(se), de = function () {
            var e = {};
            return e.callbacks = Object.create(null), e.add = function (t, n) {
                if (!l(n)) throw new Error("[callbackRegistryFactory] Make sure callback is a function or an array of functions.");
                e.callbacks[t] = e.callbacks[t] || [];
                var i = e.callbacks[t].push(n) - 1;
                return function () {
                    e.callbacks[t].splice(i, 1)
                }
            }, e.execute = function (t, n) {
                if (e.callbacks[t]) {
                    n = void 0 === n ? [] : n, n = n instanceof Array ? n : [n];
                    try {
                        for (; e.callbacks[t].length;) {
                            var i = e.callbacks[t].shift();
                            "function" == typeof i ? i.apply(null, n) : i instanceof Array && i[1].apply(i[0], n)
                        }
                        delete e.callbacks[t]
                    } catch (e) {
                    }
                }
            }, e.executeAll = function (t, n) {
                (n || t && !s(t)) && Object.keys(e.callbacks).forEach(function (n) {
                    var i = void 0 !== t[n] ? t[n] : "";
                    e.execute(n, i)
                }, e)
            }, e.hasCallbacks = function () {
                return Boolean(Object.keys(e.callbacks).length)
            }, e
        }, fe = function (t, n) {
            return e(t) === n
        }, ge = function (e, t) {
            return e instanceof Array ? e : fe(e, "string") ? [e] : t || []
        }, pe = function (e) {
            var t = Object.keys(e);
            return !!t.length && t.every(function (t) {
                return !0 === e[t]
            })
        }, me = function (e) {
            return !(!e || Ce(e)) && ge(e).every(function (e) {
                return ue.indexOf(e) > -1
            })
        }, he = function (e, t) {
            return e.reduce(function (e, n) {
                return e[n] = t, e
            }, {})
        }, _e = function (e) {
            return JSON.parse(JSON.stringify(e))
        }, Ce = function (e) {
            return "[object Array]" === Object.prototype.toString.call(e) && !e.length
        }, Ie = function (e) {
            if (Se(e)) return e;
            try {
                return JSON.parse(e)
            } catch (e) {
                return {}
            }
        }, ve = function (e) {
            return void 0 === e || (Se(e) ? me(Object.keys(e)) : De(e))
        }, De = function (e) {
            try {
                var t = JSON.parse(e);
                return !!e && fe(e, "string") && me(Object.keys(t))
            } catch (e) {
                return !1
            }
        }, Se = function (e) {
            return null !== e && fe(e, "object") && !1 === Array.isArray(e)
        }, be = function () {
        }, Ae = function (e) {
            return fe(e, "function") ? e() : e
        }, ye = function (e, t) {
            if (!ve(e)) throw new Error("[OptIn] ".concat(t))
        }, Oe = function (e) {
            return Object.keys(e).map(function (t) {
                return e[t]
            })
        }, Me = function (e) {
            return Oe(e).filter(function (e, t, n) {
                return n.indexOf(e) === t
            })
        }, ke = function (e) {
            return function () {
                var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, n = t.command, i = t.params, r = void 0 === i ? {} : i, a = t.callback, o = void 0 === a ? be : a;
                if (!n || -1 === n.indexOf(".")) throw new Error("[OptIn.execute] Please provide a valid command.");
                try {
                    var s = n.split("."), l = e[s[0]], c = s[1];
                    if (!l || "function" != typeof l[c]) throw new Error("Make sure the plugin and API name exist.");
                    var u = Object.assign(r, {callback: o});
                    l[c].call(l, u)
                } catch (e) {
                    throw new Error("[OptIn.execute] Something went wrong: " + e.message)
                }
            }
        };
    u.prototype = Object.create(Error.prototype), u.prototype.constructor = u;
    var Ee = "fetchPermissions", Te = "[OptIn#registerPlugin] Plugin is invalid.";
    d.Categories = se, d.TimeoutError = u;
    var Le = function () {
        throw new Error("[IAB Plugin] A __cmp is required.")
    }, Pe = Object.freeze({OptIn: d, IabPlugin: g}), Re = {
        get: function (e) {
            e = encodeURIComponent(e);
            var t = (";" + document.cookie).split(" ").join(";"), n = t.indexOf(";" + e + "="), i = n < 0 ? n : t.indexOf(";", n + 1);
            return n < 0 ? "" : decodeURIComponent(t.substring(n + 2 + e.length, i < 0 ? t.length : i))
        }, set: function (e, t, n) {
            var i = p(n, "cookieLifetime"), r = p(n, "expires"), a = p(n, "domain");
            if (r && "SESSION" !== i && "NONE" !== i) {
                var o = "" !== t ? parseInt(i || 0, 10) : -60;
                if (o) r = new Date, r.setTime(r.getTime() + 1e3 * o); else if (1 === r) {
                    r = new Date;
                    var s = r.getYear();
                    r.setYear(s + 2 + (s < 1900 ? 1900 : 0))
                }
            } else r = 0;
            return e && "NONE" !== i ? (document.cookie = encodeURIComponent(e) + "=" + encodeURIComponent(t) + "; path=/;" + (r ? " expires=" + r.toGMTString() + ";" : "") + (a ? " domain=" + a + ";" : ""), this.get(e) === t) : 0
        }, remove: function (e, t) {
            var n = p(t, "domain");
            n = n ? " domain=" + n + ";" : "", document.cookie = encodeURIComponent(e) + "=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;" + n
        }
    }, we = Pe.OptIn;
    F.defineGlobalNamespace(), window.adobe.OptInCategories = we.Categories;
    var xe = function (t, n, i) {
        function r(e) {
            var t = e;
            return function (e) {
                var n = e || h.location.href;
                try {
                    var i = d._extractParamFromUri(n, t);
                    if (i) return T.parsePipeDelimetedKeyValues(i)
                } catch (e) {
                }
            }
        }

        function a(e) {
            function t(e, t) {
                e && e.match(te.VALID_VISITOR_ID_REGEX) && t(e)
            }

            t(e[I], d.setMarketingCloudVisitorID), d._setFieldExpire(A, -1), t(e[S], d.setAnalyticsVisitorID)
        }

        function o(e) {
            e = e || {}, d._supplementalDataIDCurrent = e.supplementalDataIDCurrent || "", d._supplementalDataIDCurrentConsumed = e.supplementalDataIDCurrentConsumed || {}, d._supplementalDataIDLast = e.supplementalDataIDLast || "", d._supplementalDataIDLastConsumed = e.supplementalDataIDLastConsumed || {}
        }

        function s(e) {
            function t(e, t, n) {
                return n = n ? n += "|" : n, n += e + "=" + encodeURIComponent(t)
            }

            function n(e, n) {
                var i = n[0], r = n[1];
                return null != r && r !== y && (e = t(i, r, e)), e
            }

            var i = e.reduce(n, "");
            return function (e) {
                var t = T.getTimestampInSeconds();
                return e = e ? e += "|" : e, e += "TS=" + t
            }(i)
        }

        function l(e) {
            var t = e.minutesToLive, n = ""
            ;
            return (d.idSyncDisableSyncs || d.disableIdSyncs) && (n = n || "Error: id syncs have been disabled"), "string" == typeof e.dpid && e.dpid.length || (n = n || "Error: config.dpid is empty"), "string" == typeof e.url && e.url.length || (n = n || "Error: config.url is empty"), void 0 === t ? t = 20160 : (t = parseInt(t, 10), (isNaN(t) || t <= 0) && (n = n || "Error: config.minutesToLive needs to be a positive number")), {
                error: n,
                ttl: t
            }
        }

        function c() {
            return !(!d.configs.doesOptInApply || f.optIn.isComplete || u())
        }

        function u() {
            return d.configs.isIabContext ? f.optIn.isApproved(f.optIn.Categories.ECID) && p : f.optIn.isApproved(f.optIn.Categories.ECID)
        }

        if (!i || i.split("").reverse().join("") !== t) throw new Error("Please use `Visitor.getInstance` to instantiate Visitor.");
        var d = this, f = window.adobe, g = "", p = !1;
        d.version = "4.0.0";
        var h = m, _ = h.Visitor;
        _.version = d.version, _.AuthState = M.AUTH_STATE, _.OptOut = M.OPT_OUT, h.s_c_in || (h.s_c_il = [], h.s_c_in = 0), d._c = "Visitor", d._il = h.s_c_il, d._in = h.s_c_in, d._il[d._in] = d, h.s_c_in++, d._instanceType = "regular", d._log = {requests: []}, d.marketingCloudOrgID = t, d.cookieName = "AMCV_" + t, d.sessionCookieName = "AMCVS_" + t, d.cookieDomain = J(), d.cookieDomain === h.location.hostname && (d.cookieDomain = ""), d.loadSSL = h.location.protocol.toLowerCase().indexOf("https") >= 0, d.loadTimeout = 3e4, d.CORSErrors = [], d.marketingCloudServer = d.audienceManagerServer = "dpm.demdex.net", d.sdidParamExpiry = 30;
        var C = null, I = "MCMID", v = "MCIDTS", D = "A", S = "MCAID", b = "AAM", A = "MCAAMB", y = "NONE", O = function (e) {
            return !Object.prototype[e]
        }, k = ee(d);
        d.FIELDS = M.FIELDS, d.cookieRead = function (e) {
            return Re.get(e)
        }, d.cookieWrite = function (e, t, n) {
            var i = d.cookieLifetime ? ("" + d.cookieLifetime).toUpperCase() : "";
            return Re.set(e, "" + t, {expires: n, domain: d.cookieDomain, cookieLifetime: i})
        }, d.resetState = function (e) {
            e ? d._mergeServerState(e) : o()
        }, d._isAllowedDone = !1, d._isAllowedFlag = !1, d.isAllowed = function () {
            return d._isAllowedDone || (d._isAllowedDone = !0, (d.cookieRead(d.cookieName) || d.cookieWrite(d.cookieName, "T", 1)) && (d._isAllowedFlag = !0)), "T" === d.cookieRead(d.cookieName) && d._helpers.removeCookie(d.cookieName), d._isAllowedFlag
        }, d.setMarketingCloudVisitorID = function (e) {
            d._setMarketingCloudFields(e)
        }, d._use1stPartyMarketingCloudServer = !1, d.getMarketingCloudVisitorID = function (e, t) {
            d.marketingCloudServer && d.marketingCloudServer.indexOf(".demdex.net") < 0 && (d._use1stPartyMarketingCloudServer = !0);
            var n = d._getAudienceManagerURLData("_setMarketingCloudFields"), i = n.url;
            return d._getRemoteField(I, i, e, t, n)
        }, d.getVisitorValues = function (e, t) {
            var n = {
                MCMID: {fn: d.getMarketingCloudVisitorID, args: [!0], context: d},
                MCOPTOUT: {fn: d.isOptedOut, args: [void 0, !0], context: d},
                MCAID: {fn: d.getAnalyticsVisitorID, args: [!0], context: d},
                MCAAMLH: {fn: d.getAudienceManagerLocationHint, args: [!0], context: d},
                MCAAMB: {fn: d.getAudienceManagerBlob, args: [!0], context: d}
            }, i = t && t.length ? F.pluck(n, t) : n;
            W(i, e)
        }, d._currentCustomerIDs = {}, d._customerIDsHashChanged = !1, d._newCustomerIDsHash = "", d.setCustomerIDs = function (t) {
            function n() {
                d._customerIDsHashChanged = !1
            }

            if (t) {
                if (!F.isObject(t) || F.isObjectEmpty(t)) return !1;
                d._readVisitor();
                var i, r;
                for (i in t) if (O(i) && (r = t[i])) if ("object" === e(r)) {
                    var a = {};
                    r.id && (a.id = r.id), void 0 != r.authState && (a.authState = r.authState), d._currentCustomerIDs[i] = a
                } else d._currentCustomerIDs[i] = {id: r};
                var o = d.getCustomerIDs(), s = d._getField("MCCIDH"), l = "";
                s || (s = 0);
                for (i in o) O(i) && (r = o[i], l += (l ? "|" : "") + i + "|" + (r.id ? r.id : "") + (r.authState ? r.authState : ""));
                d._newCustomerIDsHash = String(d._hash(l)), d._newCustomerIDsHash !== s && (d._customerIDsHashChanged = !0, d._mapCustomerIDs(n))
            }
        }, d.getCustomerIDs = function () {
            d._readVisitor();
            var e, t, n = {};
            for (e in d._currentCustomerIDs) O(e) && (t = d._currentCustomerIDs[e], n[e] || (n[e] = {}), t.id && (n[e].id = t.id), void 0 != t.authState ? n[e].authState = t.authState : n[e].authState = _.AuthState.UNKNOWN);
            return n
        }, d.setAnalyticsVisitorID = function (e) {
            d._setAnalyticsFields(e)
        }, d.getAnalyticsVisitorID = function (e, t, n) {
            if (!T.isTrackingServerPopulated() && !n) return d._callCallback(e, [""]), "";
            var i = "";
            if (n || (i = d.getMarketingCloudVisitorID(function (t) {
                d.getAnalyticsVisitorID(e, !0)
            })), i || n) {
                var r = n ? d.marketingCloudServer : d.trackingServer, a = "";
                d.loadSSL && (n ? d.marketingCloudServerSecure && (r = d.marketingCloudServerSecure) : d.trackingServerSecure && (r = d.trackingServerSecure));
                var o = {};
                if (r) {
                    var s = "http" + (d.loadSSL ? "s" : "") + "://" + r + "/id",
                        l = "d_visid_ver=" + d.version + "&mcorgid=" + encodeURIComponent(d.marketingCloudOrgID) + (i ? "&mid=" + encodeURIComponent(i) : "") + (d.idSyncDisable3rdPartySyncing || d.disableThirdPartyCookies ? "&d_coppa=true" : ""),
                        c = ["s_c_il", d._in, "_set" + (n ? "MarketingCloud" : "Analytics") + "Fields"];
                    a = s + "?" + l + "&callback=s_c_il%5B" + d._in + "%5D._set" + (n ? "MarketingCloud" : "Analytics") + "Fields", o.corsUrl = s + "?" + l, o.callback = c
                }
                return o.url = a, d._getRemoteField(n ? I : S, a, e, t, o)
            }
            return ""
        }, d.getAudienceManagerLocationHint = function (e, t) {
            if (d.getMarketingCloudVisitorID(function (t) {
                d.getAudienceManagerLocationHint(e, !0)
            })) {
                var n = d._getField(S);
                if (!n && T.isTrackingServerPopulated() && (n = d.getAnalyticsVisitorID(function (t) {
                    d.getAudienceManagerLocationHint(e, !0)
                })), n || !T.isTrackingServerPopulated()) {
                    var i = d._getAudienceManagerURLData(), r = i.url;
                    return d._getRemoteField("MCAAMLH", r, e, t, i)
                }
            }
            return ""
        }, d.getLocationHint = d.getAudienceManagerLocationHint, d.getAudienceManagerBlob = function (e, t) {
            if (d.getMarketingCloudVisitorID(function (t) {
                d.getAudienceManagerBlob(e, !0)
            })) {
                var n = d._getField(S);
                if (!n && T.isTrackingServerPopulated() && (n = d.getAnalyticsVisitorID(function (t) {
                    d.getAudienceManagerBlob(e, !0)
                })), n || !T.isTrackingServerPopulated()) {
                    var i = d._getAudienceManagerURLData(), r = i.url;
                    return d._customerIDsHashChanged && d._setFieldExpire(A, -1), d._getRemoteField(A, r, e, t, i)
                }
            }
            return ""
        }, d._supplementalDataIDCurrent = "", d._supplementalDataIDCurrentConsumed = {}, d._supplementalDataIDLast = "", d._supplementalDataIDLastConsumed = {}, d.getSupplementalDataID = function (e, t) {
            d._supplementalDataIDCurrent || t || (d._supplementalDataIDCurrent = d._generateID(1));
            var n = d._supplementalDataIDCurrent;
            return d._supplementalDataIDLast && !d._supplementalDataIDLastConsumed[e] ? (n = d._supplementalDataIDLast, d._supplementalDataIDLastConsumed[e] = !0) : n && (d._supplementalDataIDCurrentConsumed[e] && (d._supplementalDataIDLast = d._supplementalDataIDCurrent, d._supplementalDataIDLastConsumed = d._supplementalDataIDCurrentConsumed, d._supplementalDataIDCurrent = n = t ? "" : d._generateID(1), d._supplementalDataIDCurrentConsumed = {}), n && (d._supplementalDataIDCurrentConsumed[e] = !0)), n
        };
        var E = !1;
        d._liberatedOptOut = null, d.getOptOut = function (e, t) {
            var n = d._getAudienceManagerURLData("_setMarketingCloudFields"), i = n.url;
            if (u()) return d._getRemoteField("MCOPTOUT", i, e, t, n);
            if (d._registerCallback("liberatedOptOut", e), null !== d._liberatedOptOut) return d._callAllCallbacks("liberatedOptOut", [d._liberatedOptOut]), E = !1, d._liberatedOptOut;
            if (E) return null;
            E = !0;
            var r = "liberatedGetOptOut";
            return n.corsUrl = n.corsUrl.replace(/dpm\.demdex\.net\/id\?/, "dpm.demdex.net/optOutStatus?"), n.callback = [r], m[r] = function (e) {
                if (e === Object(e)) {
                    var t, n, i = F.parseOptOut(e, t, y);
                    t = i.optOut, n = 1e3 * i.d_ottl, d._liberatedOptOut = t, setTimeout(function () {
                        d._liberatedOptOut = null
                    }, n)
                }
                d._callAllCallbacks("liberatedOptOut", [t]), E = !1
            }, k.fireCORS(n), null
        }, d.isOptedOut = function (e, t, n) {
            t || (t = _.OptOut.GLOBAL);
            var i = d.getOptOut(function (n) {
                var i = n === _.OptOut.GLOBAL || n.indexOf(t) >= 0;
                d._callCallback(e, [i])
            }, n);
            return i ? i === _.OptOut.GLOBAL || i.indexOf(t) >= 0 : null
        }, d._fields = null, d._fieldsExpired = null, d._hash = function (e) {
            var t, n, i = 0;
            if (e) for (t = 0; t < e.length; t++) n = e.charCodeAt(t), i = (i << 5) - i + n, i &= i;
            return i
        }, d._generateID = Z, d._generateLocalMID = function () {
            var e = d._generateID(0);
            return P.isClientSideMarketingCloudVisitorID = !0, e
        }, d._callbackList = null, d._callCallback = function (e, t) {
            try {
                "function" == typeof e ? e.apply(h, t) : e[1].apply(e[0], t)
            } catch (e) {
            }
        }, d._registerCallback = function (e, t) {
            t && (null == d._callbackList && (d._callbackList = {}), void 0 == d._callbackList[e] && (d._callbackList[e] = []), d._callbackList[e].push(t))
        }, d._callAllCallbacks = function (e, t) {
            if (null != d._callbackList) {
                var n = d._callbackList[e];
                if (n) for (; n.length > 0;) d._callCallback(n.shift(), t)
            }
        }, d._addQuerystringParam = function (e, t, n, i) {
            var r = encodeURIComponent(t) + "=" + encodeURIComponent(n), a = T.parseHash(e), o = T.hashlessUrl(e);
            if (-1 === o.indexOf("?")) return o + "?" + r + a;
            var s = o.split("?"), l = s[0] + "?", c = s[1];
            return l + T.addQueryParamAtLocation(c, r, i) + a
        }, d._extractParamFromUri = function (e, t) {
            var n = new RegExp("[\\?&#]" + t + "=([^&#]*)"), i = n.exec(e);
            if (i && i.length) return decodeURIComponent(i[1])
        }, d._parseAdobeMcFromUrl = r(te.ADOBE_MC), d._parseAdobeMcSdidFromUrl = r(te.ADOBE_MC_SDID), d._attemptToPopulateSdidFromUrl = function (e) {
            var n = d._parseAdobeMcSdidFromUrl(e), i = 1e9;
            n && n.TS && (i = T.getTimestampInSeconds() - n.TS), n && n.SDID && n.MCORGID === t && i < d.sdidParamExpiry && (d._supplementalDataIDCurrent = n.SDID, d._supplementalDataIDCurrentConsumed.SDID_URL_PARAM = !0)
        }, d._attemptToPopulateIdsFromUrl = function () {
            var e = d._parseAdobeMcFromUrl();
            if (e && e.TS) {
                var n = T.getTimestampInSeconds(), i = n - e.TS;
                if (Math.floor(i / 60) > te.ADOBE_MC_TTL_IN_MIN || e.MCORGID !== t) return;
                a(e)
            }
        }, d._mergeServerState = function (e) {
            if (e) try {
                if (e = function (e) {
                    return T.isObject(e) ? e : JSON.parse(e)
                }(e), e[d.marketingCloudOrgID]) {
                    var t = e[d.marketingCloudOrgID];
                    !function (e) {
                        T.isObject(e) && d.setCustomerIDs(e)
                    }(t.customerIDs), o(t.sdid)
                }
            } catch (e) {
                throw new Error("`serverState` has an invalid format.")
            }
        }, d._timeout = null, d._loadData = function (e, t, n, i) {
            t = d._addQuerystringParam(t, "d_fieldgroup", e, 1), i.url = d._addQuerystringParam(i.url, "d_fieldgroup", e, 1), i.corsUrl = d._addQuerystringParam(i.corsUrl, "d_fieldgroup", e, 1), P.fieldGroupObj[e] = !0, i === Object(i) && i.corsUrl && "XMLHttpRequest" === k.corsMetadata.corsType && k.fireCORS(i, n, e)
        }, d._clearTimeout = function (e) {
            null != d._timeout && d._timeout[e] && (clearTimeout(d._timeout[e]), d._timeout[e] = 0)
        }, d._settingsDigest = 0, d._getSettingsDigest = function () {
            if (!d._settingsDigest) {
                var e = d.version;
                d.audienceManagerServer && (e += "|" + d.audienceManagerServer), d.audienceManagerServerSecure && (e += "|" + d.audienceManagerServerSecure), d._settingsDigest = d._hash(e)
            }
            return d._settingsDigest
        }, d._readVisitorDone = !1, d._readVisitor = function () {
            if (!d._readVisitorDone) {
                d._readVisitorDone = !0;
                var e, t, n, i, r, a, o = d._getSettingsDigest(), s = !1, l = d.cookieRead(d.cookieName), c = new Date;
                if (null == d._fields && (d._fields = {}), l && "T" !== l) for (l = l.split("|"), l[0].match(/^[\-0-9]+$/) && (parseInt(l[0], 10) !== o && (s = !0), l.shift()), l.length % 2 == 1 && l.pop(), e = 0; e < l.length; e += 2) t = l[e].split("-"), n = t[0], i = l[e + 1], t.length > 1 ? (r = parseInt(t[1], 10), a = t[1].indexOf("s") > 0) : (r = 0, a = !1), s && ("MCCIDH" === n && (i = ""), r > 0 && (r = c.getTime() / 1e3 - 60)), n && i && (d._setField(n, i, 1), r > 0 && (d._fields["expire" + n] = r + (a ? "s" : ""), (c.getTime() >= 1e3 * r || a && !d.cookieRead(d.sessionCookieName)) && (d._fieldsExpired || (d._fieldsExpired = {}), d._fieldsExpired[n] = !0)));
                !d._getField(S) && T.isTrackingServerPopulated() && (l = d.cookieRead("s_vi")) && (l = l.split("|"), l.length > 1 && l[0].indexOf("v1") >= 0 && (i = l[1], e = i.indexOf("["), e >= 0 && (i = i.substring(0, e)), i && i.match(te.VALID_VISITOR_ID_REGEX) && d._setField(S, i)))
            }
        }, d._appendVersionTo = function (e) {
            var t = "vVersion|" + d.version, n = e ? d._getCookieVersion(e) : null;
            return n ? K.areVersionsDifferent(n, d.version) && (e = e.replace(te.VERSION_REGEX, t)) : e += (e ? "|" : "") + t, e
        }, d._writeVisitor = function () {
            var e, t, n = d._getSettingsDigest();
            for (e in d._fields) O(e) && d._fields[e] && "expire" !== e.substring(0, 6) && (t = d._fields[e], n += (n ? "|" : "") + e + (d._fields["expire" + e] ? "-" + d._fields["expire" + e] : "") + "|" + t);
            n = d._appendVersionTo(n), d.cookieWrite(d.cookieName, n, 1)
        }, d._getField = function (e, t) {
            return null == d._fields || !t && d._fieldsExpired && d._fieldsExpired[e] ? null : d._fields[e]
        }, d._setField = function (e, t, n) {
            null == d._fields && (d._fields = {}), d._fields[e] = t, n || d._writeVisitor()
        }, d._getFieldList = function (e, t) {
            var n = d._getField(e, t);
            return n ? n.split("*") : null
        }, d._setFieldList = function (e, t, n) {
            d._setField(e, t ? t.join("*") : "", n)
        }, d._getFieldMap = function (e, t) {
            var n = d._getFieldList(e, t);
            if (n) {
                var i, r = {};
                for (i = 0; i < n.length; i += 2) r[n[i]] = n[i + 1];
                return r
            }
            return null
        }, d._setFieldMap = function (e, t, n) {
            var i, r = null;
            if (t) {
                r = [];
                for (i in t) O(i) && (r.push(i), r.push(t[i]))
            }
            d._setFieldList(e, r, n)
        }, d._setFieldExpire = function (e, t, n) {
            var i = new Date;
            i.setTime(i.getTime() + 1e3 * t), null == d._fields && (d._fields = {}), d._fields["expire" + e] = Math.floor(i.getTime() / 1e3) + (n ? "s" : ""), t < 0 ? (d._fieldsExpired || (d._fieldsExpired = {}), d._fieldsExpired[e] = !0) : d._fieldsExpired && (d._fieldsExpired[e] = !1), n && (d.cookieRead(d.sessionCookieName) || d.cookieWrite(d.sessionCookieName, "1"))
        }, d._findVisitorID = function (t) {
            return t && ("object" === e(t) && (t = t.d_mid ? t.d_mid : t.visitorID ? t.visitorID : t.id ? t.id : t.uuid ? t.uuid : "" + t), t && "NOTARGET" === (t = t.toUpperCase()) && (t = y), t && (t === y || t.match(te.VALID_VISITOR_ID_REGEX)) || (t = "")), t
        }, d._setFields = function (t, n) {
            if (d._clearTimeout(t), null != d._loading && (d._loading[t] = !1), P.fieldGroupObj[t] && P.setState(t, !1), "MC" === t) {
                !0 !== P.isClientSideMarketingCloudVisitorID && (P.isClientSideMarketingCloudVisitorID = !1);
                var i = d._getField(I);
                if (!i || d.overwriteCrossDomainMCIDAndAID) {
                    if (!(i = "object" === e(n) && n.mid ? n.mid : d._findVisitorID(n))) {
                        if (d._use1stPartyMarketingCloudServer && !d.tried1stPartyMarketingCloudServer) return d.tried1stPartyMarketingCloudServer = !0, void d.getAnalyticsVisitorID(null, !1, !0);
                        i = d._generateLocalMID()
                    }
                    d._setField(I, i)
                }
                i && i !== y || (i = ""), "object" === e(n) && ((n.d_region || n.dcs_region || n.d_blob || n.blob) && d._setFields(b, n), d._use1stPartyMarketingCloudServer && n.mid && d._setFields(D, {id: n.id})), d._callAllCallbacks(I, [i])
            }
            if (t === b && "object" === e(n)) {
                var r = 604800;
                void 0 != n.id_sync_ttl && n.id_sync_ttl && (r = parseInt(n.id_sync_ttl, 10));
                var a = L.getRegionAndCheckIfChanged(n, r);
                d._callAllCallbacks("MCAAMLH", [a]);
                var o = d._getField(A);
                (n.d_blob || n.blob) && (o = n.d_blob, o || (o = n.blob), d._setFieldExpire(A, r), d._setField(A, o)), o || (o = ""), d._callAllCallbacks(A, [o]), !n.error_msg && d._newCustomerIDsHash && d._setField("MCCIDH", d._newCustomerIDsHash)
            }
            if (t === D) {
                var s = d._getField(S);
                s && !d.overwriteCrossDomainMCIDAndAID || (s = d._findVisitorID(n), s ? s !== y && d._setFieldExpire(A, -1) : s = y, d._setField(S, s)), s && s !== y || (s = ""), d._callAllCallbacks(S, [s])
            }
            if (d.idSyncDisableSyncs || d.disableIdSyncs) L.idCallNotProcesssed = !0; else {
                L.idCallNotProcesssed = !1;
                var l = {};
                l.ibs = n.ibs, l.subdomain = n.subdomain, L.processIDCallData(l)
            }
            if (n === Object(n)) {
                var c, f;
                u() && d.isAllowed() && (c = d._getField("MCOPTOUT"));
                var g = F.parseOptOut(n, c, y);
                c = g.optOut, f = g.d_ottl, d._setFieldExpire("MCOPTOUT", f, !0), d._setField("MCOPTOUT", c), d._callAllCallbacks("MCOPTOUT", [c])
            }
        }, d._loading = null, d._getRemoteField = function (e, t, n, i, r) {
            var a, o = "", s = T.isFirstPartyAnalyticsVisitorIDCall(e), l = {MCAAMLH: !0, MCAAMB: !0};
            if (u() && d.isAllowed()) {
                d._readVisitor(), o = d._getField(e, !0 === l[e]);
                if (function () {
                    return (!o || d._fieldsExpired && d._fieldsExpired[e]) && (!d.disableThirdPartyCalls || s)
                }()) {
                    if (e === I || "MCOPTOUT" === e ? a = "MC" : "MCAAMLH" === e || e === A ? a = b : e === S && (a = D), a) return !t || null != d._loading && d._loading[a] || (null == d._loading && (d._loading = {}), d._loading[a] = !0, d._loadData(a, t, function (t) {
                        if (!d._getField(e)) {
                            t && P.setState(a, !0);
                            var n = "";
                            e === I ? n = d._generateLocalMID() : a === b && (n = {error_msg: "timeout"}), d._setFields(a, n)
                        }
                    }, r)), d._registerCallback(e, n), o || (t || d._setFields(a, {id: y}), "")
                } else o || (e === I ? (d._registerCallback(e, n), o = d._generateLocalMID(), d.setMarketingCloudVisitorID(o)) : e === S ? (d._registerCallback(e, n), o = "", d.setAnalyticsVisitorID(o)) : (o = "", i = !0))
            }
            return e !== I && e !== S || o !== y || (o = "", i = !0), n && i && d._callCallback(n, [o]), o
        }, d._setMarketingCloudFields = function (e) {
            d._readVisitor(), d._setFields("MC", e)
        }, d._mapCustomerIDs = function (e) {
            d.getAudienceManagerBlob(e, !0)
        }, d._setAnalyticsFields = function (e) {
            d._readVisitor(), d._setFields(D, e)
        }, d._setAudienceManagerFields = function (e) {
            d._readVisitor(), d._setFields(b, e)
        }, d._getAudienceManagerURLData = function (e) {
            var t = d.audienceManagerServer, n = "", i = d._getField(I), r = d._getField(A, !0), a = d._getField(S), o = a && a !== y ? "&d_cid_ic=AVID%01" + encodeURIComponent(a) : "";
            if (d.loadSSL && d.audienceManagerServerSecure && (t = d.audienceManagerServerSecure), t) {
                var s, l, c = d.getCustomerIDs();
                if (c) for (s in c) O(s) && (l = c[s], o += "&d_cid_ic=" + encodeURIComponent(s) + "%01" + encodeURIComponent(l.id ? l.id : "") + (l.authState ? "%01" + l.authState : ""));
                e || (e = "_setAudienceManagerFields");
                var u = "http" + (d.loadSSL ? "s" : "") + "://" + t + "/id",
                    f = "d_visid_ver=" + d.version + (g && -1 !== u.indexOf("demdex.net") ? "&gdpr=1&gdpr_force=1&gdpr_consent=" + g : "") + "&d_rtbd=json&d_ver=2" + (!i && d._use1stPartyMarketingCloudServer ? "&d_verify=1" : "") + "&d_orgid=" + encodeURIComponent(d.marketingCloudOrgID) + "&d_nsid=" + (d.idSyncContainerID || 0) + (i ? "&d_mid=" + encodeURIComponent(i) : "") + (d.idSyncDisable3rdPartySyncing || d.disableThirdPartyCookies ? "&d_coppa=true" : "") + (!0 === C ? "&d_coop_safe=1" : !1 === C ? "&d_coop_unsafe=1" : "") + (r ? "&d_blob=" + encodeURIComponent(r) : "") + o,
                    p = ["s_c_il", d._in, e];
                return n = u + "?" + f + "&d_cb=s_c_il%5B" + d._in + "%5D." + e, {url: n, corsUrl: u + "?" + f, callback: p}
            }
            return {url: n}
        }, d.appendVisitorIDsTo = function (e) {
            try {
                var t = [[I, d._getField(I)], [S, d._getField(S)], ["MCORGID", d.marketingCloudOrgID]];
                return d._addQuerystringParam(e, te.ADOBE_MC, s(t))
            } catch (t) {
                return e
            }
        }, d.appendSupplementalDataIDTo = function (e, t) {
            if (!(t = t || d.getSupplementalDataID(T.generateRandomString(), !0))) return e;
            try {
                var n = s([["SDID", t], ["MCORGID", d.marketingCloudOrgID]]);
                return d._addQuerystringParam(e, te.ADOBE_MC_SDID, n)
            } catch (t) {
                return e
            }
        };
        var T = {
            parseHash: function (e) {
                var t = e.indexOf("#");
                return t > 0 ? e.substr(t) : ""
            }, hashlessUrl: function (e) {
                var t = e.indexOf("#");
                return t > 0 ? e.substr(0, t) : e
            }, addQueryParamAtLocation: function (e, t, n) {
                var i = e.split("&");
                return n = null != n ? n : i.length, i.splice(n, 0, t), i.join("&")
            }, isFirstPartyAnalyticsVisitorIDCall: function (e, t, n) {
                if (e !== S) return !1;
                var i;
                return t || (t = d.trackingServer), n || (n = d.trackingServerSecure), !("string" != typeof (i = d.loadSSL ? n : t) || !i.length) && (i.indexOf("2o7.net") < 0 && i.indexOf("omtrdc.net") < 0)
            }, isObject: function (e) {
                return Boolean(e && e === Object(e))
            }, removeCookie: function (e) {
                Re.remove(e, {domain: d.cookieDomain})
            }, isTrackingServerPopulated: function () {
                return !!d.trackingServer || !!d.trackingServerSecure
            }, getTimestampInSeconds: function () {
                return Math.round((new Date).getTime() / 1e3)
            }, parsePipeDelimetedKeyValues: function (e) {
                return e.split("|").reduce(function (e, t) {
                    var n = t.split("=");
                    return e[n[0]] = decodeURIComponent(n[1]), e
                }, {})
            }, generateRandomString: function (e) {
                e = e || 5;
                for (var t = "", n = "abcdefghijklmnopqrstuvwxyz0123456789"; e--;) t += n[Math.floor(Math.random() * n.length)];
                return t
            }, normalizeBoolean: function (e) {
                return "true" === e || "false" !== e && e
            }, parseBoolean: function (e) {
                return "true" === e || "false" !== e && null
            }, replaceMethodsWithFunction: function (e, t) {
                for (var n in e) e.hasOwnProperty(n) && "function" == typeof e[n] && (e[n] = t);
                return e
            }
        };
        d._helpers = T;
        var L = ne(d, _);
        d._destinationPublishing = L, d.timeoutMetricsLog = [];
        var P = {
            isClientSideMarketingCloudVisitorID: null, MCIDCallTimedOut: null, AnalyticsIDCallTimedOut: null, AAMIDCallTimedOut: null, fieldGroupObj: {}, setState: function (e, t) {
                switch (e) {
                    case"MC":
                        !1 === t ? !0 !== this.MCIDCallTimedOut && (this.MCIDCallTimedOut = !1) : this.MCIDCallTimedOut = t;
                        break;
                    case D:
                        !1 === t ? !0 !== this.AnalyticsIDCallTimedOut && (this.AnalyticsIDCallTimedOut = !1) : this.AnalyticsIDCallTimedOut = t;
                        break;
                    case b:
                        !1 === t ? !0 !== this.AAMIDCallTimedOut && (this.AAMIDCallTimedOut = !1) : this.AAMIDCallTimedOut = t
                }
            }
        };
        d.isClientSideMarketingCloudVisitorID = function () {
            return P.isClientSideMarketingCloudVisitorID
        }, d.MCIDCallTimedOut = function () {
            return P.MCIDCallTimedOut
        }, d.AnalyticsIDCallTimedOut = function () {
            return P.AnalyticsIDCallTimedOut
        }, d.AAMIDCallTimedOut = function () {
            return P.AAMIDCallTimedOut
        }, d.idSyncGetOnPageSyncInfo = function () {
            return d._readVisitor(), d._getField("MCSYNCSOP")
        }, d.idSyncByURL = function (e) {
            var t = l(e || {});
            if (t.error) return t.error;
            var n, i, r = e.url, a = encodeURIComponent, o = L;
            return r = r.replace(/^https:/, "").replace(/^http:/, ""), n = F.encodeAndBuildRequest(["", e.dpid, e.dpuuid || ""], ","), i = ["ibs", a(e.dpid), "img", a(r), t.ttl, "", n], o.addMessage(i.join("|")), o.requestToProcess(), "Successfully queued"
        }, d.idSyncByDataSource = function (e) {
            return e === Object(e) && "string" == typeof e.dpuuid && e.dpuuid.length ? (e.url = "//dpm.demdex.net/ibs:dpid=" + e.dpid + "&dpuuid=" + e.dpuuid, d.idSyncByURL(e)) : "Error: config or config.dpuuid is empty"
        }, d.publishDestinations = function (e, t, n) {
            if (n = "function" == typeof n ? n : function () {
            }, "string" != typeof e || !e.length) return void n({error: "subdomain is not a populated string."});
            if (!(t instanceof Array && t.length)) return void n({error: "messages is not a populated array."});
            var i = L;
            if (!i.readyToAttachIframePreliminary()) return void n({error: "The destination publishing iframe is disabled in the Visitor library."});
            var r = !1;
            if (t.forEach(function (e) {
                "string" == typeof e && e.length && (i.addMessage(e), r = !0)
            }), !r) return void n({error: "None of the messages are populated strings."});
            i.iframe ? (n({message: "The destination publishing iframe is already attached and loaded."}), i.requestToProcess()) : !d.subdomain && d._getField(I) ? (i.subdomain = e, i.doAttachIframe = !0, i.url = i.getUrl(), i.readyToAttachIframe() ? (i.iframeLoadedCallbacks.push(function (e) {
                n({message: "Attempted to attach and load the destination publishing iframe through this API call. Result: " + (e.message || "no result")})
            }), i.attachIframe()) : n({error: "Encountered a problem in attempting to attach and load the destination publishing iframe through this API call."})) : i.iframeLoadedCallbacks.push(function (e) {
                n({message: "Attempted to attach and load the destination publishing iframe through normal Visitor API processing. Result: " + (e.message || "no result")})
            })
        }, d._getCookieVersion = function (e) {
            e = e || d.cookieRead(d.cookieName);
            var t = te.VERSION_REGEX.exec(e);
            return t && t.length > 1 ? t[1] : null
        }, d._resetAmcvCookie = function (e) {
            var t = d._getCookieVersion();
            t && !K.isLessThan(t, e) || T.removeCookie(d.cookieName)
        }, d.setAsCoopSafe = function () {
            C = !0
        }, d.setAsCoopUnsafe = function () {
            C = !1
        }, function () {
            if (d.configs = Object.create(null), T.isObject(n)) for (var e in n) O(e) && (d[e] = n[e], d.configs[e] = n[e])
        }(), function () {
            [["getMarketingCloudVisitorID"], ["setCustomerIDs", void 0], ["getAnalyticsVisitorID"], ["getAudienceManagerLocationHint"], ["getLocationHint"], ["getAudienceManagerBlob"]].forEach(function (e) {
                var t = e[0], n = 2 === e.length ? e[1] : "", i = d[t];
                d[t] = function (e) {
                    return u() && d.isAllowed() ? i.apply(d, arguments) : ("function" == typeof e && d._callCallback(e, [n]), n)
                }
            })
        }(), d.init = function () {
            if (c()) var e = f.optIn.fetchPermissions(function () {
                f.optIn.isApproved(f.optIn.Categories.ECID) && (d.configs.isIabContext ? f.optIn.execute({
                    command: "iabPlugin.fetchConsentData", callback: function (t, n) {
                        if (p = !0, t) throw new Error("[IAB plugin] : " + t);
                        n.gdprApplies && (g = n.consentString), d.init(), e()
                    }
                }) : (d.init(), e()))
            }, !0); else !function () {
                if (T.isObject(n)) {
                    d.idSyncContainerID = d.idSyncContainerID || 0, C = "boolean" == typeof d.isCoopSafe ? d.isCoopSafe : T.parseBoolean(d.isCoopSafe), d.resetBeforeVersion && d._resetAmcvCookie(d.resetBeforeVersion), d._attemptToPopulateIdsFromUrl(), d._attemptToPopulateSdidFromUrl(), d._readVisitor();
                    var e = d._getField(v), t = Math.ceil((new Date).getTime() / te.MILLIS_PER_DAY);
                    d.idSyncDisableSyncs || d.disableIdSyncs || !L.canMakeSyncIDCall(e, t) || (d._setFieldExpire(A, -1), d._setField(v, t)), d.getMarketingCloudVisitorID(), d.getAudienceManagerLocationHint(), d.getAudienceManagerBlob(), d._mergeServerState(d.serverState)
                } else d._attemptToPopulateIdsFromUrl(), d._attemptToPopulateSdidFromUrl()
            }(), function () {
                if (!d.idSyncDisableSyncs && !d.disableIdSyncs) {
                    L.checkDPIframeSrc();
                    var e = function () {
                        var e = L;
                        e.readyToAttachIframe() && e.attachIframe()
                    };
                    h.addEventListener("load", function () {
                        _.windowLoaded = !0, e()
                    });
                    try {
                        $.receiveMessage(function (e) {
                            L.receiveMessage(e.data)
                        }, L.iframeHost)
                    } catch (e) {
                    }
                }
            }(), function () {
                d.whitelistIframeDomains && te.POST_MESSAGE_ENABLED && (d.whitelistIframeDomains = d.whitelistIframeDomains instanceof Array ? d.whitelistIframeDomains : [d.whitelistIframeDomains], d.whitelistIframeDomains.forEach(function (e) {
                    var n = new U(t, e), i = z(d, n);
                    $.receiveMessage(i, e)
                }))
            }()
        }
    };
    xe.config = re, m.Visitor = xe;
    var Fe = xe, Ne = Pe.OptIn, je = Pe.IabPlugin;
    return Fe.getInstance = function (e, t) {
        if (!e) throw new Error("Visitor requires Adobe Marketing Cloud Org ID.");
        e.indexOf("@") < 0 && (e += "@AdobeOrg");
        var n = function () {
            var t = m.s_c_il;
            if (t) for (var n = 0; n < t.length; n++) {
                var i = t[n];
                if (i && "Visitor" === i._c && i.marketingCloudOrgID === e) return i
            }
        }();
        if (n) return n;
        var i = function () {
            if (F.isObject(t)) return Object.keys(t).reduce(function (e, n) {
                var i = "doesOptInApply" !== n ? t[n] : !!re.normalizeConfig(t[n]), r = F.normalizeBoolean(i);
                return e[n] = r, e
            }, Object.create(null))
        }();
        !function (e) {
            m.adobe.optIn = m.adobe.optIn || function () {
                var t = F.pluck(e, ["doesOptInApply", "previousPermissions", "preOptInApprovals", "isOptInStorageEnabled", "optInStorageExpiry", "isIabContext"]), n = e.optInCookieDomain || e.cookieDomain;
                n = n || J(), n = n === window.location.hostname ? "" : n, t.optInCookieDomain = n;
                var i = new Ne(t, {cookies: Re});
                if (t.isIabContext) {
                    var r = new je(window.__cmp);
                    i.registerPlugin(r)
                }
                return i
            }()
        }(i || {});
        var r = e, a = r.split("").reverse().join(""), o = new Fe(e, null, a);
        F.isObject(i) && i.cookieDomain && (o.cookieDomain = i.cookieDomain), function () {
            m.s_c_il.splice(--m.s_c_in, 1)
        }();
        var s = F.getIeVersion();
        if ("number" == typeof s && s < 10) return o._helpers.replaceMethodsWithFunction(o, function () {
        });
        var l = function () {
            try {
                return m.self !== m.parent
            } catch (e) {
                return !0
            }
        }() && !function (e) {
            return e.cookieWrite("TEST_AMCV_COOKIE", "T", 1), "T" === e.cookieRead("TEST_AMCV_COOKIE") && (e._helpers.removeCookie("TEST_AMCV_COOKIE"), !0)
        }(o) && m.parent ? new B(e, i, o, m.parent) : new Fe(e, i, a);
        return o = null, l.init(), l
    }, function () {
        function e() {
            Fe.windowLoaded = !0
        }

        m.addEventListener ? m.addEventListener("load", e) : m.attachEvent && m.attachEvent("onload", e), Fe.codeLoadEnd = (new Date).getTime()
    }(), Fe
}();
//Visid Library ends here

//Visitor Object creation
var visitor = Visitor.getInstance("50AAA7AF583C44580A495DE6@AdobeOrg");

//AAM DIL Library version - 9.3 starts here
!function () {
    "use strict";

    function e(e, t, s) {
        var n = "", i = t || "Error caught in DIL module/submodule: ";
        return e === Object(e) ? n = i + (e.message || "err has no message") : (n = i + "err is not a valid object", e = {}), e.message = n, s instanceof DIL && (e.partner = s.api.getPartner()), DIL.errorModule.handleError(e), this.errorMessage = n
    }

    var r, a, o, t = {
        submitUniversalAnalytics: function (e, t, s) {
            try {
                var n, i, r, a, o = e.getAll()[0], d = o[s || "b"].data.keys, u = {};
                for (n = 0, i = d.length; n < i; n++) r = d[n], void 0 === (a = o.get(r)) || "function" == typeof a || a === Object(a) || /^_/.test(r) || /^&/.test(r) || (u[r] = a);
                return t.api.signals(u, "c_").submit(), u
            } catch (e) {
                return "Caught error with message: " + e.message
            }
        }, dil: null, arr: null, tv: null, errorMessage: "", defaultTrackVars: ["_setAccount", "_setCustomVar", "_addItem", "_addTrans", "_trackSocial"], defaultTrackVarsObj: null, signals: {}, hasSignals: !1, handle: e, init: function (e, t, s) {
            try {
                this.dil = null, this.arr = null, this.tv = null, this.errorMessage = "", this.signals = {}, this.hasSignals = !1;
                var n = {name: "DIL GA Module Error"}, i = "";
                t instanceof DIL ? (this.dil = t, n.partner = this.dil.api.getPartner()) : (i = "dilInstance is not a valid instance of DIL", n.message = i, DIL.errorModule.handleError(n)), e instanceof Array && e.length ? this.arr = e : (i = "gaArray is not an array or is empty", n.message = i, DIL.errorModule.handleError(n)), this.tv = this.constructTrackVars(s), this.errorMessage = i
            } catch (e) {
                this.handle(e, "DIL.modules.GA.init() caught error with message ", this.dil)
            } finally {
                return this
            }
        }, constructTrackVars: function (e) {
            var t, s, n, i, r, a, o = [];
            if (this.defaultTrackVarsObj !== Object(this.defaultTrackVarsObj)) {
                for (a = {}, s = 0, n = (r = this.defaultTrackVars).length; s < n; s++) a[r[s]] = !0;
                this.defaultTrackVarsObj = a
            } else a = this.defaultTrackVarsObj;
            if (e === Object(e)) {
                if ((t = e.names) instanceof Array && (n = t.length)) for (s = 0; s < n; s++) "string" == typeof (i = t[s]) && i.length && i in a && o.push(i);
                if (o.length) return o
            }
            return this.defaultTrackVars
        }, constructGAObj: function (e) {
            var t, s, n, i, r, a, o = {}, d = e instanceof Array ? e : this.arr;
            for (t = 0, s = d.length; t < s; t++) (n = d[t]) instanceof Array && n.length && (r = n = [], a = d[t], r instanceof Array && a instanceof Array && Array.prototype.push.apply(r, a), "string" == typeof (i = n.shift()) && i.length && (o[i] instanceof Array || (o[i] = []), o[i].push(n)));
            return o
        }, addToSignals: function (e, t) {
            return "string" == typeof e && "" !== e && null != t && "" !== t && (this.signals[e] instanceof Array || (this.signals[e] = []), this.signals[e].push(t), this.hasSignals = !0)
        }, constructSignals: function () {
            var e, t, s, n, i, r, a = this.constructGAObj(), o = {
                _setAccount: function (e) {
                    this.addToSignals("c_accountId", e)
                }, _setCustomVar: function (e, t, s) {
                    "string" == typeof t && t.length && this.addToSignals("c_" + t, s)
                }, _addItem: function (e, t, s, n, i, r) {
                    this.addToSignals("c_itemOrderId", e), this.addToSignals("c_itemSku", t), this.addToSignals("c_itemName", s), this.addToSignals("c_itemCategory", n), this.addToSignals("c_itemPrice", i), this.addToSignals("c_itemQuantity", r)
                }, _addTrans: function (e, t, s, n, i, r, a, o) {
                    this.addToSignals("c_transOrderId", e), this.addToSignals("c_transAffiliation", t), this.addToSignals("c_transTotal", s), this.addToSignals("c_transTax", n), this.addToSignals("c_transShipping", i), this.addToSignals("c_transCity", r), this.addToSignals("c_transState", a), this.addToSignals("c_transCountry", o)
                }, _trackSocial: function (e, t, s, n) {
                    this.addToSignals("c_socialNetwork", e), this.addToSignals("c_socialAction", t), this.addToSignals("c_socialTarget", s), this.addToSignals("c_socialPagePath", n)
                }
            }, d = this.tv;
            for (e = 0, t = d.length; e < t; e++) if (s = d[e], a.hasOwnProperty(s) && o.hasOwnProperty(s) && (r = a[s]) instanceof Array) for (n = 0, i = r.length; n < i; n++) o[s].apply(this, r[n])
        }, submit: function () {
            try {
                return "" !== this.errorMessage ? this.errorMessage : (this.constructSignals(), this.hasSignals ? (this.dil.api.signals(this.signals).submit(), "Signals sent: " + this.dil.helpers.convertObjectToKeyValuePairs(this.signals, "=", !0)) : "No signals present")
            } catch (e) {
                return this.handle(e, "DIL.modules.GA.submit() caught error with message ", this.dil)
            }
        }, Stuffer: {
            LIMIT: 5, dil: null, cookieName: null, delimiter: null, errorMessage: "", handle: e, callback: null, v: function () {
                return !1
            }, init: function (e, t, s) {
                try {
                    this.dil = null, this.callback = null, this.errorMessage = "", e instanceof DIL ? (this.dil = e, this.v = this.dil.validators.isPopulatedString, this.cookieName = this.v(t) ? t : "aam_ga", this.delimiter = this.v(s) ? s : "|") : this.handle({message: "dilInstance is not a valid instance of DIL"}, "DIL.modules.GA.Stuffer.init() error: ")
                } catch (e) {
                    this.handle(e, "DIL.modules.GA.Stuffer.init() caught error with message ", this.dil)
                } finally {
                    return this
                }
            }, process: function (e) {
                var t, s, n, i, r, a, o, d, u, c, l, h = !1, f = 1;
                if (e === Object(e) && (t = e.stuff) && t instanceof Array && (s = t.length)) for (n = 0; n < s; n++) if ((i = t[n]) && i === Object(i) && (r = i.cn, a = i.cv, r === this.cookieName && this.v(a))) {
                    h = !0;
                    break
                }
                if (h) {
                    for (o = a.split(this.delimiter), void 0 === window._gaq && (window._gaq = []), d = window._gaq, n = 0, s = o.length; n < s && (c = (u = o[n].split("="))[0], l = u[1], this.v(c) && this.v(l) && d.push(["_setCustomVar", f++, c, l, 1]), !(f > this.LIMIT)); n++) ;
                    this.errorMessage = 1 < f ? "No errors - stuffing successful" : "No valid values to stuff"
                } else this.errorMessage = "Cookie name and value not found in json";
                if ("function" == typeof this.callback) return this.callback()
            }, submit: function () {
                try {
                    var t = this;
                    return "" !== this.errorMessage ? this.errorMessage : (this.dil.api.afterResult(function (e) {
                        t.process(e)
                    }).submit(), "DIL.modules.GA.Stuffer.submit() successful")
                } catch (e) {
                    return this.handle(e, "DIL.modules.GA.Stuffer.submit() caught error with message ", this.dil)
                }
            }
        }
    }, s = {
        dil: null, handle: e, init: function (e, t, s, n) {
            try {
                var f = this, i = {name: "DIL Site Catalyst Module Error"}, p = function (e) {
                    return i.message = e, DIL.errorModule.handleError(i), e
                };
                if (this.options = n === Object(n) ? n : {}, this.dil = null, !(t instanceof DIL)) return p("dilInstance is not a valid instance of DIL");
                if (this.dil = t, i.partner = t.api.getPartner(), e !== Object(e)) return p("siteCatalystReportingSuite is not an object");
                var r = e;
                return window.AppMeasurement_Module_DIL = r.m_DIL = function (e) {
                    var t = "function" == typeof e.m_i ? e.m_i("DIL") : this;
                    if (t !== Object(t)) return p("m is not an object");
                    t.trackVars = f.constructTrackVars(s), t.d = 0, t.s = e, t._t = function () {
                        var e, t, s, n, i, r, a = this, o = "," + a.trackVars + ",", d = a.s, u = [], c = [], l = {}, h = !1;
                        if (d !== Object(d)) return p("Error in m._t function: s is not an object");
                        if (a.d) {
                            if ("function" == typeof d.foreachVar) d.foreachVar(function (e, t) {
                                void 0 !== t && (l[e] = t, h = !0)
                            }, a.trackVars); else {
                                if (!(d.va_t instanceof Array)) return p("Error in m._t function: s.va_t is not an array");
                                if (d.lightProfileID ? (e = d.lightTrackVars) && (e = "," + e + "," + d.vl_mr + ",") : (d.pe || d.linkType) && (e = d.linkTrackVars, d.pe && (t = d.pe.substring(0, 1).toUpperCase() + d.pe.substring(1), d[t] && (e = d[t].trackVars)), e && (e = "," + e + "," + d.vl_l + "," + d.vl_l2 + ",")), e) {
                                    for (r = 0, u = e.split(","); r < u.length; r++) 0 <= o.indexOf("," + u[r] + ",") && c.push(u[r]);
                                    c.length && (o = "," + c.join(",") + ",")
                                }
                                for (n = 0, i = d.va_t.length; n < i; n++) s = d.va_t[n], 0 <= o.indexOf("," + s + ",") && void 0 !== d[s] && null !== d[s] && "" !== d[s] && (l[s] = d[s], h = !0)
                            }
                            f.includeContextData(d, l).store_populated && (h = !0), h && a.d.api.signals(l, "c_").submit()
                        }
                    }
                }, r.loadModule("DIL"), r.DIL.d = t, i.message ? i.message : "DIL.modules.siteCatalyst.init() completed with no errors"
            } catch (e) {
                return this.handle(e, "DIL.modules.siteCatalyst.init() caught error with message ", this.dil)
            }
        }, constructTrackVars: function (e) {
            var t, s, n, i, r, a, o, d, u = [];
            if (e === Object(e)) {
                if ((t = e.names) instanceof Array && (i = t.length)) for (n = 0; n < i; n++) "string" == typeof (r = t[n]) && r.length && u.push(r);
                if ((s = e.iteratedNames) instanceof Array && (i = s.length)) for (n = 0; n < i; n++) if ((a = s[n]) === Object(a) && (r = a.name, d = parseInt(a.maxIndex, 10), "string" == typeof r && r.length && !isNaN(d) && 0 <= d)) for (o = 0; o <= d; o++) u.push(r + o);
                if (u.length) return u.join(",")
            }
            return this.constructTrackVars({names: ["pageName", "channel", "campaign", "products", "events", "pe", "pev1", "pev2", "pev3"], iteratedNames: [{name: "prop", maxIndex: 75}, {name: "eVar", maxIndex: 250}]})
        }, includeContextData: function (e, t) {
            var s = {}, n = !1;
            if (e.contextData === Object(e.contextData)) {
                var i, r, a, o, d, u = e.contextData, c = this.options.replaceContextDataPeriodsWith, l = this.options.filterFromContextVariables, h = {};
                if ("string" == typeof c && c.length || (c = "_"), l instanceof Array) for (i = 0, r = l.length; i < r; i++) a = l[i], this.dil.validators.isPopulatedString(a) && (h[a] = !0);
                for (o in u) u.hasOwnProperty(o) && !h[o] && ((d = u[o]) || "number" == typeof d) && (t[o = ("contextData." + o).replace(/\./g, c)] = d, n = !0)
            }
            return s.store_populated = n, s
        }
    };
    "function" != typeof window.DIL && (window.DIL = function (s) {
        var c, e, I, r, u, p, t, a, n, i, o, d, y, l, h, g, f, m, b, v, D, S = [], _ = {};

        function O(e) {
            return void 0 === e || !0 === e
        }

        s !== Object(s) && (s = {}), I = s.partner, r = s.containerNSID, u = s.mappings, p = s.uuidCookie, t = !0 === s.enableErrorReporting, a = s.visitorService, n = s.declaredId, i = !0 === s.delayAllUntilWindowLoad, o = O(s.secureDataCollection), d = "boolean" == typeof s.isCoopSafe ? s.isCoopSafe : null, y = O(s.enableHrefererParam), l = O(s.enableLogging), h = O(s.enableUrlDestinations), g = O(s.enableCookieDestinations), f = !0 === s.disableDefaultRequest, m = s.afterResultForDefaultRequest, b = s.visitorConstructor, v = !0 === s.disableCORS, D = !0 === s.ignoreHardDependencyOnVisitorAPI, t && DIL.errorModule.activate(), D && S.push("Warning: this instance is configured to ignore the hard dependency on the VisitorAPI service. This means that no URL destinations will be fired if the instance has no connection to VisitorAPI. If the VisitorAPI service is not instantiated, ID syncs will not be fired either.");
        var C = !0 === window._dil_unit_tests;
        if ((c = arguments[1]) && S.push(c + ""), !I || "string" != typeof I) {
            var w = {name: "error", message: c = "DIL partner is invalid or not specified in initConfig", filename: "dil.js"};
            return DIL.errorModule.handleError(w), new Error(c)
        }
        if (c = "DIL containerNSID is invalid or not specified in initConfig, setting to default of 0", (r || "number" == typeof r) && (r = parseInt(r, 10), !isNaN(r) && 0 <= r && (c = "")), c && (r = 0, S.push(c), c = ""), (e = DIL.getDil(I, r)) instanceof DIL && e.api.getPartner() === I && e.api.getContainerNSID() === r) return e;
        if (!(this instanceof DIL)) return new DIL(s, "DIL was not instantiated with the 'new' operator, returning a valid instance with partner = " + I + " and containerNSID = " + r);
        DIL.registerDil(this, I, r);
        var L = {
            doesConsoleLogExist: window.console === Object(window.console) && "function" == typeof window.console.log, logMemo: {}, log: function (e) {
                (S.push(e), l && this.doesConsoleLogExist) && Function.prototype.bind.call(window.console.log, window.console).apply(window.console, arguments)
            }, logOnce: function (e) {
                this.logMemo[e] || (this.logMemo[e] = !0, L.log(e))
            }
        }, A = {
            IS_HTTPS: o || "https:" === document.location.protocol, SIX_MONTHS_IN_MINUTES: 259200, IE_VERSION: function () {
                if (document.documentMode) return document.documentMode;
                for (var e = 7; 4 < e; e--) {
                    var t = document.createElement("div");
                    if (t.innerHTML = "\x3c!--[if IE " + e + "]><span></span><![endif]--\x3e", t.getElementsByTagName("span").length) return t = null, e
                }
                return null
            }()
        };
        A.IS_IE_LESS_THAN_10 = "number" == typeof A.IE_VERSION && A.IE_VERSION < 10;
        var P = {stuffed: {}}, T = {}, R = {
            firingQueue: [],
            fired: [],
            firing: !1,
            sent: [],
            errored: [],
            reservedKeys: {sids: !0, pdata: !0, logdata: !0, callback: !0, postCallbackFn: !0, useImageRequest: !0},
            firstRequestHasFired: !1,
            abortRequests: !1,
            num_of_cors_responses: 0,
            num_of_cors_errors: 0,
            corsErrorSources: [],
            num_of_img_responses: 0,
            num_of_img_errors: 0,
            platformParams: {d_nsid: r + "", d_rtbd: "json", d_jsonv: DIL.jsonVersion + "", d_dst: "1"},
            nonModStatsParams: {d_rtbd: !0, d_dst: !0, d_cts: !0, d_rs: !0},
            modStatsParams: null,
            adms: {
                TIME_TO_CATCH_ALL_REQUESTS_RELEASE: 3e4, calledBack: !1, mid: null, noVisitorAPI: null, VisitorAPI: null, instance: null, releaseType: "no VisitorAPI", isOptedOut: !0, isOptedOutCallbackCalled: !1, admsProcessingStarted: !1, process: function (e) {
                    try {
                        if (this.admsProcessingStarted) return;
                        this.admsProcessingStarted = !0;
                        var t, s, n, i = a;
                        if ("function" != typeof e || "function" != typeof e.getInstance) throw this.noVisitorAPI = !0, new Error("Visitor does not exist.");
                        if (i !== Object(i) || !(t = i.namespace) || "string" != typeof t) throw this.releaseType = "no namespace", new Error("DIL.create() needs the initConfig property `visitorService`:{namespace:'<Experience Cloud Org ID>'}");
                        if (!((s = e.getInstance(t, {idSyncContainerID: r})) === Object(s) && s instanceof e && "function" == typeof s.isAllowed && "function" == typeof s.getMarketingCloudVisitorID && "function" == typeof s.getCustomerIDs && "function" == typeof s.isOptedOut && "function" == typeof s.publishDestinations)) throw this.releaseType = "invalid instance", n = "Invalid Visitor instance.", s === Object(s) && "function" != typeof s.publishDestinations && (n += " In particular, visitorInstance.publishDestinations is not a function. This is needed to fire URL destinations in DIL v8.0+ and should be present in Visitor v3.3.0+ ."), new Error(n);
                        if (this.VisitorAPI = e, !s.isAllowed()) return this.releaseType = "VisitorAPI is not allowed to write cookies", void this.releaseRequests();
                        this.instance = s, this.waitForMidToReleaseRequests()
                    } catch (e) {
                        if (!D) throw new Error("Error in processing Visitor API, which is a hard dependency for DIL v8.0+: " + e.message);
                        this.releaseRequests()
                    }
                }, waitForMidToReleaseRequests: function () {
                    var t = this;
                    this.instance && (this.instance.getMarketingCloudVisitorID(function (e) {
                        t.mid = e, t.releaseType = "VisitorAPI", t.releaseRequests()
                    }, !0), (!N.exists || !N.isIabContext && N.isApproved() || N.isIabContext && G.hasGoSignal()) && setTimeout(function () {
                        "VisitorAPI" !== t.releaseType && (t.releaseType = "timeout", t.releaseRequests())
                    }, this.getLoadTimeout()))
                }, releaseRequests: function () {
                    this.calledBack = !0, R.registerRequest()
                }, getMarketingCloudVisitorID: function () {
                    return this.instance ? this.instance.getMarketingCloudVisitorID() : null
                }, getMIDQueryString: function () {
                    var e = V.isPopulatedString, t = this.getMarketingCloudVisitorID();
                    return e(this.mid) && this.mid === t || (this.mid = t), e(this.mid) ? "d_mid=" + this.mid + "&" : ""
                }, getCustomerIDs: function () {
                    return this.instance ? this.instance.getCustomerIDs() : null
                }, getCustomerIDsQueryString: function (e) {
                    if (e !== Object(e)) return "";
                    var t, s, n, i, r = "", a = [], o = [];
                    for (t in e) e.hasOwnProperty(t) && (s = e[o[0] = t]) === Object(s) && (o[1] = s.id || "", o[2] = s.authState || 0, a.push(o), o = []);
                    if (i = a.length) for (n = 0; n < i; n++) r += "&d_cid_ic=" + x.encodeAndBuildRequest(a[n], "%01");
                    return r
                }, getIsOptedOut: function () {
                    this.instance ? this.instance.isOptedOut([this, this.isOptedOutCallback], this.VisitorAPI.OptOut.GLOBAL, !0) : (this.isOptedOut = !1, this.isOptedOutCallbackCalled = !0)
                }, isOptedOutCallback: function (e) {
                    this.isOptedOut = e, this.isOptedOutCallbackCalled = !0, R.registerRequest(), N.isIabContext() && G.checkQueryStringObject()
                }, getLoadTimeout: function () {
                    var e = this.instance;
                    if (e) {
                        if ("function" == typeof e.getLoadTimeout) return e.getLoadTimeout();
                        if (void 0 !== e.loadTimeout) return e.loadTimeout
                    }
                    return this.TIME_TO_CATCH_ALL_REQUESTS_RELEASE
                }
            },
            declaredId: {
                declaredId: {init: null, request: null}, declaredIdCombos: {}, setDeclaredId: function (e, t) {
                    var s = V.isPopulatedString, n = encodeURIComponent;
                    if (e === Object(e) && s(t)) {
                        var i = e.dpid, r = e.dpuuid, a = null;
                        if (s(i) && s(r)) return a = n(i) + "$" + n(r), !0 === this.declaredIdCombos[a] ? "setDeclaredId: combo exists for type '" + t + "'" : (this.declaredIdCombos[a] = !0, this.declaredId[t] = {dpid: i, dpuuid: r}, "setDeclaredId: succeeded for type '" + t + "'")
                    }
                    return "setDeclaredId: failed for type '" + t + "'"
                }, getDeclaredIdQueryString: function () {
                    var e = this.declaredId.request, t = this.declaredId.init, s = encodeURIComponent, n = "";
                    return null !== e ? n = "&d_dpid=" + s(e.dpid) + "&d_dpuuid=" + s(e.dpuuid) : null !== t && (n = "&d_dpid=" + s(t.dpid) + "&d_dpuuid=" + s(t.dpuuid)), n
                }
            },
            registerRequest: function (e) {
                var t, s = this.firingQueue;
                e === Object(e) && (s.push(e), e.isDefaultRequest || (f = !0)), this.firing || !s.length || i && !DIL.windowLoaded || (this.adms.isOptedOutCallbackCalled || this.adms.getIsOptedOut(), this.adms.calledBack && !this.adms.isOptedOut && this.adms.isOptedOutCallbackCalled && (N.isApproved() || G.hasGoSignal()) && (this.adms.isOptedOutCallbackCalled = !1, (t = s.shift()).src = t.src.replace(/&d_nsid=/, "&" + this.adms.getMIDQueryString() + G.getQueryString() + "d_nsid="), V.isPopulatedString(t.corsPostData) && (t.corsPostData = t.corsPostData.replace(/^d_nsid=/, this.adms.getMIDQueryString() + G.getQueryString() + "d_nsid=")), M.fireRequest(t), this.firstRequestHasFired || "script" !== t.tag && "cors" !== t.tag || (this.firstRequestHasFired = !0)))
            },
            processVisitorAPI: function () {
                this.adms.process(b || window.Visitor)
            },
            getCoopQueryString: function () {
                var e = "";
                return !0 === d ? e = "&d_coop_safe=1" : !1 === d && (e = "&d_coop_unsafe=1"), e
            }
        };
        _.requestController = R;
        var E, j, k = {
            sendingMessages: !1, messages: [], messagesPosted: [], destinations: [], destinationsPosted: [], jsonForComparison: [], jsonDuplicates: [], jsonWaiting: [], jsonProcessed: [], publishDestinationsVersion: null, requestToProcess: function (e, t) {
                var s, n = this;

                function i() {
                    n.jsonForComparison.push(e), n.jsonWaiting.push([e, t])
                }

                if (e && !V.isEmptyObject(e)) if (s = JSON.stringify(e.dests || []), this.jsonForComparison.length) {
                    var r, a, o, d = !1;
                    for (r = 0, a = this.jsonForComparison.length; r < a; r++) if (o = this.jsonForComparison[r], s === JSON.stringify(o.dests || [])) {
                        d = !0;
                        break
                    }
                    d ? this.jsonDuplicates.push(e) : i()
                } else i();
                if (this.jsonWaiting.length) {
                    var u = this.jsonWaiting.shift();
                    this.process(u[0], u[1]), this.requestToProcess()
                }
                this.messages.length && !this.sendingMessages && this.sendMessages()
            }, process: function (e) {
                if (h) {
                    var t, s, n, i, r, a, o = encodeURIComponent, d = this.getPublishDestinationsVersion(), u = !1;
                    if (-1 !== d) {
                        if ((t = e.dests) && t instanceof Array && (s = t.length)) {
                            for (n = 0; n < s; n++) i = t[n], a = [o("dests"), o(i.id || ""), o(i.y || ""), o(i.c || "")].join("|"), this.addMessage(a), r = {url: i.c, hideReferrer: void 0 === i.hr || !!i.hr, message: a}, this.addDestination(r), void 0 !== i.hr && (u = !0);
                            1 === d && u && L.logOnce("Warning: visitorInstance.publishDestinations version is old (Visitor v3.3.0 to v4.0.0). URL destinations will not have the option of being fired on page, only in the iframe.")
                        }
                        this.jsonProcessed.push(e)
                    }
                }
            }, addMessage: function (e) {
                this.messages.push(e)
            }, addDestination: function (e) {
                this.destinations.push(e)
            }, sendMessages: function () {
                this.sendingMessages || (this.sendingMessages = !0, h && this.messages.length && this.publishDestinations())
            }, publishDestinations: function () {
                var t = this, e = R.adms.instance, s = [], n = [], i = function (e) {
                    L.log("visitor.publishDestinations() result: " + (e.error || e.message)), t.sendingMessages = !1, t.requestToProcess()
                }, r = function () {
                    t.messages = [], t.destinations = []
                };
                return 1 === this.publishDestinationsVersion ? (x.extendArray(s, this.messages), x.extendArray(this.messagesPosted, this.messages), r(), e.publishDestinations(I, s, i), "Called visitor.publishDestinations() version 1") : 1 < this.publishDestinationsVersion ? (x.extendArray(n, this.destinations), x.extendArray(this.destinationsPosted, this.destinations), r(), e.publishDestinations({
                    subdomain: I,
                    callback: i,
                    urlDestinations: n
                }), "Called visitor.publishDestinations() version > 1") : void 0
            }, getPublishDestinationsVersion: function () {
                if (null !== this.publishDestinationsVersion) return this.publishDestinationsVersion;
                var e = R.adms.instance, s = -1;
                return e.publishDestinations(null, null, function (e) {
                    if (e === Object(e)) {
                        var t = e.error;
                        "subdomain is not a populated string." === t ? s = 1 : "Invalid parameters passed." === t && (s = 2)
                    }
                }), this.publishDestinationsVersion = s
            }
        }, q = {
            traits: function (e) {
                return V.isValidPdata(e) && (T.sids instanceof Array || (T.sids = []), x.extendArray(T.sids, e)), this
            }, pixels: function (e) {
                return V.isValidPdata(e) && (T.pdata instanceof Array || (T.pdata = []), x.extendArray(T.pdata, e)), this
            }, logs: function (e) {
                return V.isValidLogdata(e) && (T.logdata !== Object(T.logdata) && (T.logdata = {}), x.extendObject(T.logdata, e)), this
            }, customQueryParams: function (e) {
                return V.isEmptyObject(e) || x.extendObject(T, e, R.reservedKeys), this
            }, signals: function (e, t) {
                var s, n = e;
                if (!V.isEmptyObject(n)) {
                    if (t && "string" == typeof t) for (s in n = {}, e) e.hasOwnProperty(s) && (n[t + s] = e[s]);
                    x.extendObject(T, n, R.reservedKeys)
                }
                return this
            }, declaredId: function (e) {
                return R.declaredId.setDeclaredId(e, "request"), this
            }, result: function (e) {
                return "function" == typeof e && (T.callback = e), this
            }, afterResult: function (e) {
                return "function" == typeof e && (T.postCallbackFn = e), this
            }, useImageRequest: function () {
                return T.useImageRequest = !0, this
            }, clearData: function () {
                return T = {}, this
            }, submit: function (e) {
                return T.isDefaultRequest = !!e, M.submitRequest(T), T = {}, this
            }, getPartner: function () {
                return I
            }, getContainerNSID: function () {
                return r
            }, getEventLog: function () {
                return S
            }, getState: function () {
                var e = {}, t = {};
                return x.extendObject(e, R, {registerRequest: !0}), x.extendObject(t, k, {requestToProcess: !0, process: !0, sendMessages: !0}), {initConfig: s, pendingRequest: T, otherRequestInfo: e, destinationPublishingInfo: t, log: S}
            }, idSync: function () {
                throw new Error("Please use the `idSyncByURL` method of the Experience Cloud ID Service (Visitor) instance")
            }, aamIdSync: function () {
                throw new Error("Please use the `idSyncByDataSource` method of the Experience Cloud ID Service (Visitor) instance")
            }, passData: function (e) {
                return V.isEmptyObject(e) ? "Error: json is empty or not an object" : (M.defaultCallback(e), e)
            }, getPlatformParams: function () {
                return R.platformParams
            }, getEventCallConfigParams: function () {
                var e, t = R, s = t.modStatsParams, n = t.platformParams;
                if (!s) {
                    for (e in s = {}, n) n.hasOwnProperty(e) && !t.nonModStatsParams[e] && (s[e.replace(/^d_/, "")] = n[e]);
                    !0 === d ? s.coop_safe = 1 : !1 === d && (s.coop_unsafe = 1), t.modStatsParams = s
                }
                return s
            }, setAsCoopSafe: function () {
                return d = !0, this
            }, setAsCoopUnsafe: function () {
                return d = !1, this
            }, getEventCallIabSignals: function (e) {
                var t;
                return e !== Object(e) ? "Error: config is not an object" : "function" != typeof e.callback ? "Error: config.callback is not a function" : (t = parseInt(e.timeout, 10), isNaN(t) && (t = null), void G.getQueryStringObject(e.callback, t))
            }
        }, M = {
            corsMetadata: (E = "none", "undefined" != typeof XMLHttpRequest && XMLHttpRequest === Object(XMLHttpRequest) && "withCredentials" in new XMLHttpRequest && (E = "XMLHttpRequest"), {corsType: E}), getCORSInstance: function () {
                return "none" === this.corsMetadata.corsType ? null : new window[this.corsMetadata.corsType]
            }, submitRequest: function (e) {
                return R.registerRequest(M.createQueuedRequest(e)), !0
            }, createQueuedRequest: function (e) {
                var t, s, n, i, r, a = e.callback, o = "img", d = e.isDefaultRequest;
                if (delete e.isDefaultRequest, !V.isEmptyObject(u)) for (n in u) if (u.hasOwnProperty(n)) {
                    if (null == (i = u[n]) || "" === i) continue;
                    if (n in e && !(i in e) && !(i in R.reservedKeys)) {
                        if (null == (r = e[n]) || "" === r) continue;
                        e[i] = r
                    }
                }
                return V.isValidPdata(e.sids) || (e.sids = []), V.isValidPdata(e.pdata) || (e.pdata = []), V.isValidLogdata(e.logdata) || (e.logdata = {}), e.logdataArray = x.convertObjectToKeyValuePairs(e.logdata, "=", !0), e.logdataArray.push("_ts=" + (new Date).getTime()), "function" != typeof a && (a = this.defaultCallback), t = this.makeRequestSrcData(e), (s = this.getCORSInstance()) && !0 !== e.useImageRequest && (o = "cors"), {
                    tag: o,
                    src: t.src,
                    corsSrc: t.corsSrc,
                    callbackFn: a,
                    postCallbackFn: e.postCallbackFn,
                    useImageRequest: !!e.useImageRequest,
                    requestData: e,
                    corsInstance: s,
                    corsPostData: t.corsPostData,
                    isDefaultRequest: d
                }
            }, defaultCallback: function (e, t) {
                var s, n, i, r, a, o, d, u, c;
                if (g && (s = e.stuff) && s instanceof Array && (n = s.length)) for (i = 0; i < n; i++) (r = s[i]) && r === Object(r) && (a = r.cn, o = r.cv, void 0 !== (d = r.ttl) && "" !== d || (d = Math.floor(x.getMaxCookieExpiresInMinutes() / 60 / 24)), u = r.dmn || "." + document.domain.replace(/^www\./, ""), c = r.type, a && (o || "number" == typeof o) && ("var" !== c && (d = parseInt(d, 10)) && !isNaN(d) && x.setCookie(a, o, 24 * d * 60, "/", u, !1), P.stuffed[a] = o));
                var l, h, f = e.uuid;
                V.isPopulatedString(f) && (V.isEmptyObject(p) || ("string" == typeof (l = p.path) && l.length || (l = "/"), h = parseInt(p.days, 10), isNaN(h) && (h = 100), x.setCookie(p.name || "aam_did", f, 24 * h * 60, l, p.domain || "." + document.domain.replace(/^www\./, ""), !0 === p.secure))), R.abortRequests || k.requestToProcess(e, t)
            }, makeRequestSrcData: function (r) {
                r.sids = V.removeEmptyArrayValues(r.sids || []), r.pdata = V.removeEmptyArrayValues(r.pdata || []);
                var a = R, e = a.platformParams, t = x.encodeAndBuildRequest(r.sids, ","), s = x.encodeAndBuildRequest(r.pdata, ","), n = (r.logdataArray || []).join("&");
                delete r.logdataArray;
                var i, o, d = encodeURIComponent, u = A.IS_HTTPS ? "https://" : "http://", c = a.declaredId.getDeclaredIdQueryString(), l = a.adms.instance ? a.adms.getCustomerIDsQueryString(a.adms.getCustomerIDs()) : "", h = function () {
                        var e, t, s, n, i = [];
                        for (e in r) if (!(e in a.reservedKeys) && r.hasOwnProperty(e)) if (t = r[e], e = d(e), t instanceof Array) for (s = 0, n = t.length; s < n; s++) i.push(e + "=" + d(t[s])); else i.push(e + "=" + d(t));
                        return i.length ? "&" + i.join("&") : ""
                    }(), f = "d_dil_ver=" + d(DIL.version), p = "d_nsid=" + e.d_nsid + a.getCoopQueryString() + c + l + (t.length ? "&d_sid=" + t : "") + (s.length ? "&d_px=" + s : "") + (n.length ? "&d_ld=" + d(n) : ""), g = "&d_rtbd=" + e.d_rtbd + "&d_jsonv=" + e.d_jsonv + "&d_dst=" + e.d_dst,
                    m = y ? "&h_referer=" + d(location.href) : "";
                return o = (i = u + I + ".demdex.net/event") + "?" + f + "&" + p + g + h + m, {corsSrc: i + "?" + f + "&_ts=" + (new Date).getTime(), src: o, corsPostData: p + g + h + m, isDeclaredIdCall: "" !== c}
            }, fireRequest: function (e) {
                if ("img" === e.tag) this.fireImage(e); else {
                    var t = R.declaredId, s = t.declaredId.request || t.declaredId.init || {}, n = {dpid: s.dpid || "", dpuuid: s.dpuuid || ""};
                    this.fireCORS(e, n)
                }
            }, fireImage: function (t) {
                var e, s, n = R;
                n.abortRequests || (n.firing = !0, e = new Image(0, 0), n.sent.push(t), e.onload = function () {
                    n.firing = !1, n.fired.push(t), n.num_of_img_responses++, n.registerRequest()
                }, s = function (e) {
                    c = "imgAbortOrErrorHandler received the event of type " + e.type, L.log(c), n.abortRequests = !0, n.firing = !1, n.errored.push(t), n.num_of_img_errors++, n.registerRequest()
                }, e.addEventListener("error", s), e.addEventListener("abort", s), e.src = t.src)
            }, fireCORS: function (n, i) {
                var r = this, a = R, e = this.corsMetadata.corsType, t = n.corsSrc, s = n.corsInstance, o = n.corsPostData, d = n.postCallbackFn, u = "function" == typeof d;
                if (!a.abortRequests && !v) {
                    a.firing = !0;
                    try {
                        s.open("post", t, !0), "XMLHttpRequest" === e && (s.withCredentials = !0, s.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), s.onreadystatechange = function () {
                            4 === this.readyState && 200 === this.status && function (e) {
                                var t;
                                try {
                                    if ((t = JSON.parse(e)) !== Object(t)) return r.handleCORSError(n, i, "Response is not JSON")
                                } catch (e) {
                                    return r.handleCORSError(n, i, "Error parsing response as JSON")
                                }
                                try {
                                    var s = n.callbackFn;
                                    a.firing = !1, a.fired.push(n), a.num_of_cors_responses++, s(t, i), u && d(t, i)
                                } catch (e) {
                                    e.message = "DIL handleCORSResponse caught error with message " + e.message, c = e.message, L.log(c), e.filename = e.filename || "dil.js", e.partner = I, DIL.errorModule.handleError(e);
                                    try {
                                        s({error: e.name + "|" + e.message}, i), u && d({error: e.name + "|" + e.message}, i)
                                    } catch (e) {
                                    }
                                } finally {
                                    a.registerRequest()
                                }
                            }(this.responseText)
                        }), s.onerror = function () {
                            r.handleCORSError(n, i, "onerror")
                        }, s.ontimeout = function () {
                            r.handleCORSError(n, i, "ontimeout")
                        }, s.send(o)
                    } catch (e) {
                        this.handleCORSError(n, i, "try-catch")
                    }
                    a.sent.push(n), a.declaredId.declaredId.request = null
                }
            }, handleCORSError: function (e, t, s) {
                R.num_of_cors_errors++, R.corsErrorSources.push(s)
            }
        }, V = {
            isValidPdata: function (e) {
                return !!(e instanceof Array && this.removeEmptyArrayValues(e).length)
            }, isValidLogdata: function (e) {
                return !this.isEmptyObject(e)
            }, isEmptyObject: function (e) {
                if (e !== Object(e)) return !0;
                var t;
                for (t in e) if (e.hasOwnProperty(t)) return !1;
                return !0
            }, removeEmptyArrayValues: function (e) {
                var t, s = 0, n = e.length, i = [];
                for (s = 0; s < n; s++) null != (t = e[s]) && "" !== t && i.push(t);
                return i
            }, isPopulatedString: function (e) {
                return "string" == typeof e && e.length
            }
        }, x = {
            convertObjectToKeyValuePairs: function (e, t, s) {
                var n, i, r = [];
                for (n in t || (t = "="), e) e.hasOwnProperty(n) && null != (i = e[n]) && "" !== i && r.push(n + t + (s ? encodeURIComponent(i) : i));
                return r
            }, encodeAndBuildRequest: function (e, t) {
                return e.map(function (e) {
                    return encodeURIComponent(e)
                }).join(t)
            }, getCookie: function (e) {
                var t, s, n, i = e + "=", r = document.cookie.split(";");
                for (t = 0, s = r.length; t < s; t++) {
                    for (n = r[t]; " " === n.charAt(0);) n = n.substring(1, n.length);
                    if (0 === n.indexOf(i)) return decodeURIComponent(n.substring(i.length, n.length))
                }
                return null
            }, setCookie: function (e, t, s, n, i, r) {
                var a = new Date;
                s && (s = 1e3 * s * 60), document.cookie = e + "=" + encodeURIComponent(t) + (s ? ";expires=" + new Date(a.getTime() + s).toUTCString() : "") + (n ? ";path=" + n : "") + (i ? ";domain=" + i : "") + (r ? ";secure" : "")
            }, extendArray: function (e, t) {
                return e instanceof Array && t instanceof Array && (Array.prototype.push.apply(e, t), !0)
            }, extendObject: function (e, t, s) {
                var n;
                if (e !== Object(e) || t !== Object(t)) return !1;
                for (n in t) if (t.hasOwnProperty(n)) {
                    if (!V.isEmptyObject(s) && n in s) continue;
                    e[n] = t[n]
                }
                return !0
            }, getMaxCookieExpiresInMinutes: function () {
                return A.SIX_MONTHS_IN_MINUTES
            }, replaceMethodsWithFunction: function (e, t) {
                var s;
                if (e === Object(e) && "function" == typeof t) for (s in e) e.hasOwnProperty(s) && "function" == typeof e[s] && (e[s] = t)
            }
        }, N = (j = _.requestController, {
            exists: null, instance: null, aamIsApproved: null, init: function () {
                var e = this;
                this.checkIfExists() ? (this.exists = !0, this.instance = window.adobe.optIn, this.instance.fetchPermissions(function () {
                    e.callback()
                }, !0)) : this.exists = !1
            }, checkIfExists: function () {
                return window.adobe === Object(window.adobe) && window.adobe.optIn === Object(window.adobe.optIn)
            }, callback: function () {
                this.aamIsApproved = this.instance.isApproved([this.instance.Categories.AAM]), j.adms.waitForMidToReleaseRequests(), j.adms.getIsOptedOut()
            }, isApproved: function () {
                return !this.isIabContext() && !j.adms.isOptedOut && (!this.exists || this.aamIsApproved)
            }, isIabContext: function () {
                return this.instance && this.instance.isIabContext
            }
        });
        _.optIn = N;
        var U, F, Q, H, G = (F = (U = _).requestController, Q = U.optIn, H = {
            isVendorConsented: null, doesGdprApply: null, consentString: null, queryStringObjectCallbacks: [], init: function () {
                this.fetchConsentData()
            }, hasGoSignal: function () {
                return !(!(Q.isIabContext() && this.isVendorConsented && this.doesGdprApply && "string" == typeof this.consentString && this.consentString.length) || F.adms.isOptedOut)
            }, fetchConsentData: function (s, e) {
                var n = this, t = {};
                "function" != typeof s && (s = function () {
                }), Q.instance && Q.isIabContext() ? (e && (t.timeout = e), Q.instance.execute({
                    command: "iabPlugin.fetchConsentData", params: t, callback: function (e, t) {
                        t === Object(t) ? (n.doesGdprApply = !!t.gdprApplies, n.consentString = t.consentString || "") : (n.doesGdprApply = !1, n.consentString = ""), n.isVendorConsented = Q.instance.isApproved(Q.instance.Categories.AAM), e ? s({}) : n.checkQueryStringObject(s), F.adms.waitForMidToReleaseRequests()
                    }
                })) : s({})
            }, getQueryString: function () {
                return Q.isIabContext() ? "gdpr=" + (this.doesGdprApply ? 1 : 0) + "&gdpr_consent=" + this.consentString + "&" : ""
            }, getQueryStringObject: function (e, t) {
                this.fetchConsentData(e, t)
            }, checkQueryStringObject: function (e) {
                H.hasGoSignal() && "function" == typeof e && e({gdpr: this.doesGdprApply ? 1 : 0, gdpr_consent: this.consentString})
            }
        });
        _.iab = G, "error" === I && 0 === r && window.addEventListener("load", function () {
            DIL.windowLoaded = !0
        });
        var B = !1, W = function () {
            B || (B = !0, R.registerRequest(), K())
        }, K = function () {
            setTimeout(function () {
                f || R.firstRequestHasFired || ("function" == typeof m ? q.afterResult(m).submit(!0) : q.submit(!0))
            }, DIL.constants.TIME_TO_DEFAULT_REQUEST)
        }, X = document;
        "error" !== I && (DIL.windowLoaded ? W() : "complete" !== X.readyState && "loaded" !== X.readyState ? window.addEventListener("load", function () {
            DIL.windowLoaded = !0, W()
        }) : (DIL.windowLoaded = !0, W())), R.declaredId.setDeclaredId(n, "init"), N.init(), G.init(), R.processVisitorAPI();
        A.IS_IE_LESS_THAN_10 && x.replaceMethodsWithFunction(q, function () {
            return this
        }), this.api = q, this.getStuffedVariable = function (e) {
            var t = P.stuffed[e];
            return t || "number" == typeof t || (t = x.getCookie(e)) || "number" == typeof t || (t = ""), t
        }, this.validators = V, this.helpers = x, this.constants = A, this.log = S, this.pendingRequest = T, this.requestController = R, this.destinationPublishing = k, this.requestProcs = M, this.units = _, this.initConfig = s, this.logger = L, C && (this.variables = P, this.callWindowLoadFunctions = W)
    }, DIL.extendStaticPropertiesAndMethods = function (e) {
        var t;
        if (e === Object(e)) for (t in e) e.hasOwnProperty(t) && (this[t] = e[t])
    }, DIL.extendStaticPropertiesAndMethods({
        version: "9.3", jsonVersion: 1, constants: {TIME_TO_DEFAULT_REQUEST: 500}, variables: {scriptNodeList: document.getElementsByTagName("script")}, windowLoaded: !1, dils: {}, isAddedPostWindowLoad: function () {
            var e = arguments[0];
            this.windowLoaded = "function" == typeof e ? !!e() : "boolean" != typeof e || e
        }, create: function (e) {
            try {
                return new DIL(e)
            } catch (e) {
                throw new Error("Error in attempt to create DIL instance with DIL.create(): " + e.message)
            }
        }, registerDil: function (e, t, s) {
            var n = t + "$" + s;
            n in this.dils || (this.dils[n] = e)
        }, getDil: function (e, t) {
            var s;
            return "string" != typeof e && (e = ""), t || (t = 0), (s = e + "$" + t) in this.dils ? this.dils[s] : new Error("The DIL instance with partner = " + e + " and containerNSID = " + t + " was not found")
        }, dexGetQSVars: function (e, t, s) {
            var n = this.getDil(t, s);
            return n instanceof this ? n.getStuffedVariable(e) : ""
        }
    }), DIL.errorModule = (r = DIL.create({partner: "error", containerNSID: 0, ignoreHardDependencyOnVisitorAPI: !0}), o = !(a = {
        harvestererror: 14138,
        destpuberror: 14139,
        dpmerror: 14140,
        generalerror: 14137,
        error: 14137,
        noerrortypedefined: 15021,
        evalerror: 15016,
        rangeerror: 15017,
        referenceerror: 15018,
        typeerror: 15019,
        urierror: 15020
    }), {
        activate: function () {
            o = !0
        }, handleError: function (e) {
            if (!o) return "DIL error module has not been activated";
            e !== Object(e) && (e = {});
            var t = e.name ? (e.name + "").toLowerCase() : "", s = t in a ? a[t] : a.noerrortypedefined, n = [],
                i = {name: t, filename: e.filename ? e.filename + "" : "", partner: e.partner ? e.partner + "" : "no_partner", site: e.site ? e.site + "" : document.location.href, message: e.message ? e.message + "" : ""};
            return n.push(s), r.api.pixels(n).logs(i).useImageRequest().submit(), "DIL error report sent"
        }, pixelMap: a
    }), DIL.tools = {}, DIL.modules = {helpers: {}}), window.DIL && DIL.tools && DIL.modules && (DIL.tools.getMetaTags = function () {
        var e, t, s, n, i, r = {}, a = document.getElementsByTagName("meta");
        for (e = 0, s = arguments.length; e < s; e++) if (null !== (n = arguments[e])) for (t = 0; t < a.length; t++) if ((i = a[t]).name === n) {
            r[n] = i.content;
            break
        }
        return r
    }, DIL.tools.decomposeURI = function (e) {
        var s, t = document.createElement("a");
        return t.href = e || document.referrer, {
            hash: t.hash,
            host: t.host.split(":").shift(),
            hostname: t.hostname,
            href: t.href,
            pathname: t.pathname.replace(/^\//, ""),
            protocol: t.protocol,
            search: t.search,
            uriParams: (s = {}, t.search.replace(/^(\/|\?)?|\/$/g, "").split("&").map(function (e) {
                var t = e.split("=");
                s[t.shift()] = t.shift()
            }), s)
        }
    }, DIL.tools.getSearchReferrer = function (e, t) {
        var s = DIL.getDil("error"), n = DIL.tools.decomposeURI(e || document.referrer), i = "", r = "",
            a = {DEFAULT: {queryParam: "q"}, SEARCH_ENGINES: [t === Object(t) ? t : {}, {hostPattern: /aol\./}, {hostPattern: /ask\./}, {hostPattern: /bing\./}, {hostPattern: /google\./}, {hostPattern: /yahoo\./, queryParam: "p"}]}, o = a.DEFAULT;
        return (i = a.SEARCH_ENGINES.filter(function (e) {
            return !(!e.hasOwnProperty("hostPattern") || !n.hostname.match(e.hostPattern))
        }).shift()) ? {valid: !0, name: n.hostname, keywords: (s.helpers.extendObject(o, i), i = ("" + n.search).match(o.queryPattern), r = o.queryPattern ? i ? i[1] : "" : n.uriParams[o.queryParam], decodeURIComponent(r || "").replace(/\+|%20/g, " "))} : {valid: !1, name: "", keywords: ""}
    }, DIL.modules.GA = t, DIL.modules.siteCatalyst = s, DIL.modules.helpers.handleModuleError = e)
}();

// Sets DIL instance, drops 1st party AAM UUI & declares user ID.
var wmgDil = DIL.create({
    partner: 'wmg',
    uuidCookie: {
        name: 'aam_uuid',
        days: 30,
        useJSONPOnly: true
    },
    //sets up ECID.
    visitorService: {
        namespace: '2DED4480533B2D590A490D4C@AdobeOrg'
    },
    containerNSID: 0
});

/**
 * Send data to AAM.
 */
UPX.urlTracker.bind('track', function (data) {
    if (window.wmgDil && window.ga) {

        // Submit custom data.
        if (UPX.adService) {
            var context = UPX.adService.getContext();

            if (context && context.targeting) {

                var fieldsToTrack = ['category', 'tag', 'topic'];
                var empty = true;
                var data = {};

                for (var i = 0; i < fieldsToTrack.length; i++) {
                    var key = fieldsToTrack[i];
                    if (context.targeting[key]) {
                        data[key] = context.targeting[key];
                        empty = false;
                    }
                }

                wmgDil.api.signals(data, 'c_');
            }
        }
    }
});;
'use strict';

/**
 * Add javascript event tracker on the website.
 */
UPX.urlTracker.bind('track', function (data) {
    if (window.COMSCORE && window.COMSCORE_ACCOUNT_ID && data.absoluteUrl) {
        COMSCORE.beacon({c1: 2, c2: COMSCORE_ACCOUNT_ID, c3: '', c4: data.absoluteUrl, c5: '', c6: '', c7: data.absoluteUrl, c15: ''});
    }
});
;
'use strict';

/**
 * Add javascript event tracker on the website.
 */
UPX.urlTracker.bind('track', function (data) {
    if (window.PARSELY && window.PARSELY.beacon && data) {
        PARSELY.beacon.trackPageView({
            url: data.absoluteUrl,
            urlref: window.location.href,
            js: 1,
            action_name: 'next'
        });
    }
});
;
'use strict';

/**
 * A bridge between our website and ads served in safeframes.
 */
(function () {

    var intervals = {};

    /**
     * Send IDs to the safeframes for the communication.
     */
    UPX.adService.bind('slotRenderEnded', function (event) {

        if (!event || event.isEmpty) {
            return;
        }

        var slotId = event.slot.getSlotElementId();
        var iframe = getIframe(slotId);
        var count = 0;

        // Clear previous interval.
        clearHandshakeInterval(slotId);

        // Set new one.
        intervals[slotId] = setInterval(function () {

            if (!iframe || !iframe.contentWindow || count++ >= 100) {
                clearHandshakeInterval(slotId);
                return;
            }

            iframe.contentWindow.postMessage({
                type: 'upxHandshake',
                slotId: slotId
            }, '*');

        }, 100);

    });

    /**
     * Listen to the iframe events.
     */
    window.addEventListener('message', function (event) {

        if (!event || !event.data || event.data.sender !== 'upxFluidFrame' || !event.data.slotId) {
            return;
        }

        if (event.data.action === 'handshake') {
            handshake(event.data.slotId, event.data.type);
        } else if (event.data.action === 'setHeight') {
            setHeight(event.data.slotId, event.data.height);
        }

    }, false);

    /**
     * Clear handshake interval.
     *
     * @param slotId
     */
    function clearHandshakeInterval(slotId) {
        if (intervals[slotId]) {
            clearInterval(intervals[slotId]);
            intervals[slotId] = null;
        }
    }

    /**
     * Initiate connection with the fluid safeframe.
     *
     * @param slotId
     * @param slotType
     */
    function handshake(slotId, slotType) {

        // Clear handshake interval.
        clearHandshakeInterval(slotId);

        // Update iframe properties.
        var iframe = getIframe(slotId);
        if (iframe) {
            iframe.style.width = '100vw';
            if (slotType === 'upx-video-banner' || slotType === 'upx-video-sidebar' || slotType === 'upx-video') {
                iframe.parentNode.classList.add(slotType);
            }
        }
    }

    /**
     * Get ad iframe.
     *
     * @param slotId
     * @return {Element}
     */
    function getIframe(slotId) {
        return document.querySelector('#' + slotId + ' > div > iframe');
    }

    /**
     * Set iframe height.
     *
     * @param slotId
     * @param height
     */
    function setHeight(slotId, height) {

        height = parseInt(height);
        if (height <= 0) {
            return;
        }

        var iframe = getIframe(slotId);
        if (iframe) {
            iframe.style.height = height + 'px';
        }
    }
})();;
/*! This file is auto-generated */
!function(c,d){"use strict";var e=!1,n=!1;if(d.querySelector)if(c.addEventListener)e=!0;if(c.wp=c.wp||{},!c.wp.receiveEmbedMessage)if(c.wp.receiveEmbedMessage=function(e){var t=e.data;if(t)if(t.secret||t.message||t.value)if(!/[^a-zA-Z0-9]/.test(t.secret)){for(var r,a,i,s=d.querySelectorAll('iframe[data-secret="'+t.secret+'"]'),n=d.querySelectorAll('blockquote[data-secret="'+t.secret+'"]'),o=0;o<n.length;o++)n[o].style.display="none";for(o=0;o<s.length;o++)if(r=s[o],e.source===r.contentWindow){if(r.removeAttribute("style"),"height"===t.message){if(1e3<(i=parseInt(t.value,10)))i=1e3;else if(~~i<200)i=200;r.height=i}if("link"===t.message)if(a=d.createElement("a"),i=d.createElement("a"),a.href=r.getAttribute("src"),i.href=t.value,i.host===a.host)if(d.activeElement===r)c.top.location.href=t.value}}},e)c.addEventListener("message",c.wp.receiveEmbedMessage,!1),d.addEventListener("DOMContentLoaded",t,!1),c.addEventListener("load",t,!1);function t(){if(!n){n=!0;for(var e,t,r=-1!==navigator.appVersion.indexOf("MSIE 10"),a=!!navigator.userAgent.match(/Trident.*rv:11\./),i=d.querySelectorAll("iframe.wp-embedded-content"),s=0;s<i.length;s++){if(!(e=i[s]).getAttribute("data-secret"))t=Math.random().toString(36).substr(2,10),e.src+="#?secret="+t,e.setAttribute("data-secret",t);if(r||a)(t=e.cloneNode(!0)).removeAttribute("security"),e.parentNode.replaceChild(t,e)}}}}(window,document);;
